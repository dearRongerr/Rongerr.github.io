# NOTE

## 时间序列预测任务的定义

![image-20250302195903494](images/image-20250302195903494.png)

## 基础知识

【参看】

[傅里叶分析之掐死教程（完整版）更新于2014.06.06](https://zhuanlan.zhihu.com/p/19763358)

【伸缩 旋转与复数？】[复数的物理意义是什么？](https://www.zhihu.com/question/23234701)

### 复数？

- 伸缩与旋转与复数

![image-20250303170409884](images/image-20250303170409884.png)

- 复数表示，保留了二维信息

复数直观的理解就是旋转！$4*i*i = -4$

就是“4”在数轴上旋转了180度。那么4*i就是旋转了90度。

![image-20250303171202038](images/image-20250303171202038.png)

![image-20250303171247241](images/image-20250303171247241.png)

嗯，为啥？指数上加 i，就转起来了，还是螺旋线？得有一个不变量，比如 $sin^2x+cos^2x=1$ 怎么体现

![image-20250303171338840](images/image-20250303171338840.png)

### 欧拉公式

$e^{ix}=cosx+isinx$

$e^{ix}$ 中 `x` 是不断变换的，是一条逆时针旋转的螺旋线

问题：为什么 sinx 和 cosx 能跟数轴联系起来？

![image-20250303154817697](images/image-20250303154817697.png)

这里有一条数轴，在数轴上有一个红色的线段，它的长度是1

- 当它乘以3的时候，它的长度发生了变化，变成了蓝色的线段；

- 而当它乘以-1的时候，就变成了绿色的线段，或者说 **线段在数轴上围绕原点旋转了180度。**

我们知道乘`-1`其实就是乘了两次 `i`使线段旋转了180度，那么乘一次 `i` 呢——答案很简单——逆时针旋转了90度

![image-20250303154919884](images/image-20250303154919884.png)

同时，我们获得了一个垂直的虚数轴。实数轴与虚数轴共同构成了一个复数的平面，也称复平面。这样我们就了解到，乘虚数`i`的一个功能——旋转。

- $sinx$ 是单位圆半径到 $x$ 轴的距离，从 $x$ 轴躺着，开始逆时针转
- $cosx$ 是单位圆半径从 $y$ 轴开始转，描述到 $x$ 轴的距离，继续逆时针转
- 所以按照逆时针旋转法则：1=

- $sin0=0；cos0=1；1=cos0+sin0$
- $sin90=1；cos90=0；1=sin90+cos90°$
- $e^{ix}=cosx+isinx$
- 为什么  $e^{ix}=cosx+isinx$ 不等于 $sinx+icosx$

![image-20250303164004621](images/image-20250303164004621.png)

还是折腾不明白，如果都是单位圆上的点：

- 如果 y 轴的度量是 1，那么就是，cos x,sinx，因为要保证模长等于 1
- 如果 y 轴的度量是 i，点还是，cosx,sinx，还要保证模长是 1，那就是，isinx+cosx
- 因为 sinx 的定义就是，到 x 轴的距离，从 x 轴的正方向开始转，所以在复数域，同样是 sinx 的距离度量，就是 isinx
- 那如果 y 轴度量单位是 10、50，点还是 cosx，sinx，从 x 轴的正方向开始转，怎么保证模长是 1，不知道，还是说，这种假设就不对，因为只有复数有模长的概念有标准的计算公式
- 也许起作用的点在，$sin^{2}x+cos^{2}x = 1$，至于别的都是顺带的，只是刚好实数域，单位 1 的度量能够满足这个公式，以及复数域模长的计算也能够满足这个公式 $a+bi$，于是发现了`cosx+isinx`，那为什么 `e^x`可以与 `sinx` 和 `cosx` 联系起来呢？

### 高频低频

高频信号的周期较短，波动频繁，变化速度快；

低频则是频率较低的信号或波动，低频信号的周期较长，波动缓慢，变化速度慢。

### FFT

[动图](https://upload.wikimedia.org/wikipedia/commons/7/7e/Fourier_series_sawtooth_wave_circles_animation.gif)

![image-20250303195032389](images/image-20250303195032389.png)

![image-20250303171710405](images/image-20250303171710405.png)



[动画讲懂傅里叶变换](https://www.bilibili.com/video/BV1rC4y1E7FD/?spm_id_from=333.337.search-card.all.click&vd_source=ddd7d236ab3e9b123c4086c415f4939e)

![image-20250303172115079](images/image-20250303172115079.png)



![image-20250303172126240](images/image-20250303172126240.png)

直角坐标下 （4,3），在 x 轴的投影，x 的单位（1,0），所以投影用内积表示

（4,3）×（1,0）=4 也就是在 x 轴上的投影

对应到混合波× 第一个频率的单位波，得到这个波上的投影长度也就是振幅

![image-20250303172414120](images/image-20250303172414120.png)

内积等于 0，表示作用不可取代，就比如 $x$ 轴$(1,0)$和 $y$ 轴 $(0,1)$，内积=0，作用不可取代

![image-20250303172712661](images/image-20250303172712661.png)



![image-20250303172716677](images/image-20250303172716677.png)



![image-20250303172754410](images/image-20250303172754410.png)

负频率和直流分量

![image-20250303194820599](images/image-20250303194820599.png)



### 小波变换









## 方法的分类

- informer 的创新在于

> 改进注意力机制中所有时间步都在计算两两相关性，但其中最重要的是前几个
>
> 长尾效应
>
> 筛选注意力高的 Query

- TimesNet的创新在于

> 转换周期内和周期间，变成二维的做卷积
>
> 举例来说，超市每 2 天打折，每三天送零食，那第六天呢，即打折又送零食

- SegRNN

> 分段时间；并行计算

## 数据集介绍

![image-20250307202518201](images/image-20250307202518201.png)

- ETT（电变压器温度）

> 由两个小时级数据集（ETTh）和两个 15 分钟级数据集（ETTm）组成。
>
> 它们中的每一个都包含 2016 年 7 月至 2018 年 7 月的七种石油和电力变压器的负载特征。

- traffic(交通) 

> 描述了道路占用率。
>
> 它包含 2015 年至 2016 年旧金山高速公路传感器记录的每小时数据。

- electrity（电力）

> 从 2012 年到 2014 年收集了 321 个客户每小时电力消耗

- exchange_rate（汇率）

> 收集了 1990 年至 2016 年 8 个国家的每日汇率

- Weather

> 包括 21 个天气指标，例如空气温度和湿度。它的数据在 2020 年的每 10 分钟记录一次。

- ILLNESS

> 描述了患有流感疾病的患者与患者数量的比率。
>
> 它包括 2002 年至 2021 年美国疾病控制和预防中心每周数据

## chanllenge

### informer

> 它说要解决传统的 Transformer 不能直接用于 LTSF 的问题，那问题是，为什么 Transformer 能够用于 TSF？
>
> 自己的话说：
>
> **Challenge1**： 自注意力中的二次复杂度--> 概率稀疏自注意力机制
>
> **Challenge2**： 堆叠层太多了-》 蒸馏机制，（梯形）
>
> **Challenge3**： 自回归式预测太慢了 --》 

![image-20250317113437526](images/image-20250317113437526.png)

![image-20250317113453078](images/image-20250317113453078.png)

![image-20250317113529381](images/image-20250317113529381.png)

3 个挑战，3 个创新点

![image-20250317113630008](images/image-20250317113630008.png)

![image-20250317113726712](images/image-20250317113726712.png)

![image-20250317113953588](images/image-20250317113953588.png)

![image-20250317114026140](images/image-20250317114026140.png)

![image-20250317114114378](images/image-20250317114114378.png)

![image-20250317114221283](images/image-20250317114221283.png)

![image-20250317114521546](images/image-20250317114521546.png)

#### **概率稀疏自注意力机制 总结：** 

![image-20250317114558663](images/image-20250317114558663.png)

#### **自注意力蒸馏机制** 

![image-20250317114808306](images/image-20250317114808306.png)

![image-20250317114909632](images/image-20250317114909632.png)

![image-20250317115020671](images/image-20250317115020671.png)

![image-20250317115141425](images/image-20250317115141425.png)

![image-20250317115248103](images/image-20250317115248103.png)

![image-20250317115317569](images/image-20250317115317569.png)

#### 解码器生成

![image-20250317115415679](images/image-20250317115415679.png)

![image-20250317115532472](images/image-20250317115532472.png)

![image-20250317115630361](images/image-20250317115630361.png)

#### 预测预测 & 滚动预测

![image-20250317115724422](images/image-20250317115724422.png)

![image-20250317115811869](images/image-20250317115811869.png)

不再是 自回归预测

#### 总结

![image-20250317120027517](images/image-20250317120027517.png)

![image-20250317120043790](images/image-20250317120043790.png) 
