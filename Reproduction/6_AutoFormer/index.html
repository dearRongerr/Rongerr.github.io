
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://dearrongerr.github.io/Rongerr.github.io/Reproduction/6_AutoFormer/" rel="canonical"/>
<link href="../5_SegRNN_v4/" rel="prev"/>
<link href="../6_AutoFormer_v1/" rel="next"/>
<link href="../../assets/images/logo2.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.11" name="generator"/>
<title>Autoformer - Ê∫∂err</title>
<link href="../../assets/stylesheets/main.4af4bdda.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<style>:root{--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M320%2096a32%2032%200%201%201-64%200%2032%2032%200%201%201%2064%200m21.1%2080C367%20158.8%20384%20129.4%20384%2096c0-53-43-96-96-96s-96%2043-96%2096c0%2033.4%2017%2062.8%2042.9%2080H224c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h32v208h-48c-53%200-96-43-96-96v-6.1l7%207c9.4%209.4%2024.6%209.4%2033.9%200s9.4-24.6%200-33.9L97%20263c-9.4-9.4-24.6-9.4-33.9%200L7%20319c-9.4%209.4-9.4%2024.6%200%2033.9s24.6%209.4%2033.9%200l7-7v6.1c0%2088.4%2071.6%20160%20160%20160h160c88.4%200%20160-71.6%20160-160v-6.1l7%207c9.4%209.4%2024.6%209.4%2033.9%200s9.4-24.6%200-33.9l-56-56c-9.4-9.4-24.6-9.4-33.9%200l-56%2056c-9.4%209.4-9.4%2024.6%200%2033.9s24.6%209.4%2033.9%200l7-7v6.1c0%2053-43%2096-96%2096h-48V240h32c17.7%200%2032-14.3%2032-32s-14.3-32-32-32h-10.9z%22/%3E%3C/svg%3E');--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22m368.4%2018.3-55.7%2055.8%20125.2%20125.2%2055.7-55.7c21.9-21.9%2021.9-57.3%200-79.2l-46-46.1c-21.9-21.9-57.3-21.9-79.2%200M288%2094.6l-9.2%202.8-144.1%2043.2c-19.9%206-35.7%2021.2-42.3%2041L3.8%20445.8c-3.8%2011.3-1%2023.9%207.3%2032.4l153.6-153.5c-3-6.3-4.7-13.3-4.7-20.7%200-26.5%2021.5-48%2048-48s48%2021.5%2048%2048-21.5%2048-48%2048c-7.4%200-14.4-1.7-20.7-4.7L33.7%20500.9c8.6%208.3%2021.1%2011.2%2032.4%207.3l264.3-88.6c19.7-6.6%2035-22.4%2041-42.3l43.2-144.1%202.7-9.2z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M40%2048c-13.3%200-24%2010.7-24%2024v48c0%2013.3%2010.7%2024%2024%2024h48c13.3%200%2024-10.7%2024-24V72c0-13.3-10.7-24-24-24zm152%2016c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h288c17.7%200%2032-14.3%2032-32s-14.3-32-32-32zm0%20160c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h288c17.7%200%2032-14.3%2032-32s-14.3-32-32-32zm0%20160c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h288c17.7%200%2032-14.3%2032-32s-14.3-32-32-32zM16%20232v48c0%2013.3%2010.7%2024%2024%2024h48c13.3%200%2024-10.7%2024-24v-48c0-13.3-10.7-24-24-24H40c-13.3%200-24%2010.7-24%2024m24%20136c-13.3%200-24%2010.7-24%2024v48c0%2013.3%2010.7%2024%2024%2024h48c13.3%200%2024-10.7%2024-24v-48c0-13.3-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20384%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M272%20384c9.6-31.9%2029.5-59.1%2049.2-86.2%205.2-7.1%2010.4-14.2%2015.4-21.4%2019.8-28.5%2031.4-63%2031.4-100.3C368%2078.8%20289.2%200%20192%200S16%2078.8%2016%20176c0%2037.3%2011.6%2071.9%2031.4%20100.3%205%207.2%2010.2%2014.3%2015.4%2021.4%2019.8%2027.1%2039.7%2054.4%2049.2%2086.2h160zm-80%20128c44.2%200%2080-35.8%2080-80v-16H112v16c0%2044.2%2035.8%2080%2080%2080m-80-336c0%208.8-7.2%2016-16%2016s-16-7.2-16-16c0-61.9%2050.1-112%20112-112%208.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016c-44.2%200-80%2035.8-80%2080%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M438.6%20105.4c12.5%2012.5%2012.5%2032.8%200%2045.3l-256%20256c-12.5%2012.5-32.8%2012.5-45.3%200l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200L160%20338.7l233.4-233.3c12.5-12.5%2032.8-12.5%2045.3%200z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-86.2-346.7c7.9-22.3%2029.1-37.3%2052.8-37.3h58.3c34.9%200%2063.1%2028.3%2063.1%2063.1%200%2022.6-12.1%2043.5-31.7%2054.8L280%20264.4c-.2%2013-10.9%2023.6-24%2023.6-13.3%200-24-10.7-24-24v-13.5c0-8.6%204.6-16.5%2012.1-20.8l44.3-25.4c4.7-2.7%207.6-7.7%207.6-13.1%200-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4%200-6.4%202.1-7.5%205.3l-.4%201.2c-4.4%2012.5-18.2%2019-30.6%2014.6s-19-18.2-14.6-30.6l.4-1.2zM224%20352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%2032c14.2%200%2027.3%207.5%2034.5%2019.8l216%20368c7.3%2012.4%207.3%2027.7.2%2040.1S486.3%20480%20472%20480H40c-14.3%200-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7%2039.5%20241.8%2032%20256%2032m0%20128c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V184c0-13.3-10.7-24-24-24m32%20224a32%2032%200%201%200-64%200%2032%2032%200%201%200%2064%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%203c4.97%200%209%203.58%209%208s-6%2010-9%2010-9-5.58-9-10%204.03-8%209-8m-1.69%207.93C9.29%209.29%207.47%208.58%206.25%209.34s-1.38%202.71-.36%204.35c1.03%201.64%202.85%202.35%204.07%201.59%201.22-.78%201.37-2.71.35-4.35m3.38%200c-1.02%201.64-.87%203.57.35%204.35%201.22.76%203.04.05%204.07-1.59%201.02-1.64.86-3.59-.36-4.35s-3.04-.05-4.06%201.59M12%2017.75c-2%200-2.5-.75-2.5-.75%200%20.03.5%202%202.5%202s2.5-2%202.5-2-.5.75-2.5.75%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%2032c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v11.5c0%2049.9-60.3%2074.9-95.6%2039.6l-8.2-8.1C107.7%2062.5%2087.5%2062.5%2075%2075s-12.5%2032.8%200%2045.3l8.2%208.2c35.2%2035.2%2010.2%2095.5-39.7%2095.5H32c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h11.5c49.9%200%2074.9%2060.3%2039.6%2095.6l-8.1%208.2c-12.5%2012.5-12.5%2032.8%200%2045.3s32.8%2012.5%2045.3%200l8.2-8.2c35.3-35.3%2095.6-10.3%2095.6%2039.6V480c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-11.5c0-49.9%2060.3-74.9%2095.6-39.6l8.2%208.2c12.5%2012.5%2032.8%2012.5%2045.3%200s12.5-32.8%200-45.3l-8.2-8.2c-35.3-35.3-10.3-95.6%2039.6-95.6h11.5c17.7%200%2032-14.3%2032-32s-14.3-32-32-32h-11.5c-49.9%200-74.9-60.3-39.6-95.6l8.2-8.2c12.5-12.5%2012.5-32.8%200-45.3s-32.8-12.5-45.3%200l-8.2%208.2C348.3%20118.4%20288%2093.4%20288%2043.5zM176%20224a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m128%2056a24%2024%200%201%201%200%2048%2024%2024%200%201%201%200-48%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M320%200c17.7%200%2032%2014.3%2032%2032v64h120c39.8%200%2072%2032.2%2072%2072v272c0%2039.8-32.2%2072-72%2072H168c-39.8%200-72-32.2-72-72V168c0-39.8%2032.2-72%2072-72h120V32c0-17.7%2014.3-32%2032-32M208%20384c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zm96%200c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zm96%200c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zM264%20256a40%2040%200%201%200-80%200%2040%2040%200%201%200%2080%200m152%2040a40%2040%200%201%200%200-80%2040%2040%200%201%200%200%2080M48%20224h16v192H48c-26.5%200-48-21.5-48-48v-96c0-26.5%2021.5-48%2048-48m544%200c26.5%200%2048%2021.5%2048%2048v96c0%2026.5-21.5%2048-48%2048h-16V224z%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v132.8c0%2011.8-3.3%2023.5-9.5%2033.5L10.3%20406.2C3.6%20417.2%200%20429.7%200%20442.6%200%20480.9%2031.1%20512%2069.4%20512h309.2c38.3%200%2069.4-31.1%2069.4-69.4%200-12.8-3.6-25.4-10.3-36.4L329.5%20230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20196.8V64h64v132.8c0%2023.7%206.6%2046.9%2019%2067.1l34.5%2056.1h-171l34.5-56.1c12.4-20.2%2019-43.4%2019-67.1%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M579.8%20267.7c56.5-56.5%2056.5-148%200-204.5-50-50-128.8-56.5-186.3-15.4l-1.6%201.1c-14.4%2010.3-17.7%2030.3-7.4%2044.6s30.3%2017.7%2044.6%207.4l1.6-1.1c32.1-22.9%2076-19.3%20103.8%208.6%2031.5%2031.5%2031.5%2082.5%200%20114L422.3%20334.8c-31.5%2031.5-82.5%2031.5-114%200-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4%206.9-34.4-7.4-44.6s-34.4-6.9-44.6%207.4l-1.1%201.6C206.5%20251.2%20213%20330%20263%20380c56.5%2056.5%20148%2056.5%20204.5%200zM60.2%20244.3c-56.5%2056.5-56.5%20148%200%20204.5%2050%2050%20128.8%2056.5%20186.3%2015.4l1.6-1.1c14.4-10.3%2017.7-30.3%207.4-44.6s-30.3-17.7-44.6-7.4l-1.6%201.1c-32.1%2022.9-76%2019.3-103.8-8.6C74%20372%2074%20321%20105.5%20289.5l112.2-112.3c31.5-31.5%2082.5-31.5%20114%200%2027.9%2027.9%2031.5%2071.8%208.6%20103.9l-1.1%201.6c-10.3%2014.4-6.9%2034.4%207.4%2044.6s34.4%206.9%2044.6-7.4l1.1-1.6C433.5%20260.8%20427%20182%20377%20132c-56.5-56.5-148-56.5-204.5%200z%22/%3E%3C/svg%3E');}</style>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono"}</style>
<link href="../../css/timeline.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet"/>
<link href="../../mkdocs/css/no-footer.css" rel="stylesheet"/>
<link href="../../mkdocs/css/unordered-list-symbols.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/cards.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/flink.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/rounded_corner.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://cdn.tonycrane.cc/jbmono/jetbrainsmono.css" rel="stylesheet"/>
<link href="https://cdn.tonycrane.cc/lxgw/lxgwscreen.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/custom.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/tasklist.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/fold_toc.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/changelog_extra.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<link href="../../assets/document_dates.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
 <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script><style>/* Ëá™ÂÆö‰πâÂàÜÈöîÁ∫øÊ†∑Âºè */
hr.custom-hr {
    position: relative;
    text-align: center;
    border: 0;
    height: 1px;
    background: none;
    /* ‰ΩøÁî®‰∏ªÈ¢òÁöÑËæπÊ°ÜÈ¢úËâ≤ */
    border-top: 2px solid var(--md-default-fg-color--lighter, currentColor);
    margin: 100px 0 !important;
}

hr.custom-hr:before {
    content: attr(data-content);
    position: absolute;
    /* ‰ΩøÁî®‰∏ªÈ¢òÁöÑËÉåÊôØËâ≤Ôºåfallback Âà∞È°µÈù¢ËÉåÊôØËâ≤ */
    background: var(--md-default-bg-color, var(--md-primary-bg-color, inherit));
    /* ‰ΩøÁî®‰∏ªÈ¢òÁöÑÊñáÊú¨È¢úËâ≤ */
    color: var(--md-default-fg-color, currentColor);
    padding: 0 0.5em;
    line-height: 1;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2em;
    font-weight: bold;
}

/* ÁõÆÂΩï‰∏≠ÂàÜÈöîÁ∫øÊù°ÁõÆÁöÑÊ†∑Âºè */
.md-nav__item.hr-nav-item {
    text-align: center;
    margin: 1.16em 0;
    /* Â¢ûÂä†‰∏ä‰∏ãÈó¥Ë∑ù */
}

.md-nav__item.hr-nav-item .md-nav__link {
    justify-content: center;
    font-weight: bold;
    font-size: 1.1em;
    color: var(--md-typeset-color) !important;
}

/* ÊÇ¨ÂÅúÊïàÊûú */
.md-nav__item.hr-nav-item .md-nav__link:hover {
    color: var(--md-accent-fg-color) !important;
}

/* ‰øÆÊîπÂàÜÈöîÁ∫øÁöÑÊ†∑Âºè */
.md-content__inner hr.custom-hr {
    border: none !important;
    height: 2px !important;
    background-color: var(--md-typeset-color) !important;
    margin: 8em 0 !important;
    /* Â¢ûÂä†ÂàÜÈöîÁ∫øÁöÑ‰∏ä‰∏ãÈó¥Ë∑ù */
}

/* Á°Æ‰øùÂàÜÈöîÁ∫øÊñáÂ≠óÂèØËßÅ */
.md-content__inner hr.custom-hr[data-content]::before {
    color: var(--md-typeset-color) !important;
}</style></head>
<body data-md-color-accent="light-green" data-md-color-primary="green" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#autoformer">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Ê∫∂err" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Ê∫∂err">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ê∫∂err
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Autoformer
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="light-green" data-md-color-media="" data-md-color-primary="green" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/dearRongerr/Rongerr.github.io" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    Rongerr.github.io
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../sticks/mkdocs_learn/">
          
  
  
    
  
  ‰æøÁ≠æ

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../bagu/">
          
  
  
    
  
  Èù¢ËØï

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../Error/github/">
          
  
  
    
  
  Êçâ‰∏™Ëô´

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../learning/0_pdfNotes/">
          
  
  
    
  
  Ê∑±Â∫¶Â≠¶‰π†

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../literature/">
          
  
  
    
  
  ÊñáÁåÆ

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
  
    
  
  Â§çÁé∞&amp;‰ª£Á†Å

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../Statistics/">
          
  
  
    
  
  ÁªüËÆ°Â≠¶

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../logs/">
          
  
  
    
  
  Êî∂Á∫≥ÁÆ±

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ê∫∂err" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Ê∫∂err">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8"></path></svg>
</a>
    Ê∫∂err
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/dearRongerr/Rongerr.github.io" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    Rongerr.github.io
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    ‰æøÁ≠æ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            ‰æøÁ≠æ
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/mkdocs_learn/">
<span class="md-ellipsis">
    MkDocs
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/markdwon_learn/">
<span class="md-ellipsis">
    markdown
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/latex/">
<span class="md-ellipsis">
    LaTex
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/GitHub/">
<span class="md-ellipsis">
    GitHub
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/MacOS/">
<span class="md-ellipsis">
    MacOS
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/shell/">
<span class="md-ellipsis">
    Shell
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/linux/">
<span class="md-ellipsis">
    linux
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/screen/">
<span class="md-ellipsis">
    screen
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/docker/">
<span class="md-ellipsis">
    Docker
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/writting/">
<span class="md-ellipsis">
    ÂÜô‰Ωú
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/1_github_v1/">
<span class="md-ellipsis">
    github v1.0
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/2_python/">
<span class="md-ellipsis">
    python
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/3_vscode/">
<span class="md-ellipsis">
    VSCode
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sticks/4_mkdocs/">
<span class="md-ellipsis">
    mkdocs Â∏∏Áî®ÂëΩ‰ª§
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../bagu/">
<span class="md-ellipsis">
    Èù¢ËØï
    
  </span>
</a>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Èù¢ËØï
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
<span class="md-ellipsis">
    È¢òÁõÆ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
            È¢òÁõÆ
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/questions/1_questions/">
<span class="md-ellipsis">
    Èù¢ËØïÈóÆÈ¢ò
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../bagu/leetcode/">
<span class="md-ellipsis">
    ÂäõÊâ£
    
  </span>
</a>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
            ÂäõÊâ£
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/leetcode/1/">
<span class="md-ellipsis">
    1 ‰∏§Êï∞‰πãÂíå
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/leetcode/2/">
<span class="md-ellipsis">
    2 ‰∏§Êï∞Áõ∏Âä†
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../bagu/deeplearning/">
<span class="md-ellipsis">
    Ê∑±Â∫¶Â≠¶‰π†
    
  </span>
</a>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
            Ê∑±Â∫¶Â≠¶‰π†
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/deeplearning/transformer/">
<span class="md-ellipsis">
    ÊâãÊíïTransformer‰ª£Á†Å
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/deeplearning/pytorch_shape_function/">
<span class="md-ellipsis">
    pytorchÁöÑÁª¥Â∫¶ÂèòÊç¢ÂáΩÊï∞
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/deeplearning/1/">
<span class="md-ellipsis">
    visionTransformer‰ª£Á†Å
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
<span class="md-ellipsis">
    Êú∫Âô®Â≠¶‰π†
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
            Êú∫Âô®Â≠¶‰π†
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/machinelearning/kmeans/">
<span class="md-ellipsis">
    ÊâãÊíïkmeans
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../bagu/machinelearning/2/">
<span class="md-ellipsis">
    ÊâãÊíïÂèçÂêë‰º†Êí≠
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Êçâ‰∏™Ëô´
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Êçâ‰∏™Ëô´
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Error/github/">
<span class="md-ellipsis">
    github
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Error/latex/">
<span class="md-ellipsis">
    Latex
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Error/python/">
<span class="md-ellipsis">
    python
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Error/macos/">
<span class="md-ellipsis">
    macOS
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Error/docker/">
<span class="md-ellipsis">
    docker
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Ê∑±Â∫¶Â≠¶‰π†
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Ê∑±Â∫¶Â≠¶‰π†
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/0_pdfNotes/">
<span class="md-ellipsis">
    üìí
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/3_ViT/">
<span class="md-ellipsis">
    ViT
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/1_clip/">
<span class="md-ellipsis">
    CLIP
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/2_MOCO/">
<span class="md-ellipsis">
    MOCO
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/2/">
<span class="md-ellipsis">
    ÂõæËß£LayerNorm &amp; BatchNorm
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/1/">
<span class="md-ellipsis">
    5ÁßçÂΩí‰∏ÄÂåñÊñπÊ≥ï
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/vit/">
<span class="md-ellipsis">
    vision TransformerÁöÑÂéüÁêÜ‰∏éÈöæÁÇπÊ∫êÁ†ÅÂÆûÁé∞
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/pe/">
<span class="md-ellipsis">
    4Áßç‰ΩçÁΩÆÁºñÁ†Å
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/convs/">
<span class="md-ellipsis">
    Âç∑ÁßØ
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/3/">
<span class="md-ellipsis">
    ÊùéÊ≤ê ÁõÆÊ†áÊ£ÄÊµãÈÉ®ÂàÜ
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/4_GAN/">
<span class="md-ellipsis">
    GAN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/5_Bert/">
<span class="md-ellipsis">
    BERT‰ªéÈõ∂ËØ¶ÁªÜËß£ËØª
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/6_Diffusion/">
<span class="md-ellipsis">
    DDPM
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/6_Diffusion1/">
<span class="md-ellipsis">
    VDM
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/8_WeightNorm/">
<span class="md-ellipsis">
    WeightNorm
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/9_cGAN/">
<span class="md-ellipsis">
    GAN Âèò‰Ωì
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/12_KLdivergence/">
<span class="md-ellipsis">
    KL divergence
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/13_RNN/">
<span class="md-ellipsis">
    RNN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learning/14_LSTM/">
<span class="md-ellipsis">
    LSTM
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../literature/">
<span class="md-ellipsis">
    ÊñáÁåÆ
    
  </span>
</a>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            ÊñáÁåÆ
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../literature/TSP/">
<span class="md-ellipsis">
    Êó∂Èó¥Â∫èÂàóÈ¢ÑÊµã
    
  </span>
</a>
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            Êó∂Èó¥Â∫èÂàóÈ¢ÑÊµã
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/TSP/0_note/">
<span class="md-ellipsis">
    NOTE
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/TSP/1_SegRNN/">
<span class="md-ellipsis">
    2023„ÄÅSegRNN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/TSP/2_DLinear/">
<span class="md-ellipsis">
    2022„ÄÅDLinear
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/TSP/3_TimesNet/">
<span class="md-ellipsis">
    2023„ÄÅTimesNet
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/TSP/4_Informer/">
<span class="md-ellipsis">
    2021„ÄÅ Informer
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/TSP/5_Autoformer/">
<span class="md-ellipsis">
    2021„ÄÅAutoformer
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../literature/ObejectCounting/">
<span class="md-ellipsis">
    ÁõÆÊ†áËÆ°Êï∞
    
  </span>
</a>
<label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
            ÁõÆÊ†áËÆ°Êï∞
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank1%20CountGD/">
<span class="md-ellipsis">
    rank1 CountGD
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank2%20GeCo/">
<span class="md-ellipsis">
    rank2 GeCo
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank3%20DAVE/">
<span class="md-ellipsis">
    rank3 DAVE
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank4%20CACViT/">
<span class="md-ellipsis">
    rank4 CACViT
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank5%20SSD/">
<span class="md-ellipsis">
    rank5 SSD
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank6%20LOCA/">
<span class="md-ellipsis">
    rank6 LOCA
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank7%20SemAug_CountTR/">
<span class="md-ellipsis">
    rank7 SemAug CountTR
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank8%20CounTR/">
<span class="md-ellipsis">
    rank8 CounTR
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank9%20SemAug_SAFECount/">
<span class="md-ellipsis">
    rank9 SemAug SAFECount
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank10%20SPDCN/">
<span class="md-ellipsis">
    rank10 SPDCN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank11%20GCA_SUN/">
<span class="md-ellipsis">
    rank11 GCA SUN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObejectCounting/rank12%20SAFECount/">
<span class="md-ellipsis">
    rank12 SAFECount
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../literature/ObjectDetection/">
<span class="md-ellipsis">
    ÁõÆÊ†áÊ£ÄÊµã
    
  </span>
</a>
<label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
            ÁõÆÊ†áÊ£ÄÊµã
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObjectDetection/2/">
<span class="md-ellipsis">
    ÁõÆÊ†áÊ£ÄÊµãÂü∫Á°ÄÁü•ËØÜ
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObjectDetection/1/">
<span class="md-ellipsis">
    DETRËÆ∫ÊñáÁ≥ªÂàó
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literature/ObjectDetection/3/">
<span class="md-ellipsis">
    ÔºàDETRÔºâEnd-to-End Object Detection with Transformer
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Â§çÁé∞&amp;‰ª£Á†Å
    
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Â§çÁé∞&amp;‰ª£Á†Å
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../7_summary/">
<span class="md-ellipsis">
    Ê±áÊÄªÂ§çÁé∞Ë∞ÉÁî®Âõæ
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../DAVE/">
<span class="md-ellipsis">
    DAVEÂ§çÁé∞
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../5_SegRNN_index/">
<span class="md-ellipsis">
    SegRNN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../5_SegRNN_v1/">
<span class="md-ellipsis">
    Â§çÁé∞SegRNN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../5_SegRNN_v2/">
<span class="md-ellipsis">
    ÔºàË°•ÂÖÖÔºâÂ§çÁé∞ SegRNN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../5_SegRNN_v3/">
<span class="md-ellipsis">
    (ÊâãÂÜôÁ¨îËÆ∞)SegRNN
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../5_SegRNN_v4/">
<span class="md-ellipsis">
    SegRNNÂÆûÈ™åËøáÁ®ã
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Autoformer
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Autoformer
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#github">
<span class="md-ellipsis">
      github Ê∫êÁ†Å‰∏ªÈ°µ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
<span class="md-ellipsis">
      ÂáÜÂ§á
    </span>
</a>
<nav aria-label="ÂáÜÂ§á" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#git-clone">
<span class="md-ellipsis">
      git clone
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#readme">
<span class="md-ellipsis">
      readme
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
<span class="md-ellipsis">
      Ë∞ÉËØïÈÖçÁΩÆ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#python">
<span class="md-ellipsis">
      Êñ∞Âª∫ python ËôöÊãüÁéØÂ¢É
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#requirements">
<span class="md-ellipsis">
      requirements
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
<span class="md-ellipsis">
      ÂºÄÂßãË∞ÉËØï
    </span>
</a>
<nav aria-label="ÂºÄÂßãË∞ÉËØï" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder-embedding">
<span class="md-ellipsis">
      encoder embedding
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
<span class="md-ellipsis">
      Ê®°ÂûãÂÆö‰πâ
    </span>
</a>
<nav aria-label="Ê®°ÂûãÂÆö‰πâ" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
<span class="md-ellipsis">
      ÁºñÁ†ÅÂô® Ëß£Á†ÅÂô®ÈÉ®ÂàÜ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_6">
<span class="md-ellipsis">
      ËÆ≠ÁªÉËøáÁ®ãÔºåÂΩ¢Áä∂ÂèòÊç¢
    </span>
</a>
<nav aria-label="ËÆ≠ÁªÉËøáÁ®ãÔºåÂΩ¢Áä∂ÂèòÊç¢" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#autoformer-forward">
<span class="md-ellipsis">
      Autoformer forward
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_7">
<span class="md-ellipsis">
      Â∫èÂàóÂàÜËß£
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#model-inputs">
<span class="md-ellipsis">
      model inputs
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder">
<span class="md-ellipsis">
      Encoder
    </span>
</a>
<nav aria-label="Encoder" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_8">
<span class="md-ellipsis">
      ËÆ∫Êñá
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder-embedding_1">
<span class="md-ellipsis">
      Encoder Embedding
    </span>
</a>
<nav aria-label="Encoder Embedding" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_9">
<span class="md-ellipsis">
      Á±ªÂõæ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder-forward">
<span class="md-ellipsis">
      Encoder forward
    </span>
</a>
<nav aria-label="Encoder forward" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_10">
<span class="md-ellipsis">
      Á±ªÂõæ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoderlayer">
<span class="md-ellipsis">
      EncoderLayer
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decoder">
<span class="md-ellipsis">
      Decoder
    </span>
</a>
<nav aria-label="Decoder" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_11">
<span class="md-ellipsis">
      Á±ªÂõæ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_12">
<span class="md-ellipsis">
      ËÆ∫Êñá
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_13">
<span class="md-ellipsis">
      ‰ª£Á†Å
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decoderlayer-forward">
<span class="md-ellipsis">
      DecoderLayer forward
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_14">
<span class="md-ellipsis">
      Êï∞ÊçÆÊµÅÂä®Âõæ
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#autoformer-forward_1">
<span class="md-ellipsis">
      Ê±áÊÄª Autoformer forward
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_15">
<span class="md-ellipsis">
      ÈôÑÂΩï
    </span>
</a>
<nav aria-label="ÈôÑÂΩï" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#conv2">
<span class="md-ellipsis">
      ÁñëÈóÆ‰∏Ä ‰∏∫‰ªÄ‰πàConv2‰πãÂêéÊ≤°ÊúâËøõË°åÊøÄÊ¥ªÂáΩÊï∞ÁöÑÂ∫îÁî®
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-conv1d-nnlinear">
<span class="md-ellipsis">
      ÁñëÈóÆ 2 ‰∏∫‰ªÄ‰πàÊòØ conv1dÔºåËÄå‰∏çÊòØ nn.Linear
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_16">
<span class="md-ellipsis">
      Â∫èÂàóÂàÜËß£ÁöÑÁé∞ÂÆûÊÑè‰πâ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_17">
<span class="md-ellipsis">
      ÁêÜËß£Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#k-v-q">
<span class="md-ellipsis">
      ÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_18">
<span class="md-ellipsis">
      Âæ™ÁéØÂ°´ÂÖÖ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_19">
<span class="md-ellipsis">
      ‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ‰∏çÂêåÁöÑËøòÂéüÁª¥Â∫¶ÊñπÊ≥ï
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../6_AutoFormer_v1/">
<span class="md-ellipsis">
    (Áª≠) Autoformer
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../6_AutoFormer_v2_eg/">
<span class="md-ellipsis">
    AutoFormer ÂèØËßÜÂåñÁªìÊûú
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../8_ThuML/">
<span class="md-ellipsis">
    thumlÂ§çÁé∞
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6_13" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../CodeRepo/">
<span class="md-ellipsis">
    ‰∏Ä‰∫õ‰ª£Á†Å
    
  </span>
</a>
<label class="md-nav__link" for="__nav_6_13" id="__nav_6_13_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_6_13_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_13">
<span class="md-nav__icon md-icon"></span>
            ‰∏Ä‰∫õ‰ª£Á†Å
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../1/">
<span class="md-ellipsis">
    ‰∏Ä‰∫õÊ®°Âùó
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../2/">
<span class="md-ellipsis">
    ÁâπÂæÅËûçÂêàÊñπÂºè
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../3/">
<span class="md-ellipsis">
    ‰∏Ä‰∫õÊÑüÊÇü
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../4/">
<span class="md-ellipsis">
    È¢ÑËÆ≠ÁªÉÊùÉÈáç
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../CodeRepo/1_MultiHeadAttention/">
<span class="md-ellipsis">
    Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂ÂΩ¢Áä∂ÂèòÂåñ
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../CodeRepo/2_transformer/">
<span class="md-ellipsis">
    ‰ªéÁé∞ÂÆûÁîüÊ¥ªÁöÑËßíÂ∫¶Áúã Transformer
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../CodeRepo/3_fourier/">
<span class="md-ellipsis">
    DFT‰æãÈ¢ò
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../CodeRepo/1_0_Autoformer/">
<span class="md-ellipsis">
    Autoformer
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../Statistics/">
<span class="md-ellipsis">
    ÁªüËÆ°Â≠¶
    
  </span>
</a>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            ÁªüËÆ°Â≠¶
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Statistics/1_FFT/">
<span class="md-ellipsis">
    FourierÁ∫ßÊï∞
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Statistics/2_FFT/">
<span class="md-ellipsis">
    FourierÂü∫Á°ÄÁü•ËØÜ
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Statistics/1_0_fourier/">
<span class="md-ellipsis">
    Â§çÂπ≥Èù¢ÊóãËΩ¨&amp;DFT
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Statistics/1_1_fourier/">
<span class="md-ellipsis">
    Áõ¥ËßÇÁêÜËß£ÂÇÖÈáåÂè∂ÂèòÊç¢
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Statistics/1_2_signal/">
<span class="md-ellipsis">
    ‰ø°Âè∑ÁöÑÂêàÊàê‰∏éÂàÜËß£
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Statistics/1_4_signal/">
<span class="md-ellipsis">
    FS„ÄÅFT„ÄÅDTFS„ÄÅDTFT
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Statistics/1_3_complexExp/">
<span class="md-ellipsis">
    Â§çÊåáÊï∞ÁöÑÊÄßË¥®
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../logs/">
<span class="md-ellipsis">
    Êî∂Á∫≥ÁÆ±
    
  </span>
</a>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            Êî∂Á∫≥ÁÆ±
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/1_date/">
<span class="md-ellipsis">
    ‰∏Ä‰∫õÊó•Êúü
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/2_updatelog/">
<span class="md-ellipsis">
    Êõ¥Êñ∞Êó•Âøó
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/4_flink/">
<span class="md-ellipsis">
    Êõ¥Â§öÈìæÊé•
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/6_waline/">
<span class="md-ellipsis">
    ÁïÖÊâÄÊ¨≤Ë®Ä
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../logs/1_0_diary/">
<span class="md-ellipsis">
    Á¢éÁ¢éÂøµ
    
  </span>
</a>
<label class="md-nav__link" for="__nav_8_6" id="__nav_8_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_6">
<span class="md-nav__icon md-icon"></span>
            Á¢éÁ¢éÂøµ
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/1_0_diary/2025/03/">
<span class="md-ellipsis">
    3 Êúà
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/1_0_diary/2025/04/">
<span class="md-ellipsis">
    4Êúà
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/diary/">
<span class="md-ellipsis">
    Êõ¥Êó©‰ª•Ââç
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#github">
<span class="md-ellipsis">
      github Ê∫êÁ†Å‰∏ªÈ°µ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
<span class="md-ellipsis">
      ÂáÜÂ§á
    </span>
</a>
<nav aria-label="ÂáÜÂ§á" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#git-clone">
<span class="md-ellipsis">
      git clone
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#readme">
<span class="md-ellipsis">
      readme
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
<span class="md-ellipsis">
      Ë∞ÉËØïÈÖçÁΩÆ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#python">
<span class="md-ellipsis">
      Êñ∞Âª∫ python ËôöÊãüÁéØÂ¢É
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#requirements">
<span class="md-ellipsis">
      requirements
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
<span class="md-ellipsis">
      ÂºÄÂßãË∞ÉËØï
    </span>
</a>
<nav aria-label="ÂºÄÂßãË∞ÉËØï" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder-embedding">
<span class="md-ellipsis">
      encoder embedding
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
<span class="md-ellipsis">
      Ê®°ÂûãÂÆö‰πâ
    </span>
</a>
<nav aria-label="Ê®°ÂûãÂÆö‰πâ" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
<span class="md-ellipsis">
      ÁºñÁ†ÅÂô® Ëß£Á†ÅÂô®ÈÉ®ÂàÜ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_6">
<span class="md-ellipsis">
      ËÆ≠ÁªÉËøáÁ®ãÔºåÂΩ¢Áä∂ÂèòÊç¢
    </span>
</a>
<nav aria-label="ËÆ≠ÁªÉËøáÁ®ãÔºåÂΩ¢Áä∂ÂèòÊç¢" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#autoformer-forward">
<span class="md-ellipsis">
      Autoformer forward
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_7">
<span class="md-ellipsis">
      Â∫èÂàóÂàÜËß£
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#model-inputs">
<span class="md-ellipsis">
      model inputs
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder">
<span class="md-ellipsis">
      Encoder
    </span>
</a>
<nav aria-label="Encoder" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_8">
<span class="md-ellipsis">
      ËÆ∫Êñá
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder-embedding_1">
<span class="md-ellipsis">
      Encoder Embedding
    </span>
</a>
<nav aria-label="Encoder Embedding" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_9">
<span class="md-ellipsis">
      Á±ªÂõæ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoder-forward">
<span class="md-ellipsis">
      Encoder forward
    </span>
</a>
<nav aria-label="Encoder forward" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_10">
<span class="md-ellipsis">
      Á±ªÂõæ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encoderlayer">
<span class="md-ellipsis">
      EncoderLayer
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decoder">
<span class="md-ellipsis">
      Decoder
    </span>
</a>
<nav aria-label="Decoder" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_11">
<span class="md-ellipsis">
      Á±ªÂõæ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_12">
<span class="md-ellipsis">
      ËÆ∫Êñá
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_13">
<span class="md-ellipsis">
      ‰ª£Á†Å
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decoderlayer-forward">
<span class="md-ellipsis">
      DecoderLayer forward
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_14">
<span class="md-ellipsis">
      Êï∞ÊçÆÊµÅÂä®Âõæ
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#autoformer-forward_1">
<span class="md-ellipsis">
      Ê±áÊÄª Autoformer forward
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_15">
<span class="md-ellipsis">
      ÈôÑÂΩï
    </span>
</a>
<nav aria-label="ÈôÑÂΩï" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#conv2">
<span class="md-ellipsis">
      ÁñëÈóÆ‰∏Ä ‰∏∫‰ªÄ‰πàConv2‰πãÂêéÊ≤°ÊúâËøõË°åÊøÄÊ¥ªÂáΩÊï∞ÁöÑÂ∫îÁî®
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-conv1d-nnlinear">
<span class="md-ellipsis">
      ÁñëÈóÆ 2 ‰∏∫‰ªÄ‰πàÊòØ conv1dÔºåËÄå‰∏çÊòØ nn.Linear
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_16">
<span class="md-ellipsis">
      Â∫èÂàóÂàÜËß£ÁöÑÁé∞ÂÆûÊÑè‰πâ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_17">
<span class="md-ellipsis">
      ÁêÜËß£Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#k-v-q">
<span class="md-ellipsis">
      ÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_18">
<span class="md-ellipsis">
      Âæ™ÁéØÂ°´ÂÖÖ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_19">
<span class="md-ellipsis">
      ‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ‰∏çÂêåÁöÑËøòÂéüÁª¥Â∫¶ÊñπÊ≥ï
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/dearRongerr/Rongerr.github.io/edit/main/docs/Reproduction/6_AutoFormer.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/dearRongerr/Rongerr.github.io/raw/main/docs/Reproduction/6_AutoFormer.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
</a>
<h1 id="autoformer">Autoformer<a class="headerlink" href="#autoformer" title="Permanent link">¬∂</a></h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> Á∫¶ 17665 ‰∏™Â≠ó <span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"></path></svg></span> 583 Ë°å‰ª£Á†Å <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"></path></svg></span> 100 Âº†ÂõæÁâá <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> È¢ÑËÆ°ÈòÖËØªÊó∂Èó¥ 96 ÂàÜÈíü</p>
</div>
<h2 id="github">github Ê∫êÁ†Å‰∏ªÈ°µ<a class="headerlink" href="#github" title="Permanent link">¬∂</a></h2>
<p>Autoformer (NeurIPS 2021) Ëá™Âä®ÊàêÂûãÊú∫ (NeurIPS 2021)</p>
<p>Autoformer: Decomposition Transformers with Auto-Correlation for Long-Term Series Forecasting
AutoformerÔºöÁî®‰∫éÈïøÊúüÂ∫èÂàóÈ¢ÑÊµãÁöÑÂÖ∑ÊúâËá™Áõ∏ÂÖ≥ÁöÑÂàÜËß£ÂèòÂéãÂô®</p>
<p>Time series forecasting is a critical demand for real applications. Enlighted by the classic time series analysis and stochastic process theory, we propose the Autoformer as a general series forecasting model [<a href="https://arxiv.org/abs/2106.13008">paper</a>]. <strong>Autoformer goes beyond the Transformer family and achieves the series-wise connection for the first time.</strong>
Êó∂Èó¥Â∫èÂàóÈ¢ÑÊµãÊòØÂÆûÈôÖÂ∫îÁî®ÁöÑÂÖ≥ÈîÆÈúÄÊ±Ç„ÄÇÂèóÁªèÂÖ∏Êó∂Èó¥Â∫èÂàóÂàÜÊûêÂíåÈöèÊú∫ËøáÁ®ãÁêÜËÆ∫ÁöÑÂêØÂèëÔºåÊàë‰ª¨ÊèêÂá∫‰∫Ü Autoformer ‰Ωú‰∏∫ÈÄöÁî®Â∫èÂàóÈ¢ÑÊµãÊ®°Âûã [<a href="https://arxiv.org/abs/2106.13008">ËÆ∫Êñá</a>]„ÄÇAutoformer**Ë∂ÖË∂ä‰∫Ü Transformer ÂÆ∂ÊóèÔºåÈ¶ñÊ¨°ÂÆûÁé∞‰∫ÜÂ∫èÂàóËøûÊé•„ÄÇ**</p>
<p>In long-term forecasting, Autoformer achieves SOTA, with a <strong>38% relative improvement</strong> on six benchmarks, covering five practical applications: <strong>energy, traffic, economics, weather and disease</strong>.
Âú®ÈïøÊúüÈ¢ÑÊµã‰∏≠ÔºåAutoformer ÂÆûÁé∞‰∫Ü SOTAÔºåÂú®ÂÖ≠‰∏™Âü∫ÂáÜ‰∏ä**Áõ∏ÂØπÊèêÂçá‰∫Ü 38%** ÔºåÊ∂µÁõñ‰∫Ü**ËÉΩÊ∫ê„ÄÅ‰∫§ÈÄö„ÄÅÁªèÊµé„ÄÅÂ§©Ê∞îÂíåÁñæÁóÖ**‰∫î‰∏™ÂÆûÈôÖÂ∫îÁî®„ÄÇ</p>
<p><strong>News</strong> (2023.08) Autoformer has been included in <a href="https://huggingface.co/models?search=autoformer">Hugging Face</a>. See <a href="https://huggingface.co/blog/autoformer">blog</a>.
üö©<strong>Êñ∞Èóª</strong>(2023.08) Autoformer Â∑≤ÂåÖÂê´Âú®<a href="https://huggingface.co/models?search=autoformer">Hugging Face</a>‰∏≠„ÄÇÊü•Áúã<a href="https://huggingface.co/blog/autoformer">ÂçöÂÆ¢</a>„ÄÇ</p>
<p>üö©<strong>News</strong> (2023.06) The extension version of Autoformer (<a href="https://www.nature.com/articles/s42256-023-00667-9">Interpretable weather forecasting for worldwide stations with a unified deep model</a>) has been published in Nature Machine Intelligence as the <a href="https://www.nature.com/natmachintell/volumes/5/issues/6">Cover Article</a>.
üö©<strong>Êñ∞Èóª</strong>(2023.06) Autoformer ÁöÑÊâ©Â±ïÁâàÊú¨ (<a href="https://www.nature.com/articles/s42256-023-00667-9">‰ΩøÁî®Áªü‰∏ÄÊ∑±Â∫¶Ê®°Âûã‰∏∫ÂÖ®ÁêÉÁ´ôÁÇπÊèê‰æõÂèØËß£ÈáäÁöÑÂ§©Ê∞îÈ¢ÑÊä•</a>) Âú®„ÄäËá™ÁÑ∂Êú∫Âô®Êô∫ËÉΩ„ÄãÊùÇÂøó‰∏ä‰Ωú‰∏∫<a href="https://www.nature.com/natmachintell/volumes/5/issues/6">Â∞ÅÈù¢ÊñáÁ´†</a>ÂèëË°®„ÄÇ</p>
<p>üö©<strong>News</strong> (2023.02) Autoformer has been included in our [<a href="https://github.com/thuml/Time-Series-Library">Time-Series-Library]</a>, which covers long- and short-term forecasting, imputation, anomaly detection, and classification.
üö©<strong>Êñ∞Èóª</strong>(2023.02) Autoformer Â∑≤ÂåÖÂê´Âú®Êàë‰ª¨ÁöÑ[<a href="https://github.com/thuml/Time-Series-Library">Êó∂Èó¥Â∫èÂàóÂ∫ì]</a>‰∏≠ÔºåÂÆÉÊ∂µÁõñÈïøÊúüÂíåÁü≠ÊúüÈ¢ÑÊµã„ÄÅÂΩíÁ∫≥„ÄÅÂºÇÂ∏∏Ê£ÄÊµãÂíåÂàÜÁ±ª„ÄÇ</p>
<p>üö©<strong>News</strong> (2022.02-2022.03) Autoformer has been deployed in <a href="https://en.wikipedia.org/wiki/2022_Winter_Olympics">2022 Winter Olympics</a> to provide weather forecasting for competition venues, including wind speed and temperature.
üö©<strong>Êñ∞Èóª</strong>Ôºà2022.02-2022.03ÔºâAutoformer Â∑≤ÈÉ®ÁΩ≤Âú®<a href="https://en.wikipedia.org/wiki/2022_Winter_Olympics">2022 Âπ¥ÂÜ¨Â••‰ºöÔºå</a>‰∏∫ÊØîËµõÂú∫È¶ÜÊèê‰æõÂ§©Ê∞îÈ¢ÑÊä•ÔºåÂåÖÊã¨È£éÈÄü„ÄÅÊ∏©Â∫¶Á≠â„ÄÇ</p>
<h2 id="_1">ÂáÜÂ§á<a class="headerlink" href="#_1" title="Permanent link">¬∂</a></h2>
<h3 id="git-clone">git clone<a class="headerlink" href="#git-clone" title="Permanent link">¬∂</a></h3>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317144505215.png"><img alt="image-20250317144505215" src="../images/image-20250317144505215.png"/></a> </p>
<p>ÂÖãÈöÜËøúÁ®ã‰ªìÂ∫ìÁöÑÊñπÊ≥ïÔºö</p>
<p>Ôºà1ÔºâHTTPSÔºåÂú®ÊääÊú¨Âú∞‰ªìÂ∫ìÁöÑ‰ª£Á†Å push Âà∞ËøúÁ®ã‰ªìÂ∫ìÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÈ™åËØÅÁî®Êà∑ÂêçÂíåÂØÜÁ†Å</p>
<p>Ôºà2ÔºâSSHÔºågit ÂºÄÂ§¥ÁöÑÊòØ SSH ÂçèËÆÆÔºåËøôÁßçÊñπÂºèÂú®Êé®ÈÄÅÁöÑÊó∂ÂÄôÔºå‰∏çÈúÄË¶ÅÈ™åËØÅÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºå‰ΩÜÊòØÈúÄË¶ÅÂú® github ‰∏äÊ∑ªÂä†SSHÂÖ¨Èí•ÁöÑÈÖçÁΩÆÔºàÊé®ËçêÔºâ</p>
<p>Ôºà3Ôºâzip download</p>
<p>ÊàëËøôÈáå‰ΩøÁî®‰∫Ü SSH ÈÖçÁΩÆÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317144903028.png"><img alt="image-20250317144903028" src="../images/image-20250317144903028.png"/></a> </p>
<p>ÊúçÂä°Âô®Áõ¥Êé• git clone ÊòØÂæàÊÖ¢„ÄÇÊâÄ‰ª•Êú¨Âú∞ git cloneÔºåÁÑ∂ÂêéÂÜç‰∏ä‰º†ÊúçÂä°Âô®„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317145242243.png"><img alt="image-20250317145242243" src="../images/image-20250317145242243.png"/></a> </p>
<p>Êú¨Âú∞‰∏ãËΩΩÂ•Ω‰ª•ÂêéÔºå‰ΩøÁî® FileZilla‰∏ä‰º†Âà∞ËøúÁ®ãÊúçÂä°Âô®</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317145427044.png"><img alt="image-20250317145427044" src="../images/image-20250317145427044.png"/></a> </p>
<p>downÂà∞Êú¨Âú∞‰ª•ÂêéÔºåÂà†Èô§ .gitÊñá‰ª∂ÔºåÂèñÊ∂àËøûÊé•ÁùÄËøúÁ®ã‰ªìÂ∫ì</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317145705700.png"><img alt="image-20250317145705700" src="../images/image-20250317145705700.png"/></a> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317145752968.png"><img alt="image-20250317145752968" src="../images/image-20250317145752968.png"/></a> </p>
<h3 id="readme">readme<a class="headerlink" href="#readme" title="Permanent link">¬∂</a></h3>
<p>‰∏ãËΩΩÊï∞ÊçÆÈõÜ</p>
<p>ËÆæÁΩÆÊï∞ÊçÆÈõÜË∑ØÂæÑ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317150739551.png"><img alt="image-20250317150739551" src="../images/image-20250317150739551.png"/></a> </p>
<h3 id="_2">Ë∞ÉËØïÈÖçÁΩÆ<a class="headerlink" href="#_2" title="Permanent link">¬∂</a></h3>
<p>Êñ∞Âª∫ÈÖçÁΩÆÊñá‰ª∂</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317150852423.png"><img alt="image-20250317150852423" src="../images/image-20250317150852423.png"/></a> </p>
<p>‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317151048416.png"><img alt="image-20250317151048416" src="../images/image-20250317151048416.png"/></a> </p>
<p>‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a>        {
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a>            "name": "Autoformer",
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a>            "type": "python",
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a>            "request": "attach",
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos="5 "></span></a>            "connect": {
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos="6 "></span></a>                "host": "localhost",
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos="7 "></span></a>                "port": 5997
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos="8 "></span></a>            }
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos="9 "></span></a>        },
</span></code></pre></div>
<p>‰øÆÊîπ sh Êñá‰ª∂</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a>python -m debugpy --listen 5997 --wait-for-client run.py \
</span></code></pre></div>
<h3 id="python">Êñ∞Âª∫ python ËôöÊãüÁéØÂ¢É<a class="headerlink" href="#python" title="Permanent link">¬∂</a></h3>
<p>Êú¨ÂÆûÈ™åÊâÄÈúÄË¶ÅÁöÑÂÆûÈ™åÁéØÂ¢É</p>
<blockquote>
<p>Install Python 3.6, PyTorch 1.9.0.</p>
</blockquote>
<p>ÂèÇËÄÉÂëΩ‰ª§</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos="1 "></span></a>conda create -n dave python==3.8
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos="2 "></span></a>conda activate dave
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos="3 "></span></a>conda install pytorch==2.1.2 torchvision==0.16.2 torchaudio==2.1.2 pytorch-cuda=11.8 -c pytorch -c nvidia
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos="4 "></span></a>conda install numpy
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos="5 "></span></a>conda install scikit-image
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos="6 "></span></a>conda install scikit-learn
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><a href="#__codelineno-2-7"><span class="linenos" data-linenos="7 "></span></a>conda install tqdm
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><a href="#__codelineno-2-8"><span class="linenos" data-linenos="8 "></span></a>conda install pycocotools
</span></code></pre></div>
<p>ÊøÄÊ¥ª„ÄÅÈÄÄÂá∫Ôºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos="1 "></span></a># To activate this environment, use               
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos="2 "></span></a>#     $ conda activate Autoformer
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><a href="#__codelineno-3-3"><span class="linenos" data-linenos="3 "></span></a>#
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><a href="#__codelineno-3-4"><span class="linenos" data-linenos="4 "></span></a># To deactivate an active environment, use
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><a href="#__codelineno-3-5"><span class="linenos" data-linenos="5 "></span></a>#
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><a href="#__codelineno-3-6"><span class="linenos" data-linenos="6 "></span></a>#     $ conda deactivate
</span></code></pre></div>
<p>Áî® requirements.txt ÂÆâË£ÖÈúÄË¶ÅÁöÑÂ∫ì</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos="1 "></span></a>conda create -n SegRNN python=3.8
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos="2 "></span></a>conda activate SegRNN
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><a href="#__codelineno-4-3"><span class="linenos" data-linenos="3 "></span></a>pip install -r requirements.txt
</span></code></pre></div>
<p>ÂêØÂä® sh Êñá‰ª∂Ôºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos="1 "></span></a>sh run_main.sh
</span></code></pre></div>
<p><strong>ÈÄÇÁî®‰∫éÊú¨ÂÆûÈ™åÁöÑÊâÄÊúâÂëΩ‰ª§ :</strong></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">Autoformer</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.6</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">conda</span> <span class="n">activate</span> <span class="n">Autoformer</span>
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">conda</span> <span class="n">env</span> <span class="nb">list</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><a href="#__codelineno-7-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">conda</span> <span class="n">actiavte</span> <span class="n">ÁéØÂ¢ÉÂêç</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><a href="#__codelineno-7-3"><span class="linenos" data-linenos="3 "></span></a><span class="n">conda</span> <span class="n">deactivate</span>
</span></code></pre></div>
<p><a href="https://pytorch.org/">pytorch ÂÆòÁΩë</a>Êü•ÁúãÊâÄÈúÄÂëΩ‰ª§</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317154037815.png"><img alt="image-20250317154037815" src="../images/image-20250317154037815.png"/></a> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317153952283.png"><img alt="image-20250317153952283" src="../images/image-20250317153952283.png"/></a></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos="1 "></span></a>conda install pytorch==1.9.0 torchvision==0.10.0 torchaudio==0.9.0 cudatoolkit=10.2 -c pytorch
</span></code></pre></div>
<h3 id="requirements">requirements<a class="headerlink" href="#requirements" title="Permanent link">¬∂</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="1 "></span></a>pip install -r requirements.txt
</span></code></pre></div>
<p>ÊàñËÄÖÔºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos="1 "></span></a>conda create -n Autoformer python=3.6
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a><a href="#__codelineno-10-2"><span class="linenos" data-linenos="2 "></span></a>conda activate Autoformer
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><a href="#__codelineno-10-3"><span class="linenos" data-linenos="3 "></span></a>conda install pytorch==1.9.0 torchvision==0.10.0 torchaudio==0.9.0 cudatoolkit=10.2 -c pytorch
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a><a href="#__codelineno-10-4"><span class="linenos" data-linenos="4 "></span></a>conda install pandas
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a><a href="#__codelineno-10-5"><span class="linenos" data-linenos="5 "></span></a>conda install scikit-learn
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><a href="#__codelineno-10-6"><span class="linenos" data-linenos="6 "></span></a>conda install debugpy
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a><a href="#__codelineno-10-7"><span class="linenos" data-linenos="7 "></span></a>conda install matplotlib
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a><a href="#__codelineno-10-8"><span class="linenos" data-linenos="8 "></span></a>conda install reformer_pytorch
</span></code></pre></div>
<p>ÈÖçÁΩÆÂ•Ω‰ª•ÂêéÔºåÊàêÂäüËøõÂÖ•Ë∞ÉËØïÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317155629524.png"><img alt="image-20250317155629524" src="../images/image-20250317155629524.png"/></a> </p>
<h2 id="_3">ÂºÄÂßãË∞ÉËØï<a class="headerlink" href="#_3" title="Permanent link">¬∂</a></h2>
<p>‰ª£Á†ÅÁõ∏‰ººÂ∫¶ÊûÅÈ´ò„ÄÇ</p>
<p><strong>Autoformer initÔºö36Ôºà18Ôºâ-„Äã24</strong></p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317160059801.png"><img alt="image-20250317160059801" src="../images/image-20250317160059801.png"/></a></p>
<p>setting:</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos="1 "></span></a>ili_36_24_Autoformer_custom_ftM_sl36_ll18_pl24_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0
</span></code></pre></div>
<p>model_id  36 È¢ÑÊµã 24 Ê≠•ÈïøÔºàlabel=18Ôºâ„ÄÅAutoFormer Ê®°ÂûãÔºåËá™ÂÆö‰πâÊï∞ÊçÆÈõÜÔºåÈ¢ÑÊµãÂ§öÂèòÈáèÔºåËæìÂÖ•Â∫èÂàó 36ÔºåÊ†áÁ≠æÂ∫èÂàó 18ÔºåÈ¢ÑÊµãÂ∫èÂàó 24ÔºåÂµåÂÖ•Áª¥Â∫¶ 512ÔºåÊ≥®ÊÑèÂäõÂ§¥Êï∞ 8Ôºå2Â±ÇÁºñÁ†ÅÂ±ÇÔºå1 Â±ÇËß£Á†ÅÂ±ÇÔºå</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos="1 "></span></a>df2048_fc3_ebtimeF_dtTrue_Exp_0
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a><a href="#__codelineno-12-2"><span class="linenos" data-linenos="2 "></span></a>                args.d_ff,
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><a href="#__codelineno-12-3"><span class="linenos" data-linenos="3 "></span></a>                args.factor,
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a><a href="#__codelineno-12-4"><span class="linenos" data-linenos="4 "></span></a>                args.embed,
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a><a href="#__codelineno-12-5"><span class="linenos" data-linenos="5 "></span></a>                args.distil,
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a><a href="#__codelineno-12-6"><span class="linenos" data-linenos="6 "></span></a>                args.des, ii)
</span></code></pre></div>
<p><strong>Autoformer model</strong></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><a href="#__codelineno-13-1"><span class="linenos" data-linenos="  1 "></span></a><span class="n">Model</span><span class="p">(</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a><a href="#__codelineno-13-2"><span class="linenos" data-linenos="  2 "></span></a>  <span class="p">(</span><span class="n">decomp</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a><a href="#__codelineno-13-3"><span class="linenos" data-linenos="  3 "></span></a>    <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a><a href="#__codelineno-13-4"><span class="linenos" data-linenos="  4 "></span></a>      <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5"></a><a href="#__codelineno-13-5"><span class="linenos" data-linenos="  5 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6"></a><a href="#__codelineno-13-6"><span class="linenos" data-linenos="  6 "></span></a>  <span class="p">)</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7"></a><a href="#__codelineno-13-7"><span class="linenos" data-linenos="  7 "></span></a>  <span class="p">(</span><span class="n">enc_embedding</span><span class="p">):</span> <span class="n">DataEmbedding_wo_pos</span><span class="p">(</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8"></a><a href="#__codelineno-13-8"><span class="linenos" data-linenos="  8 "></span></a>    <span class="p">(</span><span class="n">value_embedding</span><span class="p">):</span> <span class="n">TokenEmbedding</span><span class="p">(</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9"></a><a href="#__codelineno-13-9"><span class="linenos" data-linenos="  9 "></span></a>      <span class="p">(</span><span class="n">tokenConv</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="n">circular</span><span class="p">)</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10"></a><a href="#__codelineno-13-10"><span class="linenos" data-linenos=" 10 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11"></a><a href="#__codelineno-13-11"><span class="linenos" data-linenos=" 11 "></span></a>    <span class="p">(</span><span class="n">position_embedding</span><span class="p">):</span> <span class="n">PositionalEmbedding</span><span class="p">()</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12"></a><a href="#__codelineno-13-12"><span class="linenos" data-linenos=" 12 "></span></a>    <span class="p">(</span><span class="n">temporal_embedding</span><span class="p">):</span> <span class="n">TimeFeatureEmbedding</span><span class="p">(</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13"></a><a href="#__codelineno-13-13"><span class="linenos" data-linenos=" 13 "></span></a>      <span class="p">(</span><span class="n">embed</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14"></a><a href="#__codelineno-13-14"><span class="linenos" data-linenos=" 14 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15"></a><a href="#__codelineno-13-15"><span class="linenos" data-linenos=" 15 "></span></a>    <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16"></a><a href="#__codelineno-13-16"><span class="linenos" data-linenos=" 16 "></span></a>  <span class="p">)</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17"></a><a href="#__codelineno-13-17"><span class="linenos" data-linenos=" 17 "></span></a>  <span class="p">(</span><span class="n">dec_embedding</span><span class="p">):</span> <span class="n">DataEmbedding_wo_pos</span><span class="p">(</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18"></a><a href="#__codelineno-13-18"><span class="linenos" data-linenos=" 18 "></span></a>    <span class="p">(</span><span class="n">value_embedding</span><span class="p">):</span> <span class="n">TokenEmbedding</span><span class="p">(</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19"></a><a href="#__codelineno-13-19"><span class="linenos" data-linenos=" 19 "></span></a>      <span class="p">(</span><span class="n">tokenConv</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="n">circular</span><span class="p">)</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20"></a><a href="#__codelineno-13-20"><span class="linenos" data-linenos=" 20 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21"></a><a href="#__codelineno-13-21"><span class="linenos" data-linenos=" 21 "></span></a>    <span class="p">(</span><span class="n">position_embedding</span><span class="p">):</span> <span class="n">PositionalEmbedding</span><span class="p">()</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22"></a><a href="#__codelineno-13-22"><span class="linenos" data-linenos=" 22 "></span></a>    <span class="p">(</span><span class="n">temporal_embedding</span><span class="p">):</span> <span class="n">TimeFeatureEmbedding</span><span class="p">(</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23"></a><a href="#__codelineno-13-23"><span class="linenos" data-linenos=" 23 "></span></a>      <span class="p">(</span><span class="n">embed</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24"></a><a href="#__codelineno-13-24"><span class="linenos" data-linenos=" 24 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25"></a><a href="#__codelineno-13-25"><span class="linenos" data-linenos=" 25 "></span></a>    <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26"></a><a href="#__codelineno-13-26"><span class="linenos" data-linenos=" 26 "></span></a>  <span class="p">)</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27"></a><a href="#__codelineno-13-27"><span class="linenos" data-linenos=" 27 "></span></a>  <span class="p">(</span><span class="n">encoder</span><span class="p">):</span> <span class="n">Encoder</span><span class="p">(</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28"></a><a href="#__codelineno-13-28"><span class="linenos" data-linenos=" 28 "></span></a>    <span class="p">(</span><span class="n">attn_layers</span><span class="p">):</span> <span class="n">ModuleList</span><span class="p">(</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29"></a><a href="#__codelineno-13-29"><span class="linenos" data-linenos=" 29 "></span></a>      <span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">EncoderLayer</span><span class="p">(</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30"></a><a href="#__codelineno-13-30"><span class="linenos" data-linenos=" 30 "></span></a>        <span class="p">(</span><span class="n">attention</span><span class="p">):</span> <span class="n">AutoCorrelationLayer</span><span class="p">(</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31"></a><a href="#__codelineno-13-31"><span class="linenos" data-linenos=" 31 "></span></a>          <span class="p">(</span><span class="n">inner_correlation</span><span class="p">):</span> <span class="n">AutoCorrelation</span><span class="p">(</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32"></a><a href="#__codelineno-13-32"><span class="linenos" data-linenos=" 32 "></span></a>            <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33"></a><a href="#__codelineno-13-33"><span class="linenos" data-linenos=" 33 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34"></a><a href="#__codelineno-13-34"><span class="linenos" data-linenos=" 34 "></span></a>          <span class="p">(</span><span class="n">query_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35"></a><a href="#__codelineno-13-35"><span class="linenos" data-linenos=" 35 "></span></a>          <span class="p">(</span><span class="n">key_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36"></a><a href="#__codelineno-13-36"><span class="linenos" data-linenos=" 36 "></span></a>          <span class="p">(</span><span class="n">value_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37"></a><a href="#__codelineno-13-37"><span class="linenos" data-linenos=" 37 "></span></a>          <span class="p">(</span><span class="n">out_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38"></a><a href="#__codelineno-13-38"><span class="linenos" data-linenos=" 38 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39"></a><a href="#__codelineno-13-39"><span class="linenos" data-linenos=" 39 "></span></a>        <span class="p">(</span><span class="n">conv1</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40"></a><a href="#__codelineno-13-40"><span class="linenos" data-linenos=" 40 "></span></a>        <span class="p">(</span><span class="n">conv2</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41"></a><a href="#__codelineno-13-41"><span class="linenos" data-linenos=" 41 "></span></a>        <span class="p">(</span><span class="n">decomp1</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42"></a><a href="#__codelineno-13-42"><span class="linenos" data-linenos=" 42 "></span></a>          <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43"></a><a href="#__codelineno-13-43"><span class="linenos" data-linenos=" 43 "></span></a>            <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44"></a><a href="#__codelineno-13-44"><span class="linenos" data-linenos=" 44 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45"></a><a href="#__codelineno-13-45"><span class="linenos" data-linenos=" 45 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46"></a><a href="#__codelineno-13-46"><span class="linenos" data-linenos=" 46 "></span></a>        <span class="p">(</span><span class="n">decomp2</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-47"><a id="__codelineno-13-47" name="__codelineno-13-47"></a><a href="#__codelineno-13-47"><span class="linenos" data-linenos=" 47 "></span></a>          <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-48"><a id="__codelineno-13-48" name="__codelineno-13-48"></a><a href="#__codelineno-13-48"><span class="linenos" data-linenos=" 48 "></span></a>            <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-49"><a id="__codelineno-13-49" name="__codelineno-13-49"></a><a href="#__codelineno-13-49"><span class="linenos" data-linenos=" 49 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-50"><a id="__codelineno-13-50" name="__codelineno-13-50"></a><a href="#__codelineno-13-50"><span class="linenos" data-linenos=" 50 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-51"><a id="__codelineno-13-51" name="__codelineno-13-51"></a><a href="#__codelineno-13-51"><span class="linenos" data-linenos=" 51 "></span></a>        <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-52"><a id="__codelineno-13-52" name="__codelineno-13-52"></a><a href="#__codelineno-13-52"><span class="linenos" data-linenos=" 52 "></span></a>      <span class="p">)</span>
</span><span id="__span-13-53"><a id="__codelineno-13-53" name="__codelineno-13-53"></a><a href="#__codelineno-13-53"><span class="linenos" data-linenos=" 53 "></span></a>      <span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">EncoderLayer</span><span class="p">(</span>
</span><span id="__span-13-54"><a id="__codelineno-13-54" name="__codelineno-13-54"></a><a href="#__codelineno-13-54"><span class="linenos" data-linenos=" 54 "></span></a>        <span class="p">(</span><span class="n">attention</span><span class="p">):</span> <span class="n">AutoCorrelationLayer</span><span class="p">(</span>
</span><span id="__span-13-55"><a id="__codelineno-13-55" name="__codelineno-13-55"></a><a href="#__codelineno-13-55"><span class="linenos" data-linenos=" 55 "></span></a>          <span class="p">(</span><span class="n">inner_correlation</span><span class="p">):</span> <span class="n">AutoCorrelation</span><span class="p">(</span>
</span><span id="__span-13-56"><a id="__codelineno-13-56" name="__codelineno-13-56"></a><a href="#__codelineno-13-56"><span class="linenos" data-linenos=" 56 "></span></a>            <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-57"><a id="__codelineno-13-57" name="__codelineno-13-57"></a><a href="#__codelineno-13-57"><span class="linenos" data-linenos=" 57 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-58"><a id="__codelineno-13-58" name="__codelineno-13-58"></a><a href="#__codelineno-13-58"><span class="linenos" data-linenos=" 58 "></span></a>          <span class="p">(</span><span class="n">query_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-59"><a id="__codelineno-13-59" name="__codelineno-13-59"></a><a href="#__codelineno-13-59"><span class="linenos" data-linenos=" 59 "></span></a>          <span class="p">(</span><span class="n">key_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-60"><a id="__codelineno-13-60" name="__codelineno-13-60"></a><a href="#__codelineno-13-60"><span class="linenos" data-linenos=" 60 "></span></a>          <span class="p">(</span><span class="n">value_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-61"><a id="__codelineno-13-61" name="__codelineno-13-61"></a><a href="#__codelineno-13-61"><span class="linenos" data-linenos=" 61 "></span></a>          <span class="p">(</span><span class="n">out_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-62"><a id="__codelineno-13-62" name="__codelineno-13-62"></a><a href="#__codelineno-13-62"><span class="linenos" data-linenos=" 62 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-63"><a id="__codelineno-13-63" name="__codelineno-13-63"></a><a href="#__codelineno-13-63"><span class="linenos" data-linenos=" 63 "></span></a>        <span class="p">(</span><span class="n">conv1</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-64"><a id="__codelineno-13-64" name="__codelineno-13-64"></a><a href="#__codelineno-13-64"><span class="linenos" data-linenos=" 64 "></span></a>        <span class="p">(</span><span class="n">conv2</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-65"><a id="__codelineno-13-65" name="__codelineno-13-65"></a><a href="#__codelineno-13-65"><span class="linenos" data-linenos=" 65 "></span></a>        <span class="p">(</span><span class="n">decomp1</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-66"><a id="__codelineno-13-66" name="__codelineno-13-66"></a><a href="#__codelineno-13-66"><span class="linenos" data-linenos=" 66 "></span></a>          <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-67"><a id="__codelineno-13-67" name="__codelineno-13-67"></a><a href="#__codelineno-13-67"><span class="linenos" data-linenos=" 67 "></span></a>            <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-68"><a id="__codelineno-13-68" name="__codelineno-13-68"></a><a href="#__codelineno-13-68"><span class="linenos" data-linenos=" 68 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-69"><a id="__codelineno-13-69" name="__codelineno-13-69"></a><a href="#__codelineno-13-69"><span class="linenos" data-linenos=" 69 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-70"><a id="__codelineno-13-70" name="__codelineno-13-70"></a><a href="#__codelineno-13-70"><span class="linenos" data-linenos=" 70 "></span></a>        <span class="p">(</span><span class="n">decomp2</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-71"><a id="__codelineno-13-71" name="__codelineno-13-71"></a><a href="#__codelineno-13-71"><span class="linenos" data-linenos=" 71 "></span></a>          <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-72"><a id="__codelineno-13-72" name="__codelineno-13-72"></a><a href="#__codelineno-13-72"><span class="linenos" data-linenos=" 72 "></span></a>            <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-73"><a id="__codelineno-13-73" name="__codelineno-13-73"></a><a href="#__codelineno-13-73"><span class="linenos" data-linenos=" 73 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-74"><a id="__codelineno-13-74" name="__codelineno-13-74"></a><a href="#__codelineno-13-74"><span class="linenos" data-linenos=" 74 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-75"><a id="__codelineno-13-75" name="__codelineno-13-75"></a><a href="#__codelineno-13-75"><span class="linenos" data-linenos=" 75 "></span></a>        <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-76"><a id="__codelineno-13-76" name="__codelineno-13-76"></a><a href="#__codelineno-13-76"><span class="linenos" data-linenos=" 76 "></span></a>      <span class="p">)</span>
</span><span id="__span-13-77"><a id="__codelineno-13-77" name="__codelineno-13-77"></a><a href="#__codelineno-13-77"><span class="linenos" data-linenos=" 77 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-78"><a id="__codelineno-13-78" name="__codelineno-13-78"></a><a href="#__codelineno-13-78"><span class="linenos" data-linenos=" 78 "></span></a>    <span class="p">(</span><span class="n">norm</span><span class="p">):</span> <span class="n">my_Layernorm</span><span class="p">(</span>
</span><span id="__span-13-79"><a id="__codelineno-13-79" name="__codelineno-13-79"></a><a href="#__codelineno-13-79"><span class="linenos" data-linenos=" 79 "></span></a>      <span class="p">(</span><span class="n">layernorm</span><span class="p">):</span> <span class="n">LayerNorm</span><span class="p">((</span><span class="mi">512</span><span class="p">,),</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-80"><a id="__codelineno-13-80" name="__codelineno-13-80"></a><a href="#__codelineno-13-80"><span class="linenos" data-linenos=" 80 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-81"><a id="__codelineno-13-81" name="__codelineno-13-81"></a><a href="#__codelineno-13-81"><span class="linenos" data-linenos=" 81 "></span></a>  <span class="p">)</span>
</span><span id="__span-13-82"><a id="__codelineno-13-82" name="__codelineno-13-82"></a><a href="#__codelineno-13-82"><span class="linenos" data-linenos=" 82 "></span></a>  <span class="p">(</span><span class="n">decoder</span><span class="p">):</span> <span class="n">Decoder</span><span class="p">(</span>
</span><span id="__span-13-83"><a id="__codelineno-13-83" name="__codelineno-13-83"></a><a href="#__codelineno-13-83"><span class="linenos" data-linenos=" 83 "></span></a>    <span class="p">(</span><span class="n">layers</span><span class="p">):</span> <span class="n">ModuleList</span><span class="p">(</span>
</span><span id="__span-13-84"><a id="__codelineno-13-84" name="__codelineno-13-84"></a><a href="#__codelineno-13-84"><span class="linenos" data-linenos=" 84 "></span></a>      <span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">DecoderLayer</span><span class="p">(</span>
</span><span id="__span-13-85"><a id="__codelineno-13-85" name="__codelineno-13-85"></a><a href="#__codelineno-13-85"><span class="linenos" data-linenos=" 85 "></span></a>        <span class="p">(</span><span class="n">self_attention</span><span class="p">):</span> <span class="n">AutoCorrelationLayer</span><span class="p">(</span>
</span><span id="__span-13-86"><a id="__codelineno-13-86" name="__codelineno-13-86"></a><a href="#__codelineno-13-86"><span class="linenos" data-linenos=" 86 "></span></a>          <span class="p">(</span><span class="n">inner_correlation</span><span class="p">):</span> <span class="n">AutoCorrelation</span><span class="p">(</span>
</span><span id="__span-13-87"><a id="__codelineno-13-87" name="__codelineno-13-87"></a><a href="#__codelineno-13-87"><span class="linenos" data-linenos=" 87 "></span></a>            <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-88"><a id="__codelineno-13-88" name="__codelineno-13-88"></a><a href="#__codelineno-13-88"><span class="linenos" data-linenos=" 88 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-89"><a id="__codelineno-13-89" name="__codelineno-13-89"></a><a href="#__codelineno-13-89"><span class="linenos" data-linenos=" 89 "></span></a>          <span class="p">(</span><span class="n">query_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-90"><a id="__codelineno-13-90" name="__codelineno-13-90"></a><a href="#__codelineno-13-90"><span class="linenos" data-linenos=" 90 "></span></a>          <span class="p">(</span><span class="n">key_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-91"><a id="__codelineno-13-91" name="__codelineno-13-91"></a><a href="#__codelineno-13-91"><span class="linenos" data-linenos=" 91 "></span></a>          <span class="p">(</span><span class="n">value_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-92"><a id="__codelineno-13-92" name="__codelineno-13-92"></a><a href="#__codelineno-13-92"><span class="linenos" data-linenos=" 92 "></span></a>          <span class="p">(</span><span class="n">out_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-93"><a id="__codelineno-13-93" name="__codelineno-13-93"></a><a href="#__codelineno-13-93"><span class="linenos" data-linenos=" 93 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-94"><a id="__codelineno-13-94" name="__codelineno-13-94"></a><a href="#__codelineno-13-94"><span class="linenos" data-linenos=" 94 "></span></a>        <span class="p">(</span><span class="n">cross_attention</span><span class="p">):</span> <span class="n">AutoCorrelationLayer</span><span class="p">(</span>
</span><span id="__span-13-95"><a id="__codelineno-13-95" name="__codelineno-13-95"></a><a href="#__codelineno-13-95"><span class="linenos" data-linenos=" 95 "></span></a>          <span class="p">(</span><span class="n">inner_correlation</span><span class="p">):</span> <span class="n">AutoCorrelation</span><span class="p">(</span>
</span><span id="__span-13-96"><a id="__codelineno-13-96" name="__codelineno-13-96"></a><a href="#__codelineno-13-96"><span class="linenos" data-linenos=" 96 "></span></a>            <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-97"><a id="__codelineno-13-97" name="__codelineno-13-97"></a><a href="#__codelineno-13-97"><span class="linenos" data-linenos=" 97 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-98"><a id="__codelineno-13-98" name="__codelineno-13-98"></a><a href="#__codelineno-13-98"><span class="linenos" data-linenos=" 98 "></span></a>          <span class="p">(</span><span class="n">query_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-99"><a id="__codelineno-13-99" name="__codelineno-13-99"></a><a href="#__codelineno-13-99"><span class="linenos" data-linenos=" 99 "></span></a>          <span class="p">(</span><span class="n">key_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-100"><a id="__codelineno-13-100" name="__codelineno-13-100"></a><a href="#__codelineno-13-100"><span class="linenos" data-linenos="100 "></span></a>          <span class="p">(</span><span class="n">value_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-101"><a id="__codelineno-13-101" name="__codelineno-13-101"></a><a href="#__codelineno-13-101"><span class="linenos" data-linenos="101 "></span></a>          <span class="p">(</span><span class="n">out_projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-102"><a id="__codelineno-13-102" name="__codelineno-13-102"></a><a href="#__codelineno-13-102"><span class="linenos" data-linenos="102 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-103"><a id="__codelineno-13-103" name="__codelineno-13-103"></a><a href="#__codelineno-13-103"><span class="linenos" data-linenos="103 "></span></a>        <span class="p">(</span><span class="n">conv1</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-104"><a id="__codelineno-13-104" name="__codelineno-13-104"></a><a href="#__codelineno-13-104"><span class="linenos" data-linenos="104 "></span></a>        <span class="p">(</span><span class="n">conv2</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-105"><a id="__codelineno-13-105" name="__codelineno-13-105"></a><a href="#__codelineno-13-105"><span class="linenos" data-linenos="105 "></span></a>        <span class="p">(</span><span class="n">decomp1</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-106"><a id="__codelineno-13-106" name="__codelineno-13-106"></a><a href="#__codelineno-13-106"><span class="linenos" data-linenos="106 "></span></a>          <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-107"><a id="__codelineno-13-107" name="__codelineno-13-107"></a><a href="#__codelineno-13-107"><span class="linenos" data-linenos="107 "></span></a>            <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-108"><a id="__codelineno-13-108" name="__codelineno-13-108"></a><a href="#__codelineno-13-108"><span class="linenos" data-linenos="108 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-109"><a id="__codelineno-13-109" name="__codelineno-13-109"></a><a href="#__codelineno-13-109"><span class="linenos" data-linenos="109 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-110"><a id="__codelineno-13-110" name="__codelineno-13-110"></a><a href="#__codelineno-13-110"><span class="linenos" data-linenos="110 "></span></a>        <span class="p">(</span><span class="n">decomp2</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-111"><a id="__codelineno-13-111" name="__codelineno-13-111"></a><a href="#__codelineno-13-111"><span class="linenos" data-linenos="111 "></span></a>          <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-112"><a id="__codelineno-13-112" name="__codelineno-13-112"></a><a href="#__codelineno-13-112"><span class="linenos" data-linenos="112 "></span></a>            <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-113"><a id="__codelineno-13-113" name="__codelineno-13-113"></a><a href="#__codelineno-13-113"><span class="linenos" data-linenos="113 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-114"><a id="__codelineno-13-114" name="__codelineno-13-114"></a><a href="#__codelineno-13-114"><span class="linenos" data-linenos="114 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-115"><a id="__codelineno-13-115" name="__codelineno-13-115"></a><a href="#__codelineno-13-115"><span class="linenos" data-linenos="115 "></span></a>        <span class="p">(</span><span class="n">decomp3</span><span class="p">):</span> <span class="n">series_decomp</span><span class="p">(</span>
</span><span id="__span-13-116"><a id="__codelineno-13-116" name="__codelineno-13-116"></a><a href="#__codelineno-13-116"><span class="linenos" data-linenos="116 "></span></a>          <span class="p">(</span><span class="n">moving_avg</span><span class="p">):</span> <span class="n">moving_avg</span><span class="p">(</span>
</span><span id="__span-13-117"><a id="__codelineno-13-117" name="__codelineno-13-117"></a><a href="#__codelineno-13-117"><span class="linenos" data-linenos="117 "></span></a>            <span class="p">(</span><span class="n">avg</span><span class="p">):</span> <span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="__span-13-118"><a id="__codelineno-13-118" name="__codelineno-13-118"></a><a href="#__codelineno-13-118"><span class="linenos" data-linenos="118 "></span></a>          <span class="p">)</span>
</span><span id="__span-13-119"><a id="__codelineno-13-119" name="__codelineno-13-119"></a><a href="#__codelineno-13-119"><span class="linenos" data-linenos="119 "></span></a>        <span class="p">)</span>
</span><span id="__span-13-120"><a id="__codelineno-13-120" name="__codelineno-13-120"></a><a href="#__codelineno-13-120"><span class="linenos" data-linenos="120 "></span></a>        <span class="p">(</span><span class="n">dropout</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-13-121"><a id="__codelineno-13-121" name="__codelineno-13-121"></a><a href="#__codelineno-13-121"><span class="linenos" data-linenos="121 "></span></a>        <span class="p">(</span><span class="n">projection</span><span class="p">):</span> <span class="n">Conv1d</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="n">circular</span><span class="p">)</span>
</span><span id="__span-13-122"><a id="__codelineno-13-122" name="__codelineno-13-122"></a><a href="#__codelineno-13-122"><span class="linenos" data-linenos="122 "></span></a>      <span class="p">)</span>
</span><span id="__span-13-123"><a id="__codelineno-13-123" name="__codelineno-13-123"></a><a href="#__codelineno-13-123"><span class="linenos" data-linenos="123 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-124"><a id="__codelineno-13-124" name="__codelineno-13-124"></a><a href="#__codelineno-13-124"><span class="linenos" data-linenos="124 "></span></a>    <span class="p">(</span><span class="n">norm</span><span class="p">):</span> <span class="n">my_Layernorm</span><span class="p">(</span>
</span><span id="__span-13-125"><a id="__codelineno-13-125" name="__codelineno-13-125"></a><a href="#__codelineno-13-125"><span class="linenos" data-linenos="125 "></span></a>      <span class="p">(</span><span class="n">layernorm</span><span class="p">):</span> <span class="n">LayerNorm</span><span class="p">((</span><span class="mi">512</span><span class="p">,),</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-126"><a id="__codelineno-13-126" name="__codelineno-13-126"></a><a href="#__codelineno-13-126"><span class="linenos" data-linenos="126 "></span></a>    <span class="p">)</span>
</span><span id="__span-13-127"><a id="__codelineno-13-127" name="__codelineno-13-127"></a><a href="#__codelineno-13-127"><span class="linenos" data-linenos="127 "></span></a>    <span class="p">(</span><span class="n">projection</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-128"><a id="__codelineno-13-128" name="__codelineno-13-128"></a><a href="#__codelineno-13-128"><span class="linenos" data-linenos="128 "></span></a>  <span class="p">)</span>
</span><span id="__span-13-129"><a id="__codelineno-13-129" name="__codelineno-13-129"></a><a href="#__codelineno-13-129"><span class="linenos" data-linenos="129 "></span></a><span class="p">)</span>
</span></code></pre></div>
<p>Êï∞ÊçÆÈõÜÁöÑÂä†ËΩΩÊòØÂÆåÂÖ®‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<h3 id="encoder-embedding">encoder embedding<a class="headerlink" href="#encoder-embedding" title="Permanent link">¬∂</a></h3>
<p>ÁõÆÁöÑÔºöÁªìÂêàÊó∂Èó¥ÁâπÂæÅÔºåÂ∞Ü Êï∞ÊçÆÁâπÂæÅÂµåÂÖ•Âà∞ÊåáÂÆöÁª¥Â∫¶</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><a href="#__codelineno-14-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">enc_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc_embedding</span><span class="p">(</span><span class="n">x_enc</span><span class="p">,</span> <span class="n">x_mark_enc</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><a href="#__codelineno-15-1"><span class="linenos" data-linenos="1 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">enc_embedding</span> <span class="o">=</span> <span class="n">DataEmbedding_wo_pos</span><span class="p">(</span><span class="n">configs</span><span class="o">.</span><span class="n">enc_in</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">embed</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span><span class="n">configs</span><span class="o">.</span><span class="n">dropout</span><span class="p">)</span>
</span></code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317204752276.png"><img alt="image-20250317204752276" src="../images/image-20250317204752276.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317205258626.png"><img alt="image-20250317205258626" src="../images/image-20250317205258626.png"/></a></p>
<p><strong>ÊµÅÁ®ãÂõæ</strong></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><a href="#__codelineno-16-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="n">ËæìÂÖ•</span><span class="p">:</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a><a href="#__codelineno-16-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="n">x_enc</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">]</span>        <span class="n">x_mark_enc</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">time_features</span><span class="p">]</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a><a href="#__codelineno-16-3"><span class="linenos" data-linenos=" 3 "></span></a>    <span class="o">|</span>                        <span class="o">|</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a><a href="#__codelineno-16-4"><span class="linenos" data-linenos=" 4 "></span></a>    <span class="n">v</span>                        <span class="n">v</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a><a href="#__codelineno-16-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="o">+-----------------------------------------------+</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a><a href="#__codelineno-16-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="o">|</span>           <span class="n">Model</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span><span class="n">Ë∞ÉÁî®</span>                  <span class="o">|</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a><a href="#__codelineno-16-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="o">|</span>      <span class="bp">self</span><span class="o">.</span><span class="n">enc_embedding</span><span class="p">(</span><span class="n">x_enc</span><span class="p">,</span> <span class="n">x_mark_enc</span><span class="p">)</span>    <span class="o">|</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a><a href="#__codelineno-16-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="o">+-----------------------------------------------+</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a><a href="#__codelineno-16-9"><span class="linenos" data-linenos=" 9 "></span></a>            <span class="o">|</span>                <span class="o">|</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a><a href="#__codelineno-16-10"><span class="linenos" data-linenos="10 "></span></a>            <span class="n">v</span>                <span class="n">v</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><a href="#__codelineno-16-11"><span class="linenos" data-linenos="11 "></span></a><span class="o">+------------------------+</span>  <span class="o">+---------------------------+</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12"></a><a href="#__codelineno-16-12"><span class="linenos" data-linenos="12 "></span></a><span class="o">|</span> <span class="n">TokenEmbedding</span> <span class="p">(</span><span class="n">ÂÄºÂµåÂÖ•</span><span class="p">)</span> <span class="o">|</span>  <span class="o">|</span> <span class="n">TemporalEmbedding</span> <span class="p">(</span><span class="n">Êó∂Èó¥ÂµåÂÖ•</span><span class="p">)</span><span class="o">|</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13"></a><a href="#__codelineno-16-13"><span class="linenos" data-linenos="13 "></span></a><span class="o">+------------------------+</span>  <span class="o">+---------------------------+</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14"></a><a href="#__codelineno-16-14"><span class="linenos" data-linenos="14 "></span></a><span class="o">|</span> <span class="n">ËæìÂÖ•</span><span class="p">:</span> <span class="n">x</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">]</span>      <span class="o">|</span>  <span class="o">|</span> <span class="n">ËæìÂÖ•</span><span class="p">:</span> <span class="n">x_mark</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">time_f</span><span class="p">]</span><span class="o">|</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15"></a><a href="#__codelineno-16-15"><span class="linenos" data-linenos="15 "></span></a><span class="o">|</span>                        <span class="o">|</span>  <span class="o">|</span>                           <span class="o">|</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16"></a><a href="#__codelineno-16-16"><span class="linenos" data-linenos="16 "></span></a><span class="o">|</span> <span class="n">Êìç‰Ωú</span><span class="p">:</span>                  <span class="o">|</span>  <span class="o">|</span> <span class="n">Êìç‰Ωú</span><span class="p">:</span>                     <span class="o">|</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17"></a><a href="#__codelineno-16-17"><span class="linenos" data-linenos="17 "></span></a><span class="o">|</span> <span class="mf">1.</span><span class="n">ËΩ¨ÁΩÆ</span><span class="p">:</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">L</span><span class="p">]</span>      <span class="o">|</span>  <span class="o">|</span> <span class="mf">1.</span><span class="n">ËΩ¨Êç¢‰∏∫longÁ±ªÂûã</span>          <span class="o">|</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18"></a><a href="#__codelineno-16-18"><span class="linenos" data-linenos="18 "></span></a><span class="o">|</span> <span class="mf">2.1</span><span class="n">DÂç∑ÁßØ</span><span class="p">:</span> <span class="n">D</span> <span class="o">-&gt;</span> <span class="n">d_model</span> <span class="o">|</span>  <span class="o">|</span> <span class="mf">2.</span><span class="n">ÊèêÂèñÊó∂Èó¥ÁâπÂæÅ</span><span class="p">:</span>           <span class="o">|</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19"></a><a href="#__codelineno-16-19"><span class="linenos" data-linenos="19 "></span></a><span class="o">|</span> <span class="mf">3.</span><span class="n">ËΩ¨ÁΩÆÂõû</span><span class="p">:</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">d_model</span><span class="p">]</span><span class="o">|</span>  <span class="o">|</span>   <span class="o">-</span> <span class="n">month_x</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">])</span>   <span class="o">|</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20"></a><a href="#__codelineno-16-20"><span class="linenos" data-linenos="20 "></span></a><span class="o">|</span>                        <span class="o">|</span>  <span class="o">|</span>   <span class="o">-</span> <span class="n">day_x</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">])</span>      <span class="o">|</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21"></a><a href="#__codelineno-16-21"><span class="linenos" data-linenos="21 "></span></a><span class="o">|</span> <span class="n">ËæìÂá∫</span><span class="p">:</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">d_model</span><span class="p">]</span>  <span class="o">|</span>  <span class="o">|</span>   <span class="o">-</span> <span class="n">weekday_x</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">])</span>  <span class="o">|</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22"></a><a href="#__codelineno-16-22"><span class="linenos" data-linenos="22 "></span></a><span class="o">|</span>                        <span class="o">|</span>  <span class="o">|</span>   <span class="o">-</span> <span class="n">hour_x</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,:,</span><span class="mi">3</span><span class="p">])</span>     <span class="o">|</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23"></a><a href="#__codelineno-16-23"><span class="linenos" data-linenos="23 "></span></a><span class="o">+------------------------+</span>  <span class="o">|</span>   <span class="o">-</span> <span class="n">minute_x</span> <span class="p">(</span><span class="n">ÂèØÈÄâ</span><span class="p">)</span>       <span class="o">|</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24"></a><a href="#__codelineno-16-24"><span class="linenos" data-linenos="24 "></span></a>            <span class="o">|</span>               <span class="o">|</span>                           <span class="o">|</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25"></a><a href="#__codelineno-16-25"><span class="linenos" data-linenos="25 "></span></a>            <span class="o">|</span>               <span class="o">|</span> <span class="mf">3.</span><span class="n">Êü•Ë°®Ëé∑ÂèñÂêÑÊó∂Èó¥ÁâπÂæÅÁöÑÂµåÂÖ•</span>  <span class="o">|</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26"></a><a href="#__codelineno-16-26"><span class="linenos" data-linenos="26 "></span></a>            <span class="o">|</span>               <span class="o">|</span> <span class="mf">4.</span><span class="n">Â∞ÜÊâÄÊúâÊó∂Èó¥ÂµåÂÖ•Áõ∏Âä†</span>       <span class="o">|</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27"></a><a href="#__codelineno-16-27"><span class="linenos" data-linenos="27 "></span></a>            <span class="o">|</span>               <span class="o">|</span>                           <span class="o">|</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28"></a><a href="#__codelineno-16-28"><span class="linenos" data-linenos="28 "></span></a>            <span class="o">|</span>               <span class="o">|</span> <span class="n">ËæìÂá∫</span><span class="p">:</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">d_model</span><span class="p">]</span>     <span class="o">|</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29"></a><a href="#__codelineno-16-29"><span class="linenos" data-linenos="29 "></span></a>            <span class="o">|</span>               <span class="o">+---------------------------+</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30"></a><a href="#__codelineno-16-30"><span class="linenos" data-linenos="30 "></span></a>            <span class="o">|</span>                        <span class="o">|</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31"></a><a href="#__codelineno-16-31"><span class="linenos" data-linenos="31 "></span></a>            <span class="o">+------------+------------+</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32"></a><a href="#__codelineno-16-32"><span class="linenos" data-linenos="32 "></span></a>                         <span class="n">v</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33"></a><a href="#__codelineno-16-33"><span class="linenos" data-linenos="33 "></span></a>            <span class="o">+---------------------------+</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34"></a><a href="#__codelineno-16-34"><span class="linenos" data-linenos="34 "></span></a>            <span class="o">|</span> <span class="n">Áõ∏Âä†Âπ∂Â∫îÁî®Dropout</span>         <span class="o">|</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35"></a><a href="#__codelineno-16-35"><span class="linenos" data-linenos="35 "></span></a>            <span class="o">|</span> <span class="n">value_emb</span> <span class="o">+</span> <span class="n">temporal_emb</span> <span class="o">|</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36"></a><a href="#__codelineno-16-36"><span class="linenos" data-linenos="36 "></span></a>            <span class="o">+---------------------------+</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37"></a><a href="#__codelineno-16-37"><span class="linenos" data-linenos="37 "></span></a>                         <span class="o">|</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38"></a><a href="#__codelineno-16-38"><span class="linenos" data-linenos="38 "></span></a>                         <span class="n">v</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39"></a><a href="#__codelineno-16-39"><span class="linenos" data-linenos="39 "></span></a>                  <span class="n">ËæìÂá∫</span><span class="p">:</span> <span class="n">enc_out</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40"></a><a href="#__codelineno-16-40"><span class="linenos" data-linenos="40 "></span></a>                 <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">d_model</span><span class="p">]</span>
</span></code></pre></div>
<ol>
<li><strong>ÂÄºÂµåÂÖ• (TokenEmbedding)</strong>:
   - ÈÄöËøáÂç∑ÁßØÊìç‰ΩúÂ∞ÜÂéüÂßãÁâπÂæÅ [B, L, D] Êò†Â∞ÑÂà∞Êõ¥È´òÁª¥Â∫¶Ë°®Á§∫ [B, L, d_model]
   - ‰ΩøÁî®Âæ™ÁéØÂ°´ÂÖÖÁöÑ1DÂç∑ÁßØÊçïËé∑Â±ÄÈÉ®ÁâπÂæÅÊ®°Âºè</li>
<li><strong>Êó∂Èó¥ÂµåÂÖ• (TemporalEmbedding)</strong>:
   - Â∞ÜÊó∂Èó¥Ê†áËÆ∞ [B, L, time_features] ËΩ¨Êç¢‰∏∫ [B, L, d_model] ÁöÑÂµåÂÖ•ÂêëÈáè
   - ÂàÜÂà´‰∏∫Êúà„ÄÅÊó•„ÄÅÊòüÊúü„ÄÅÂ∞èÊó∂Á≠âÊó∂Èó¥ÁâπÂæÅÊü•Ë°®Ëé∑ÂèñÂµåÂÖ•ÔºåÁÑ∂ÂêéÁõ∏Âä†
   - Êó∂Èó¥ÂµåÂÖ•Â∏ÆÂä©Ê®°ÂûãËØÜÂà´Êó∂Èó¥Ê®°Âºè(Â≠£ËäÇÊÄß„ÄÅÊØèÊó•/ÊØèÂë®Âë®ÊúüÁ≠â)</li>
<li><strong>ÁªÑÂêàÂµåÂÖ•</strong>:
   - Â∞ÜÂÄºÂµåÂÖ•ÂíåÊó∂Èó¥ÂµåÂÖ•Áõ∏Âä†ÔºåÂΩ¢ÊàêÊúÄÁªàÁºñÁ†ÅÂô®ËæìÂÖ• [B, L, d_model]
   - Ê≥®ÊÑèÊ≠§ÁâàÊú¨‰∏çÂåÖÂê´‰ΩçÁΩÆÂµåÂÖ•(DataEmbedding_wo_pos)</li>
</ol>
<p>ËøôÁßçÂ§öÈáçÂµåÂÖ•ÊñπÂºè‰ΩøÊ®°ÂûãËÉΩÂêåÊó∂Âà©Áî®Êó∂Èó¥Â∫èÂàóÁöÑÂÄº‰ø°ÊÅØÂíåÊó∂Èó¥ÁâπÂæÅ‰ø°ÊÅØÔºå‰∏∫ÂêéÁª≠ÁöÑÊ≥®ÊÑèÂäõÊú∫Âà∂ÂíåÊó∂Èó¥Â∫èÂàóÂª∫Ê®°Êèê‰æõ‰∏∞ÂØåÁöÑ‰∏ä‰∏ãÊñá„ÄÇ</p>
<h2 id="_4">Ê®°ÂûãÂÆö‰πâ<a class="headerlink" href="#_4" title="Permanent link">¬∂</a></h2>
<h3 id="_5">ÁºñÁ†ÅÂô® Ëß£Á†ÅÂô®ÈÉ®ÂàÜ<a class="headerlink" href="#_5" title="Permanent link">¬∂</a></h3>
<pre class="mermaid"><code>classDiagram
    class Model {
        +DataEmbedding_wo_pos enc_embedding
        +DataEmbedding_wo_pos dec_embedding
        +Encoder encoder
        +Decoder decoder
        +series_decomp decomp
        +forward(x_enc, x_mark_enc, x_dec, x_mark_dec, enc_self_mask, dec_self_mask, dec_enc_mask)
    }

    class Encoder {
        +List~EncoderLayer~ layers
        +my_Layernorm norm_layer
        +forward(x, attn_mask)
    }

    class EncoderLayer {
        +AutoCorrelationLayer attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +Dropout dropout
        +activation
        +forward(x, attn_mask)
    }

    class AutoCorrelationLayer {
        +AutoCorrelation attention
        +Linear query_projection
        +Linear key_projection
        +Linear value_projection
        +Linear out_projection
        +forward(queries, keys, values, attn_mask)
    }

    class AutoCorrelation {
        +bool mask_flag
        +int factor
        +float scale
        +Dropout dropout
        +bool output_attention
        +time_delay_agg_training(values, corr)
        +time_delay_agg_inference(values, corr)
        +forward(queries, keys, values, attn_mask)
    }

    class Decoder {
        +List~DecoderLayer~ layers
        +my_Layernorm norm_layer
        +Linear projection
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    class DecoderLayer {
        +AutoCorrelationLayer self_attention
        +AutoCorrelationLayer cross_attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +Dropout dropout
        +activation
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    Model --&gt; Encoder
    Model --&gt; Decoder
    Encoder --&gt; EncoderLayer
    EncoderLayer --&gt; AutoCorrelationLayer
    EncoderLayer --&gt; Conv1d
    EncoderLayer --&gt; series_decomp
    AutoCorrelationLayer --&gt; AutoCorrelation
    Decoder --&gt; DecoderLayer
    DecoderLayer --&gt; AutoCorrelationLayer
    DecoderLayer --&gt; Conv1d
    DecoderLayer --&gt; series_decomp
</code></pre>
<h2 id="_6">ËÆ≠ÁªÉËøáÁ®ãÔºåÂΩ¢Áä∂ÂèòÊç¢<a class="headerlink" href="#_6" title="Permanent link">¬∂</a></h2>
<p>Ôºà1Ôºâ</p>
<p>‰ª£Á†ÅÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319202142537.png"><img alt="image-20250319202142537" src="../images/image-20250319202142537.png"/></a> </p>
<p>ÈÄêÂ≠óËÆ≤Ëß£Ôºö</p>
<p>model ËÆ≠ÁªÉ‰ªé exp_main.pyÁöÑ train ÂáΩÊï∞ÂºÄÂßãÔºåepoch Ë°®Á§∫Êï¥‰∏™ËÆ≠ÁªÉÈõÜËø≠‰ª£Âá†Ê¨°Ôºåfor batchx„ÄÅbatchy„ÄÅbatch x mark„ÄÅbatch y mark ‰∏Ä‰∏™ÊâπÊ¨°‰∏Ä‰∏™ÊâπÊ¨°ÁöÑËÆ≠ÁªÉÔºåÁ¨¨‰∏Ä‰∏™ for ËÆ≠ÁªÉÁöÑ epoch ÊòØÊàë‰ª¨Ëá™Â∑±ÂèØ‰ª•ËÆæÁΩÆÁöÑÔºåÁ¨¨‰∫å‰∏™ for ËÆ≠ÁªÉÁöÑ iteration Ëø≠‰ª£Ê¨°Êï∞ÊòØ <code>Êï∞ÊçÆÈõÜÈïøÂ∫¶ ‚ûó batch size</code></p>
<p>Êé•‰∏ãÊù•ÔºåË∞ÉÁî® <code>self._predict</code> ÊñπÊ≥ïËøõË°åÈ¢ÑÊµãÔºåËøôÈáå predict ÂáΩÊï∞ÈúÄË¶ÅÁöÑÂèÇÊï∞ batchx„ÄÅbatchy„ÄÅbatch x mark„ÄÅbatch y mark ÂΩ¢Áä∂ÂàÜÂà´ÊòØ <code>batch_x = [32,36,7], batch_y = [32,42(18+24),7],batch_x_mark=[32,36,4],batch_y_mark = [32,42,4]</code></p>
<p>32 Ë°®Á§∫ ‰∏Ä‰∏™ batch Ê†∑Êú¨ÁöÑ‰∏™Êï∞Ôºõ</p>
<p>36 Ë°®Á§∫ÊØè‰∏™Ê†∑Êú¨ÁöÑÊó∂Èó¥Ê≠•Ôºå‰πüÂèØ‰ª•ËØ¥ÊòØÂõûÊ∫ØÁ™óÂè£ÁöÑÂ§ßÂ∞èÔºåÊàñËÄÖÂè´ËæìÂÖ•Â∫èÂàóÁöÑÈïøÂ∫¶</p>
<p>7 Ë°®Á§∫ illness Êï∞ÊçÆÈõÜÁöÑÁâπÂæÅÊï∞</p>
<p>batchy ÁöÑ 42 Ë°®Á§∫ 18 ÁöÑ label lengthÔºåÊòØÂèñÁöÑ ÂéüÂßãËæìÂÖ•Â∫èÂàóÁöÑ ‰∫åÂàÜ‰πã‰∏ÄÔºåËøô‰∏™Âú®ËÆ∫Êñá‰∏≠ÊúâËØ¥</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319202958076.png"><img alt="image-20250319202958076" src="../images/image-20250319202958076.png"/></a> </p>
<p>ÁºñÁ†ÅÂô®ÁöÑËæìÂÖ• ÊòØ <code>I times d</code> <span class="arithmatex">\(I\)</span> Ë°®Á§∫ ËæìÂÖ•Â∫èÂàóÈïøÂ∫¶ÔºåÂú®ËøôÈáå‰æãÂ≠êÂ∞±ÊòØ 36Ôºå<span class="arithmatex">\(d\)</span> ÊòØÁâπÂæÅÊï∞ÔºåËøôÈáåÁöÑÁâπÂæÅÊï∞ÔºåÈÉΩÂéªÊéâ‰∫ÜÊó∂Èó¥Êà≥Ôºå‰πüÂ∞±ÊòØ 7</p>
<p>Ëß£Á†ÅÂô®ÁöÑËæìÂÖ•ÊòØ <code>‰∫åÂàÜ‰πã I + O</code>Ôºå<code>‰∫åÂàÜ‰πã I</code>Ë°®Á§∫ ËæìÂÖ•Â∫èÂàóÈïøÂ∫¶ÁöÑ‰∏ÄÂçäÔºå<code>O</code> Ë°®Á§∫È¢ÑÊµãÊ≠•ÈïøÔºå‰πüÂ∞±ÊòØËæìÂá∫Â∫èÂàóÁöÑÈïøÂ∫¶</p>
<p>batch x markÔºåbatch y mark Â∞±ÊòØÂ§ÑÁêÜÁöÑÊó∂Èó¥Êà≥ÁâπÂæÅ‰∫ÜÔºåÂåÖÂê´‰∏ÄÂ§©ÁöÑÁ¨¨Âá†‰∏™Â∞èÊó∂Ôºå‰∏Ä‰∏™ÊúàÁöÑÁ¨¨Âá†Â§©Ôºå‰∏ÄÂë®ÁöÑÁ¨¨Âá†Â§©Ôºå‰∏Ä‰∏™ÊúàÁöÑÁ¨¨Âá†Â§©ÔºåÂ∞±ÊòØÊàë‰ª¨‰πãÂâçËÆ≤ËøáÁöÑ SegRNNÔºåËøôÈáåÂ§ÑÁêÜËøòÊ∂âÂèä‰∫Ü ÂΩí‰∏ÄÂåñ Âíå‰∏≠ÂøÉÂåñÔºå‰∏çÂÜçÈáçÂ§çÂï¶„ÄÇ</p>
<hr/>
<p><strong>Â•Ω‰∫ÜÔºåÊé•‰∏ãÊù•ËøõÂÖ• È¢ÑÊµãÈÉ®ÂàÜÔºå<mark>Ê≠•Ëøõ</mark>Ôºå‰πüÂ∞±ÊòØ predict ÂáΩÊï∞</strong> </p>
<p>È¶ñÂÖàÔºåÊûÑÈÄ†ÂÆåÊï¥ÁöÑËß£Á†ÅÂô®ËæìÂÖ•ÔºåÂÖ∑‰ΩìÁöÑÊìç‰ΩúÊòØÔºåÂàáÁâá batch y ‰∏≠ÁöÑÈ¢ÑÊµãÊ≠•ÈïøÔºåÂ°´ÂÖÖ 0ÔºåÂπ∂‰∏é ‰πãÂâçÁöÑ label length ËøõË°åÊãºÊé•„ÄÇ‰πüÂ∞±ÊòØËøô‰∏§Ë°å‰ª£Á†Å</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><a href="#__codelineno-17-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># decoder input </span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a><a href="#__codelineno-17-2"><span class="linenos" data-linenos="2 "></span></a><span class="c1"># ÂàõÂª∫Ëß£Á†ÅÂô®ËæìÂÖ•ÁöÑÈõ∂Âº†ÈáèÈÉ®ÂàÜÔºåÁî®‰∫éÈ¢ÑÊµãÊú™Êù•Êó∂Èó¥Ê≠•</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a><a href="#__codelineno-17-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># batch_y[B, label_len+pred_len, D] -&gt; ÂàáÁâá -&gt; [B, pred_len, D] -&gt; ÂàõÂª∫Áõ∏ÂêåÂΩ¢Áä∂ÂÖ®Èõ∂Âº†Èáè -&gt; dec_inp[B, pred_len, D]</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a><a href="#__codelineno-17-4"><span class="linenos" data-linenos="4 "></span></a><span class="n">dec_inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">batch_y</span><span class="p">[:,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">pred_len</span><span class="p">:,</span> <span class="p">:])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a><a href="#__codelineno-17-5"><span class="linenos" data-linenos="5 "></span></a>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a><a href="#__codelineno-17-6"><span class="linenos" data-linenos="6 "></span></a><span class="c1"># Â∞ÜÂéÜÂè≤Êï∞ÊçÆ(Ê†áÁ≠æÂ∫èÂàó)‰∏éÈõ∂Âº†ÈáèËøûÊé•ÔºåÂΩ¢ÊàêÂÆåÊï¥ÁöÑËß£Á†ÅÂô®ËæìÂÖ•ÔºåÂπ∂ÁßªÂä®Âà∞ÊåáÂÆöËÆæÂ§á</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7"></a><a href="#__codelineno-17-7"><span class="linenos" data-linenos="7 "></span></a><span class="c1"># [B, label_len, D] + [B, pred_len, D] -&gt; torch.catÊ≤øÁª¥Â∫¶1ÊãºÊé• -&gt; [B, label_len+pred_len, D] -&gt; to(device) -&gt; Âú®GPU‰∏äÁöÑdec_inp</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8"></a><a href="#__codelineno-17-8"><span class="linenos" data-linenos="8 "></span></a><span class="n">dec_inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">batch_y</span><span class="p">[:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">label_len</span><span class="p">,</span> <span class="p">:],</span> <span class="n">dec_inp</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span></code></pre></div>
<p>ÊûÑÈÄ†ÁöÑÂÆåÊï¥Ëß£Á†ÅÂô®ÁöÑËæìÂÖ•ÔºåÂΩ¢Áä∂ËøòÊòØ 32,42,7„ÄÇ</p>
<p>ÔºàËøôÈáåÁöÑ‰ª£Á†ÅÂπ∂‰∏çÊòØÈÇ£‰πàÈáçË¶ÅÔºåÊâÄ‰ª•Â∞±‰∏çÁ≤òË¥¥‰∫ÜÔºåÂç†Âú∞ÊñπÔºâÊé•‰∏ãÊù•ÊòØ‰∏Ä‰∏™ÂÜÖÈÉ®ÊñπÊ≥ï run modelÔºåÁ±ª‰ºº forwardÔºå‰ΩÜÂõ†‰∏∫‰∏çÊòØ‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÊ®°ÂûãÔºåÊâÄ‰ª•Â∞±Âè´ run model‰∫ÜÔºåÁ±ªÂÜÖË∞ÉÁî®‰∫ÜËøô‰∏™ÂáΩÊï∞ÔºåÊâç‰ºöÊâßË°åÔºåËøôÈáåÊ≤°ÊúâË∞ÉÁî®ÔºåËøõÂÖ•‰∏ã‰∏ÄÊ≠•ÔºåÂà§Êñ≠ÊòØÂê¶ÈááÁî®‰∫ÜËá™Âä®Á≤æÂ∫¶ËÆ≠ÁªÉÔºåÊàë‰πü‰∏çÊòéÁôΩÔºåÂ§ßÊ¶ÇÊòØÊ®°ÂûãÂä†ÈÄüÊääÔºåÊÄª‰πãÊòØ falseÔºåÊâßË°å else„ÄÇ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><a href="#__codelineno-18-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><a href="#__codelineno-18-2"><span class="linenos" data-linenos="2 "></span></a>    <span class="c1"># ‰ΩøÁî®ÊôÆÈÄöÁ≤æÂ∫¶ÊâßË°åÊ®°ÂûãËÆ°ÁÆó</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><a href="#__codelineno-18-3"><span class="linenos" data-linenos="3 "></span></a>    <span class="c1"># _run_model() -&gt; outputs[B, label_len+pred_len, D]</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a><a href="#__codelineno-18-4"><span class="linenos" data-linenos="4 "></span></a>    <span class="n">outputs</span> <span class="o">=</span> <span class="n">_run_model</span><span class="p">()</span>
</span></code></pre></div>
<p>Ë∞ÉÁî®ÁöÑÂÜÖÈÉ®ÊñπÊ≥ï <code>_run_model()</code>ÔºåÊ≠•ËøõÔºåËøõÂÖ•Âà∞ run model ÂÜÖÈÉ®„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319211512141.png"><img alt="image-20250319211512141" src="../images/image-20250319211512141.png"/></a></p>
<p>È¶ñÂÖàÔºåËøôÈáåÁöÑ self.model ÊòØ <code>Exp_Basic</code>‰∏≠ÁöÑ <code>build_model</code> ÂÆö‰πâÊù•ÁöÑÔºåËÄå‰∏î<code>exp_main</code> Ôºå <code>Basic</code> ÁöÑÂ≠êÁ±ª ÈáçÂÜô‰∫Ü Áà∂Á±ªÁöÑÊñπÊ≥ïÔºåÂπ∂ÈÄöËøáÂ≠óÂÖ∏ÔºåÈîÆÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂÄºÁöÑÁ±ªÔºåÁ¥¢ÂºïËøõË°åÁ±ªÁöÑÂàùÂßãÂåñÔºåËøô‰∏™‰πüÊòØ SegRNN ‰∏≠‰ªãÁªçËøáÁöÑ„ÄÇÊÄª‰πãÔºåËøôÈáåÁöÑ <code>self.model</code> ÊòØ <code>Autoformer</code> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319211736243.png"><img alt="image-20250319211736243" src="../images/image-20250319211736243.png"/></a></p>
<p><strong>ÁÇπÂáªÊ≠•ËøõÔºåËøõÂÖ• Autoformer ÁöÑ forward ‰∏≠„ÄÇ‰∏Ä‰∏™ batch ‰∏≠Ê†∑Êú¨ÁöÑÂ§ÑÁêÜ</strong> </p>
<hr/>
<h3 id="autoformer-forward">Autoformer  forward<a class="headerlink" href="#autoformer-forward" title="Permanent link">¬∂</a></h3>
<p>È¶ñÂÖàÔºåËøôÈáåAutoformer  forward Êé•Êî∂ÁöÑÂèÇÊï∞Ôºö</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_enc</span><span class="p">,</span> <span class="n">x_mark_enc</span><span class="p">,</span> <span class="n">x_dec</span><span class="p">,</span> <span class="n">x_mark_dec</span><span class="p">,</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a><a href="#__codelineno-19-2"><span class="linenos" data-linenos="2 "></span></a>            <span class="n">enc_self_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a><a href="#__codelineno-19-3"><span class="linenos" data-linenos="3 "></span></a>            <span class="n">dec_self_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a><a href="#__codelineno-19-4"><span class="linenos" data-linenos="4 "></span></a>            <span class="n">dec_enc_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></code></pre></div>
<p>ÂøÖÈ°ª‰º†ÂÖ•ÁöÑÂèÇÊï∞ ÊòØ  <code>x_enc, x_mark_enc, x_dec, x_mark_dec</code> Êàë‰ª¨ËøôÈáåÂ∞±ÊòØ <code>batch xÔºåbatch yÔºåbatch x markÔºåbatch y mark</code>Ôºå‰∏îÂΩ¢Áä∂ÂàÜÂà´ÊòØ <code>[32,36,7]„ÄÅ[32,42,7]„ÄÅ[32,36,4]„ÄÅ[32,42,4]</code></p>
<p>ÂèØÈÄâÂèÇÊï∞ÊòØ Transformer ‰∏≠ÁöÑ 3 ‰∏™ maskÔºåÈªòËÆ§ÊòØ None„ÄÇËß£Èáä‰∏Ä‰∏ã Transformer ‰∏≠ÁöÑ‰∏â‰∏™ mask ÂàÜÂà´ÊòØ‰ªÄ‰πàÔºö</p>
<blockquote>
<p>‰∏â‰∏™maskÊú∫Âà∂ÔºåÂàÜÂà´ÊåáÁöÑÊòØ</p>
<ul>
<li>Á¨¨‰∏Ä‰∏™ ÁºñÁ†ÅÁ´ØËæì‚ºä Áî±‰∫épaddingÂ≠óÁ¨¶ÁöÑmaskÔºå‰∏∫‰∫Ü‚ºÄ‰∏™batchsize‰∏≠ÔºåÊâÄÊúâÈïøÂ∫¶‰∏çÁõ∏ÂêåÁöÑÊ†∑Êú¨ÔºåËÉΩÊûÑÊàê‚ºÄ‰∏™Áü©ÈòµÔºåÊâÄ‰ª•ÊúâpadÂ≠óÁ¨¶Ôºå‰ΩÜÊòØÂú®Âêé‚æØËøõ‚æèinputencoderÁöÑ‚æÉÊ≥®ÊÑè‚ºíËÆ°ÁÆóÊó∂ÔºåpadÂ≠óÁ¨¶‰∏çËÉΩÂΩ±ÂìçËÆ°ÁÆóÁªìÊûúÔºåÊâÄ‰ª•ÈúÄË¶ÅmaskÔºõ</li>
<li>Á¨¨‚ºÜ‰∏™maskÊòØËß£Á†ÅÁ´ØÁöÑmaskÔºåËøô‰∏™maskÊòØÊ∂âÂèäÂà∞Âõ†ÊûúÁöÑmaskÔºåÂõ†‰∏∫TransformerÊòØ‚ºÄ‰∏™‚æÉÂõûÂΩíÊ®°ÂûãÔºåÂú®Ëøõ‚æèËøêÁÆóÊó∂Ôºå‰∏∫‰∫ÜÂπ∂‚æèËÆ°ÁÆóÔºåÊàë‰ª¨ÊòØÊääinputsÂíåoutputs‚ºÄËµ∑ÂñÇÁªôÊ®°ÂûãÁöÑÔºåinputsÁõ¥Êé•ÁªôÊ®°ÂûãÊ≤°‰∫ãÔºå‰ΩÜÊòØoutputsÂú®ÂæóÂà∞ÊúÄÂêéÁöÑËæìÂá∫Êó∂Ôºå‰∏çËÉΩÂÄüÂä©Êú™Êù•‰ø°ÊÅØÔºåÂè™ËÉΩÊòØÂΩìÂâçÊó∂ÂàªÂèäÂÖ∂‰πãÂâçÊó∂ÂàªÁöÑËæìÂá∫ÔºåÊâÄ‰ª•ÈúÄË¶Å‚ºÄ‰∏™maskÊú∫Âà∂ÔºåËøô‰∏™maskÊòØ‚ºÄ‰∏™‰∏ä‰∏âËßíÁü©ÈòµÔºå‰øùËØÅÂú®È¢ÑÊµãÂΩìÂâçËæìÂá∫Êó∂Ôºå‰∏ç‰ºöÂÄüÂä©Êú™Êù•‰ø°ÊÅØ„ÄÇ</li>
<li>Á¨¨‰∏â‰∏™maskÔºåÊòØÁºñÁ†ÅÂô®ÂíåËß£Á†ÅÂô®ÁöÑ‰∫§‰∫íÊ≥®ÊÑè‚ºíÔºåÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫keyÂíåvalueÔºåËß£Á†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫queryÔºåÂõ†‰∏∫‚Ω¨Ê†áÂ∫èÂàó ÊØè‰∏™Ê†∑Êú¨ÁöÑÈïøÂ∫¶ÊòØ‰∏ç‚ºÄÊ†∑ÁöÑÔºåÂêåÊó∂ÂéüÂ∫èÂàóÁöÑÊ†∑Êú¨ÈïøÂ∫¶‰πüÊòØ‰∏ç‚ºÄÊ†∑ÁöÑÔºå‚ΩΩ‰∏î‚ºÄÂØπ‰πãÈó¥ ÈïøÂ∫¶‰πüÊòØ‰∏ç‚ºÄÊ†∑ÁöÑÔºåÊâÄ‰ª•ÈúÄË¶Å‚ºÄ‰∏™mask Â∞ÜÂéüÂ∫èÂàó‰∏≠Êüê‰∏™ÂçïËØçÊüê‰∏™‰ΩçÁΩÆ Ë∑ü ‚Ω¨Ê†áÂ∫èÂàó‰∏≠ Êüê‰∏™‰ΩçÁΩÆ Â¶ÇÊûúÂÆÉ‰ª¨‰πãÈó¥ Êúâ‚ºÄ‰∏™padÁöÑËØù ËØ¥ÊòéÊòØ‚ΩÜÊïàÂ≠óÁ¨¶ÔºåÂæóÂà∞ËøôÊ†∑ÁöÑÊé©Á†ÅÁü©Èòµ„ÄÇ</li>
</ul>
<p>ÁºñÁ†ÅÂô®‰ª•Âèä ÁºñÁ†ÅÂô®ÂíåËß£Á†ÅÂô®ÁöÑ mask ÊòØ‰∏∫‰∫Ü‰øùËØÅÈïøÂ∫¶ÁöÑÂØπÈΩêÔºåËß£Á†ÅÂô®ÁöÑ mask ÊòØ‰∏∫‰∫ÜÂú®È¢ÑÊµãÊó∂ ÈÅøÂÖçÁúãÂà∞Êú™Êù•ÁöÑ‰ø°ÊÅØ</p>
</blockquote>
<p>ÂõûÂà∞ Autoformer ËøôÈáåÔºåÁúãËøô‰∏™Ê®°ÂûãÊòØÊÄé‰πàÂ§ÑÁêÜÔºåËæìÂÖ•Êï∞ÊçÆÂíåËæìÂá∫Êï∞ÊçÆÔºå‰ª•ÂèäÊ®°ÂûãÁöÑÂàõÊñ∞ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ„ÄÇ</p>
<p>È¶ñÂÖàÔºåÁúãÂà∞‰∏ãÈù¢ËøôÂá†Ë°å‰ª£Á†Å„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319214129515.png"><img alt="image-20250319214129515" src="../images/image-20250319214129515.png"/></a></p>
<p>ËøôÂá†Ë°å‰ª£Á†ÅÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜËß£Á†ÅÂô®ÁöÑËæìÂÖ•ÁöÑÂàùÂßãÂåñÔºåÁºñÁ†ÅÂô®Èò∂ÊÆµÊòØÁî®‰∏çÂà∞„ÄÇ</p>
<hr/>
<h3 id="_7">Â∫èÂàóÂàÜËß£<a class="headerlink" href="#_7" title="Permanent link">¬∂</a></h3>
<p><strong>ÁúãËÆ∫Êñá ËæìÂÖ•Â∫èÂàóÁöÑË∂ãÂäøÂ∫èÂàóÂíåÂ≠£ËäÇË∂ãÂäøÊòØÊÄé‰πàÊèêÂèñÁöÑ„ÄÇ</strong> </p>
<p>Êú¨ÊñáÂ∞ÜÊó∂Èó¥Â∫èÂàóÂàÜËß£‰∏∫ Ë∂ãÂäøÂ∫èÂàóÂíåÂ≠£ËäÇÂêëÈáè</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319214344038.png"><img alt="image-20250319214344038" src="../images/image-20250319214344038.png"/></a></p>
<p>Ë∂ãÂäøÂêëÈáèÂèçÊò†‰∫ÜÊï∞ÊçÆÁöÑÈïøÊúüÂèòÂåñË∂ãÂäøÂíåÂ≠£ËäÇË∂ãÂäø„ÄÇÂπ∂‰∏îËÆ∫Êñá‰∏≠ÊèêÂà∞ ÂØπ‰∫éÊú™Êù•Â∫èÂàóËøõË°åÂàÜËß£ÊòØ‰∏çÁé∞ÂÆûÁöÑÔºåÂõ†‰∏∫Êú™Êù•ÁöÑÊâÄÊúâÂ∫èÂàóÈÉΩÊòØ‰∏çÁü•ÈÅìÁöÑ„ÄÇÂõ†Ê≠§Ôºå‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÂéüÊñáÊèêÂá∫‰∫Ü Â∫èÂàóÂàÜËß£Ê®°ÂùóÔºåÊÄùÊÉ≥ÊòØ ‰ªéÈ¢ÑÊµãÁöÑ‰∏≠Èó¥ÈöêËóèÂèòÈáè‰∏≠ ÈÄêÊ≠•ÊèêÂèñ ÈïøÊúüÁ®≥ÂÆöÁöÑË∂ãÂäø „ÄÇ</p>
<p>ÂÖ∑‰ΩìÁöÑÂÅöÊ≥ïÔºå‰ΩøÁî®ÁßªÂä®Âπ≥ÂùáÊù•Âπ≥ÊªëÂë®ÊúüÊÄßÊ≥¢Âä®Êù•Á™ÅÂá∫ÈïøÊúüË∂ãÂäø„ÄÇ</p>
<p>Êñá‰∏≠‰πüÁªôÂá∫‰∫ÜÂÖ¨ÂºèÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319220946468.png"><img alt="image-20250319220946468" src="../images/image-20250319220946468.png"/></a></p>
<p>ÂÖ¨ÂºèÁöÑËß£ÈáäÔºöÂØπ‰∫éÈïøÂ∫¶ ‰∏∫ L ÁöÑËæìÂÖ•Â∫èÂàó X ÔºåÂΩ¢Áä∂ÊòØ L√ódÔºå‰ΩøÁî®Âπ≥ÂùáÊ±†ÂåñËøõË°åÁßªÂä®Âπ≥ÂùáÔºåÂπ∂‰∏î‰ΩøÁî®Â°´ÂÖÖÊìç‰Ωú‰øùÊåÅÂ∫èÂàóÈïøÂ∫¶‰∏çÂèò„ÄÇÂêéÈù¢Áî®‰∏Ä‰∏™ SeriesDecomp(X)Êù•Ë°®Á§∫ ‰∏äÈù¢ÁöÑËøáÁ®ãÔºåÁÆÄÂåñ‰∏Ä‰∏ãËÆ∞Âè∑„ÄÇ</p>
<p><strong>ËÆ∫Êñá‰∏≠ÁöÑÊ®°ÂûãÁªìÊûÑÂõæ‰πüÊúâÁîªÂá∫ËøôÈÉ®ÂàÜ</strong></p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319221443646.png"><img alt="image-20250319221443646" src="../images/image-20250319221443646.png"/></a></p>
<p>È¶ñÂÖà ÁÆ≠Â§¥ÊåáÁöÑÂú∞ÊñπÊó∂ Áõ¥ËßÇÂú∞ÊòæÁ§∫‰∫Ü ËæìÂÖ•Â∫èÂàó Ë∂ãÂäøÂ∫èÂàó Âíå Â≠£ËäÇÂ∫èÂàóÊòØÊÄé‰πàÊù•ÁöÑ„ÄÇËæìÂÖ•Â∫èÂàó ÁöÑ Ë∂ãÂäøÂ∫èÂàó ÊòØÂØπ ËæìÂÖ•Â∫èÂàó ÂéªÂùáÂÄºÔºõÂ≠£ËäÇ‰ø°ÊÅØÔºå‰πüÂ∞±ÊòØÂë®ÊúüÊ≥¢Âä®‰ø°ÊÅØÊòØ ËæìÂÖ•Â∫èÂàó - ÂùáÂÄº ÔºåËøô‰∏™Âë®ÊúüÊ≥¢Âä®‰ø°ÊÅØ ÊòØÂõ¥Áªï 0 ËøõË°åÊ≥¢Âä®ÁöÑ„ÄÇÂü∫‰∫éÂØπËæìÂÖ•Â∫èÂàóÁöÑÂàÜËß£ÁöÑËÆ§ËØÜÔºåÂØπ‰∫éËß£Á†ÅÂô® Ë∂ãÂäøÂ∫èÂàó Âíå Â≠£ËäÇÂ∫èÂàóÁöÑ ÂàùÂßãÂåñ‰πüÊòØÂæàÊúâÈÅìÁêÜÁöÑ„ÄÇ</p>
<p>ÂõæÁâáÁöÑ‰∏ãÂçäÈÉ®ÂàÜÔºåÊòØËß£Á†ÅÂô®ÁöÑËæìÂÖ•ÔºåÊòæÁ§∫‰∫Ü È¢ÑÊµãÂ∫èÂàó Ë∂ãÂäøÂ∫èÂàóÂíåÂ≠£ËäÇÂ∫èÂàóÁöÑÂàùÂßãÂåñÔºåÂÖ∂‰∏≠Ë∂ãÂäøÂ∫èÂàó‰ΩøÁî®ËæìÂÖ•Â∫èÂàóÁöÑÂùáÂÄºËøõË°åÂàùÂßãÂåñÔºåÂ≠£ËäÇÊ≥¢Âä®‰ø°ÊÅØÁî® 0 Êù•ÂàùÂßãÂåñ</p>
<hr/>
<p><strong>Êé•‰∏ãÊù•ÔºåÁúã‰ª£Á†Å‰∏≠ÔºåÂØπÈ¢ÑÊµãÂ∫èÂàó ÁöÑ Ë∂ãÂäøÂ∫èÂàó Âíå Â≠£ËäÇÂ∫èÂàóÁöÑÊèêÂèñ„ÄÇ</strong></p>
<p>È¶ñÂÖà Êúâ ÂéÜÂè≤Êï∞ÊçÆ x_enc [B, L, D]ÁöÑÔºåÈ¢ÑÊµãÂíåÊ†áÁ≠æÊï∞ÊçÆ x_dec [B, L+P, D]ÔºåÊé•ÁùÄËøõË°åÊó∂Èó¥Â∫èÂàóÂàÜËß£ Â∞ÜÂéÜÂè≤Â∫èÂàóÂàÜËß£‰∏∫Â≠£ËäÇÊÄßÂíåË∂ãÂäø‰∏§‰∏™ÊàêÂàÜ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">seasonal_init</span><span class="p">,</span> <span class="n">trend_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp</span><span class="p">(</span><span class="n">x_enc</span><span class="p">)</span>
</span></code></pre></div>
<p>ÂæóÂà∞ Ë∂ãÂäøÂàùÂßãÂÄºÔºöÂéÜÂè≤Â∫èÂàóÂùáÂÄºÔºåÂ≠£ËäÇÊÄßÂàùÂßãÂÄºÔºöÂÖ®Èõ∂Âº†Èáè</p>
<p>Âü∫‰∫é ËæìÂÖ•Â∫èÂàóÁöÑ Â∫èÂàóÂàÜËß£ÁªìÊûúÔºåÊûÑÈÄ† Ëß£Á†ÅÂô®ÁöÑËæìÂÖ•ÔºåÂÖ∑‰ΩìÊù•ËØ¥Ôºö</p>
<ul>
<li>
<p>ËæìÂá∫Â∫èÂàó Ë∂ãÂäøËæìÂÖ•= ÂéÜÂè≤Ë∂ãÂäøÊú´Â∞æ + Ë∂ãÂäøÂàùÂßãÂÄº</p>
</li>
<li>
<p>ËæìÂá∫Â∫èÂàó Â≠£ËäÇÊÄßËæìÂÖ• = ÂéÜÂè≤Â≠£ËäÇÊÄßÊú´Â∞æ + Â≠£ËäÇÊÄßÂàùÂßãÂÄº(Èõ∂)</p>
</li>
</ul>
<p>‰πüÂ∞±ÊòØÊ∫êÁ†Å‰∏≠ÁöÑËøôÂá†Ë°åÔºö</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">mean</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_enc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a><a href="#__codelineno-21-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">zeros</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">x_dec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span><span class="p">,</span> <span class="n">x_dec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">device</span><span class="o">=</span><span class="n">x_enc</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> 
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3"></a><a href="#__codelineno-21-3"><span class="linenos" data-linenos="3 "></span></a><span class="n">trend_init</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">trend_init</span><span class="p">[:,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">label_len</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">mean</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4"></a><a href="#__codelineno-21-4"><span class="linenos" data-linenos="4 "></span></a><span class="n">seasonal_init</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">seasonal_init</span><span class="p">[:,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">label_len</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">zeros</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<p>Ëøô‰∏™Ê®°ÂûãÁöÑÁªìÊûÑÁÆÄÂçïÊù•ËØ¥ÊòØ Âà©Áî® **ÁºñÁ†ÅÂô®**Â§ÑÁêÜÂéÜÂè≤Êï∞ÊçÆÔºå**Ëß£Á†ÅÂô®**Âà©Áî®ÁºñÁ†ÅÂô®ËæìÂá∫ÂíåÁªÑË£ÖÁöÑÂàùÂßãËæìÂÖ•ÁîüÊàêÈ¢ÑÊµãÔºåÂ∞±ÊòØ‰∏Ä‰∏™ÂæàÊ†áÂáÜÁöÑ Transformer Â§ÑÁêÜÊï∞ÊçÆÁöÑÊû∂ÊûÑ„ÄÇÊàë‰ª¨ÂæóÂà∞ÁöÑÊúÄÁªàËæìÂá∫ÊòØ Ë∂ãÂäøÂíåÂ≠£ËäÇÊÄßÈ¢ÑÊµãÁõ∏Âä†ÔºåÂõ†‰∏∫Êúâ label lengthÔºåÊâÄ‰ª•ÂØπ‰∫éËæìÂá∫ ÊòØ ÊèêÂèñÊú´Â∞æ pred_len ÈïøÂ∫¶‰Ωú‰∏∫ÊúÄÁªàÈ¢ÑÊµãÁªìÊûú</p>
<p>Autoformer ÁöÑÊ†∏ÂøÉÊÄùÊÉ≥Â∞±ÊòØ Â∞ÜÊó∂Èó¥Â∫èÂàóÂàÜËß£‰∏∫‰∏çÂêåÈ¢ëÁéáÊàêÂàÜÂπ∂ÂàÜÂà´Âª∫Ê®°ÔºåÂÜçÁªÑÂêàÁîüÊàêÊúÄÁªàÈ¢ÑÊµã„ÄÇ</p>
<p><strong>ÂÖàÊúâ‰∏™Â§ß‰ΩìÁöÑÂç∞Ë±°ÔºåÂêéÈù¢ÁúãÂà∞‰ª£Á†Å ËØ¶ÁªÜÁöÑËÆ≤Ëß£„ÄÇ</strong></p>
<hr/>
<p>Âú®ËøõË°åÂêéÈù¢ÁöÑEncoder Âíå Decoder‰πãÂâçÔºå<strong>ÂÖàÁúã Ë∂ãÂäøÈ°π Âíå Â≠£ËäÇÈ°π ÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÊñπÊ≥ï„ÄÇ</strong> ÊúâÁÇπÂ§çÊùÇÔºå‰ΩÜÊòØ‰∏ÄÊ≠•Ê≠•Êù•„ÄÇ</p>
<p>‚ñ∂Ô∏è È¶ñÂÖàÊòØË∞ÉÁî® ÁöÑ   self.decomp</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><a href="#__codelineno-22-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">seasonal_init</span><span class="p">,</span> <span class="n">trend_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp</span><span class="p">(</span><span class="n">x_enc</span><span class="p">)</span>
</span></code></pre></div>
<p>‚ñ∂Ô∏è ËÄå self.decomp ÂèàÊòØ ÂàùÂßãÂåñ series_decomp Á±ª</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos="1 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">decomp</span> <span class="o">=</span> <span class="n">series_decomp</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
</span></code></pre></div>
<p>‚ñ∂Ô∏è ÁúãÂà∞ series_decomp Á±ªÁöÑÂÆö‰πâ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">series_decomp</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></code></pre></div>
<p>üü¢ Á±ªÁöÑÂÆö‰πâ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">series_decomp</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a><a href="#__codelineno-25-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">    </span><span class="sd">"""</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a><a href="#__codelineno-25-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="sd">    Series decomposition block</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a><a href="#__codelineno-25-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="sd">    """</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5"></a><a href="#__codelineno-25-5"><span class="linenos" data-linenos=" 5 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">):</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6"></a><a href="#__codelineno-25-6"><span class="linenos" data-linenos=" 6 "></span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">series_decomp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7"></a><a href="#__codelineno-25-7"><span class="linenos" data-linenos=" 7 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">moving_avg</span> <span class="o">=</span> <span class="n">moving_avg</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8"></a><a href="#__codelineno-25-8"><span class="linenos" data-linenos=" 8 "></span></a>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9"></a><a href="#__codelineno-25-9"><span class="linenos" data-linenos=" 9 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10"></a><a href="#__codelineno-25-10"><span class="linenos" data-linenos="10 "></span></a>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11"></a><a href="#__codelineno-25-11"><span class="linenos" data-linenos="11 "></span></a>        <span class="c1"># ËÆ°ÁÆóÁßªÂä®Âπ≥ÂùáÔºåÊèêÂèñÂ∫èÂàóË∂ãÂäøÂàÜÈáè</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12"></a><a href="#__codelineno-25-12"><span class="linenos" data-linenos="12 "></span></a>        <span class="c1"># x ÂΩ¢Áä∂[B, L, D] -&gt; moving_meanÂΩ¢Áä∂[B, L, D]</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13"></a><a href="#__codelineno-25-13"><span class="linenos" data-linenos="13 "></span></a>        <span class="c1">#  moving_avgÂÜÖÈÉ®‰ºöËøõË°åÂ°´ÂÖÖÔºå‰øùËØÅËæìÂá∫ÂΩ¢Áä∂‰∏éËæìÂÖ•Áõ∏Âêå</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14"></a><a href="#__codelineno-25-14"><span class="linenos" data-linenos="14 "></span></a>        <span class="n">moving_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_avg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15"></a><a href="#__codelineno-25-15"><span class="linenos" data-linenos="15 "></span></a>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16"></a><a href="#__codelineno-25-16"><span class="linenos" data-linenos="16 "></span></a>        <span class="c1"># ÈÄöËøáÂéüÂßãÂ∫èÂàóÂáèÂéªË∂ãÂäøÂàÜÈáèÔºåÂæóÂà∞ÊÆãÂ∑Æ(Â≠£ËäÇÊÄßÂàÜÈáè)ÔºåÈÄêÂÖÉÁ¥†ÂáèÊ≥ïÊìç‰Ωú</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17"></a><a href="#__codelineno-25-17"><span class="linenos" data-linenos="17 "></span></a>        <span class="c1"># xÂΩ¢Áä∂[B, L, D] - moving_meanÂΩ¢Áä∂[B, L, D] -&gt; resÂΩ¢Áä∂[B, L, D]</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18"></a><a href="#__codelineno-25-18"><span class="linenos" data-linenos="18 "></span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">moving_mean</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19"></a><a href="#__codelineno-25-19"><span class="linenos" data-linenos="19 "></span></a>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20"></a><a href="#__codelineno-25-20"><span class="linenos" data-linenos="20 "></span></a>        <span class="c1"># ËøîÂõûÂ≠£ËäÇÊÄßÂàÜÈáèÂíåË∂ãÂäøÂàÜÈáèÔºåÂùá‰øùÊåÅÂéüÂßãÂΩ¢Áä∂[B, L, D]</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21"></a><a href="#__codelineno-25-21"><span class="linenos" data-linenos="21 "></span></a>        <span class="c1"># Á¨¨‰∏Ä‰∏™ËøîÂõûÂÄºresÊòØÂ≠£ËäÇÊÄßÂàÜÈáèÔºåÁ¨¨‰∫å‰∏™ËøîÂõûÂÄºmoving_meanÊòØË∂ãÂäøÂàÜÈáè</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22"></a><a href="#__codelineno-25-22"><span class="linenos" data-linenos="22 "></span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">moving_mean</span>
</span></code></pre></div>
<p>‚ñ∂Ô∏è Á±ªÂÜÖ Ë∞ÉÁî® <code>moving_avg</code> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250317202431440.png"><img alt="image-20250317202431440" src="../images/image-20250317202431440.png"/></a></p>
<p>‚ñ∂Ô∏è ÁúãÂà∞ <code>moving_avg</code> Á±ªÁöÑÂÆö‰πâ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><a href="#__codelineno-26-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">moving_avg</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></code></pre></div>
<p>üü¢ <code>moving_avg</code> ÂÆö‰πâ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><a href="#__codelineno-27-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">moving_avg</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a><a href="#__codelineno-27-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">    </span><span class="sd">"""</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a><a href="#__codelineno-27-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="sd">    Moving average block to highlight the trend of time series</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4"></a><a href="#__codelineno-27-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="sd">    """</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5"></a><a href="#__codelineno-27-5"><span class="linenos" data-linenos=" 5 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">):</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6"></a><a href="#__codelineno-27-6"><span class="linenos" data-linenos=" 6 "></span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">moving_avg</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7"></a><a href="#__codelineno-27-7"><span class="linenos" data-linenos=" 7 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="n">kernel_size</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8"></a><a href="#__codelineno-27-8"><span class="linenos" data-linenos=" 8 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9"></a><a href="#__codelineno-27-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10"></a><a href="#__codelineno-27-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11"></a><a href="#__codelineno-27-11"><span class="linenos" data-linenos="11 "></span></a>        <span class="c1"># padding on the both ends of time series</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12"></a><a href="#__codelineno-27-12"><span class="linenos" data-linenos="12 "></span></a>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13"></a><a href="#__codelineno-27-13"><span class="linenos" data-linenos="13 "></span></a>        <span class="c1"># ÊèêÂèñÁ¨¨‰∏Ä‰∏™Êó∂Èó¥Ê≠•Âπ∂ÈáçÂ§çÔºåÁî®‰∫éÂâçÁ´ØÂ°´ÂÖÖ</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14"></a><a href="#__codelineno-27-14"><span class="linenos" data-linenos="14 "></span></a>        <span class="c1">#  [B, L, D] -&gt; [B, 1, D] -&gt; [B, (kernel_size-1)//2, D]</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15"></a><a href="#__codelineno-27-15"><span class="linenos" data-linenos="15 "></span></a>        <span class="n">front</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16"></a><a href="#__codelineno-27-16"><span class="linenos" data-linenos="16 "></span></a>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17"></a><a href="#__codelineno-27-17"><span class="linenos" data-linenos="17 "></span></a>        <span class="c1"># ÊèêÂèñÊúÄÂêé‰∏Ä‰∏™Êó∂Èó¥Ê≠•Âπ∂ÈáçÂ§çÔºåÁî®‰∫éÂêéÁ´ØÂ°´ÂÖÖ</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18"></a><a href="#__codelineno-27-18"><span class="linenos" data-linenos="18 "></span></a>        <span class="c1"># [B, L, D] -&gt; [B, 1, D] -&gt; [B, (kernel_size-1)//2, D]</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19"></a><a href="#__codelineno-27-19"><span class="linenos" data-linenos="19 "></span></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20"></a><a href="#__codelineno-27-20"><span class="linenos" data-linenos="20 "></span></a>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21"></a><a href="#__codelineno-27-21"><span class="linenos" data-linenos="21 "></span></a>        <span class="c1"># ËøûÊé•Â°´ÂÖÖÈÉ®ÂàÜ‰∏éÂéüÂ∫èÂàó</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22"></a><a href="#__codelineno-27-22"><span class="linenos" data-linenos="22 "></span></a>        <span class="c1"># [B, (k-1)//2, D] + [B, L, D] + [B, (k-1)//2, D] -&gt; [B, L+(k-1), D]</span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23"></a><a href="#__codelineno-27-23"><span class="linenos" data-linenos="23 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">front</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">end</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24"></a><a href="#__codelineno-27-24"><span class="linenos" data-linenos="24 "></span></a>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25"></a><a href="#__codelineno-27-25"><span class="linenos" data-linenos="25 "></span></a>        <span class="c1"># ËΩ¨ÁΩÆÂπ∂Â∫îÁî®‰∏ÄÁª¥Âπ≥ÂùáÊ±†Âåñ</span>
</span><span id="__span-27-26"><a id="__codelineno-27-26" name="__codelineno-27-26"></a><a href="#__codelineno-27-26"><span class="linenos" data-linenos="26 "></span></a>        <span class="c1"># [B, L+(k-1), D] -&gt; [B, D, L+(k-1)] -&gt; [B, D, L]</span>
</span><span id="__span-27-27"><a id="__codelineno-27-27" name="__codelineno-27-27"></a><a href="#__codelineno-27-27"><span class="linenos" data-linenos="27 "></span></a>        <span class="c1"># Ê±†ÂåñÁ™óÂè£Â§ßÂ∞è‰∏∫kernel_sizeÔºåÊ≠•Èïø‰∏∫1ÔºåËæìÂá∫ÈïøÂ∫¶‰∏∫(L+(k-1)-k+1)=L Ôºàlength + 2P - K + 1Ôºâ</span>
</span><span id="__span-27-28"><a id="__codelineno-27-28" name="__codelineno-27-28"></a><a href="#__codelineno-27-28"><span class="linenos" data-linenos="28 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-27-29"><a id="__codelineno-27-29" name="__codelineno-27-29"></a><a href="#__codelineno-27-29"><span class="linenos" data-linenos="29 "></span></a>
</span><span id="__span-27-30"><a id="__codelineno-27-30" name="__codelineno-27-30"></a><a href="#__codelineno-27-30"><span class="linenos" data-linenos="30 "></span></a>        <span class="c1"># ËΩ¨ÁΩÆÂõûÂéüÂßãÁª¥Â∫¶È°∫Â∫è [B, D, L] -&gt; [B, L, D]</span>
</span><span id="__span-27-31"><a id="__codelineno-27-31" name="__codelineno-27-31"></a><a href="#__codelineno-27-31"><span class="linenos" data-linenos="31 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-27-32"><a id="__codelineno-27-32" name="__codelineno-27-32"></a><a href="#__codelineno-27-32"><span class="linenos" data-linenos="32 "></span></a>        <span class="k">return</span> <span class="n">x</span>
</span></code></pre></div>
<p>ÊÄªÁªìÔºöÂ∞±ÊòØ 3 Ê¨°Ë∞ÉÁî®Ôºö</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><a href="#__codelineno-28-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="n">seasonal_init</span><span class="p">,</span> <span class="n">trend_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp</span><span class="p">(</span><span class="n">x_enc</span><span class="p">)</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a><a href="#__codelineno-28-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a><a href="#__codelineno-28-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">decomp</span> <span class="o">=</span> <span class="n">series_decomp</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4"></a><a href="#__codelineno-28-4"><span class="linenos" data-linenos=" 4 "></span></a>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5"></a><a href="#__codelineno-28-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">series_decomp</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6"></a><a href="#__codelineno-28-6"><span class="linenos" data-linenos=" 6 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">):</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7"></a><a href="#__codelineno-28-7"><span class="linenos" data-linenos=" 7 "></span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">series_decomp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8"></a><a href="#__codelineno-28-8"><span class="linenos" data-linenos=" 8 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">moving_avg</span> <span class="o">=</span> <span class="n">moving_avg</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9"></a><a href="#__codelineno-28-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10"></a><a href="#__codelineno-28-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11"></a><a href="#__codelineno-28-11"><span class="linenos" data-linenos="11 "></span></a>        <span class="n">moving_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_avg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12"></a><a href="#__codelineno-28-12"><span class="linenos" data-linenos="12 "></span></a>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13"></a><a href="#__codelineno-28-13"><span class="linenos" data-linenos="13 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">moving_avg</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14"></a><a href="#__codelineno-28-14"><span class="linenos" data-linenos="14 "></span></a>     <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15"></a><a href="#__codelineno-28-15"><span class="linenos" data-linenos="15 "></span></a>        <span class="n">front</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16"></a><a href="#__codelineno-28-16"><span class="linenos" data-linenos="16 "></span></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17"></a><a href="#__codelineno-28-17"><span class="linenos" data-linenos="17 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">front</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">end</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18"></a><a href="#__codelineno-28-18"><span class="linenos" data-linenos="18 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19"></a><a href="#__codelineno-28-19"><span class="linenos" data-linenos="19 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20"></a><a href="#__codelineno-28-20"><span class="linenos" data-linenos="20 "></span></a>        <span class="k">return</span> <span class="n">x</span>    
</span></code></pre></div>
<p>Áî®‰∏ÄÂº†ÂõæË°®Á§∫ Autoformer Â∫èÂàóÂàÜËß£ÁöÑÁöÑËøáÁ®ãÔºåËøô‰∏™ÂàÜËß£ËøáÁ®ãÂ∞ÜÂéüÂßãÂ∫èÂàó x_enc ÂàÜËß£‰∏∫‰∏§‰∏™Áõ∏ÂêåÂΩ¢Áä∂ [B,L,D] ÁöÑÂº†ÈáèÔºöË∂ãÂäøÊàêÂàÜÂíåÂ≠£ËäÇÊÄßÊàêÂàÜÔºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><a href="#__codelineno-29-1"><span class="linenos" data-linenos=" 1 "></span></a>                    ËæìÂÖ•: x_enc [B, L, D]
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a><a href="#__codelineno-29-2"><span class="linenos" data-linenos=" 2 "></span></a>                          |
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a><a href="#__codelineno-29-3"><span class="linenos" data-linenos=" 3 "></span></a>                          v
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a><a href="#__codelineno-29-4"><span class="linenos" data-linenos=" 4 "></span></a>            +---------------------------+
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a><a href="#__codelineno-29-5"><span class="linenos" data-linenos=" 5 "></span></a>            | Model.forward()           |
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6"></a><a href="#__codelineno-29-6"><span class="linenos" data-linenos=" 6 "></span></a>            | Ë∞ÉÁî®: self.decomp(x_enc)  |
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7"></a><a href="#__codelineno-29-7"><span class="linenos" data-linenos=" 7 "></span></a>            +---------------------------+
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8"></a><a href="#__codelineno-29-8"><span class="linenos" data-linenos=" 8 "></span></a>                          |
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9"></a><a href="#__codelineno-29-9"><span class="linenos" data-linenos=" 9 "></span></a>                          v
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10"></a><a href="#__codelineno-29-10"><span class="linenos" data-linenos="10 "></span></a>            +---------------------------+
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11"></a><a href="#__codelineno-29-11"><span class="linenos" data-linenos="11 "></span></a>            | series_decomp(kernel_size)|
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12"></a><a href="#__codelineno-29-12"><span class="linenos" data-linenos="12 "></span></a>            | self.decompÂÆû‰æã           |
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13"></a><a href="#__codelineno-29-13"><span class="linenos" data-linenos="13 "></span></a>            +---------------------------+
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14"></a><a href="#__codelineno-29-14"><span class="linenos" data-linenos="14 "></span></a>                          |
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15"></a><a href="#__codelineno-29-15"><span class="linenos" data-linenos="15 "></span></a>                          v
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16"></a><a href="#__codelineno-29-16"><span class="linenos" data-linenos="16 "></span></a>            +---------------------------+
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17"></a><a href="#__codelineno-29-17"><span class="linenos" data-linenos="17 "></span></a>            | series_decomp.forward(x)  |
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18"></a><a href="#__codelineno-29-18"><span class="linenos" data-linenos="18 "></span></a>            | 1. Ë∞ÉÁî®ÁßªÂä®Âπ≥ÂùáËÆ°ÁÆóË∂ãÂäø   |
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19"></a><a href="#__codelineno-29-19"><span class="linenos" data-linenos="19 "></span></a>            | 2. ÂéüÂ∫èÂàóÂáèÂéªË∂ãÂäøÂæóÂà∞Â≠£ËäÇÊÄß|
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20"></a><a href="#__codelineno-29-20"><span class="linenos" data-linenos="20 "></span></a>            +---------------------------+
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21"></a><a href="#__codelineno-29-21"><span class="linenos" data-linenos="21 "></span></a>                          |
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22"></a><a href="#__codelineno-29-22"><span class="linenos" data-linenos="22 "></span></a>                  +-------+-------+
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23"></a><a href="#__codelineno-29-23"><span class="linenos" data-linenos="23 "></span></a>                  |               |
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24"></a><a href="#__codelineno-29-24"><span class="linenos" data-linenos="24 "></span></a>                  v               v
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25"></a><a href="#__codelineno-29-25"><span class="linenos" data-linenos="25 "></span></a>    +---------------------------+  +---------------------------+
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26"></a><a href="#__codelineno-29-26"><span class="linenos" data-linenos="26 "></span></a>    | moving_avg.forward(x)     |  | Â≠£ËäÇÊÄßËÆ°ÁÆó                |
</span><span id="__span-29-27"><a id="__codelineno-29-27" name="__codelineno-29-27"></a><a href="#__codelineno-29-27"><span class="linenos" data-linenos="27 "></span></a>    | Ê≠•È™§:                     |  | res = x - moving_mean     |
</span><span id="__span-29-28"><a id="__codelineno-29-28" name="__codelineno-29-28"></a><a href="#__codelineno-29-28"><span class="linenos" data-linenos="28 "></span></a>    | 1.ÂâçÂêéÂ°´ÂÖÖÂ∫èÂàó           |  |                           |
</span><span id="__span-29-29"><a id="__codelineno-29-29" name="__codelineno-29-29"></a><a href="#__codelineno-29-29"><span class="linenos" data-linenos="29 "></span></a>    | 2.Â∫îÁî®Âπ≥ÂùáÊ±†Âåñ           |  |                           |
</span><span id="__span-29-30"><a id="__codelineno-29-30" name="__codelineno-29-30"></a><a href="#__codelineno-29-30"><span class="linenos" data-linenos="30 "></span></a>    | 3.ËøîÂõûË∂ãÂäøÂàÜÈáè           |  |                           |
</span><span id="__span-29-31"><a id="__codelineno-29-31" name="__codelineno-29-31"></a><a href="#__codelineno-29-31"><span class="linenos" data-linenos="31 "></span></a>    +---------------------------+  +---------------------------+
</span><span id="__span-29-32"><a id="__codelineno-29-32" name="__codelineno-29-32"></a><a href="#__codelineno-29-32"><span class="linenos" data-linenos="32 "></span></a>                  |               |
</span><span id="__span-29-33"><a id="__codelineno-29-33" name="__codelineno-29-33"></a><a href="#__codelineno-29-33"><span class="linenos" data-linenos="33 "></span></a>                  v               v
</span><span id="__span-29-34"><a id="__codelineno-29-34" name="__codelineno-29-34"></a><a href="#__codelineno-29-34"><span class="linenos" data-linenos="34 "></span></a>             Ë∂ãÂäøÂàÜÈáè        Â≠£ËäÇÊÄßÂàÜÈáè
</span><span id="__span-29-35"><a id="__codelineno-29-35" name="__codelineno-29-35"></a><a href="#__codelineno-29-35"><span class="linenos" data-linenos="35 "></span></a>          trend_init [B,L,D]  seasonal_init [B,L,D]
</span><span id="__span-29-36"><a id="__codelineno-29-36" name="__codelineno-29-36"></a><a href="#__codelineno-29-36"><span class="linenos" data-linenos="36 "></span></a>                  |               |
</span><span id="__span-29-37"><a id="__codelineno-29-37" name="__codelineno-29-37"></a><a href="#__codelineno-29-37"><span class="linenos" data-linenos="37 "></span></a>                  +       +       +
</span><span id="__span-29-38"><a id="__codelineno-29-38" name="__codelineno-29-38"></a><a href="#__codelineno-29-38"><span class="linenos" data-linenos="38 "></span></a>                          |
</span><span id="__span-29-39"><a id="__codelineno-29-39" name="__codelineno-29-39"></a><a href="#__codelineno-29-39"><span class="linenos" data-linenos="39 "></span></a>                          v
</span><span id="__span-29-40"><a id="__codelineno-29-40" name="__codelineno-29-40"></a><a href="#__codelineno-29-40"><span class="linenos" data-linenos="40 "></span></a>                ËøîÂõûÂà∞Model.forward()
</span><span id="__span-29-41"><a id="__codelineno-29-41" name="__codelineno-29-41"></a><a href="#__codelineno-29-41"><span class="linenos" data-linenos="41 "></span></a>                ËøõË°åÂêéÁª≠Â§ÑÁêÜ
</span></code></pre></div>
<p>ËÆ≤Âõæ ÈÄêÂ≠óÁ®øÔºö</p>
<p>Ôºà1Ôºâ<strong>Model.forward()</strong> Ë∞ÉÁî® self.decomp(x_enc)ËøõË°åÂ∫èÂàóÂàÜËß£</p>
<p>Ôºà2Ôºâ<strong>series_decomp.forward(x)</strong></p>
<blockquote>
<p>ÂåÖÂê´‰∏§‰∏™‰∏ªË¶ÅÊ≠•È™§:</p>
<ul>
<li>Ë∞ÉÁî® self.moving_avg(x)ËÆ°ÁÆóÁßªÂä®Âπ≥ÂùáÔºåÂæóÂà∞Ë∂ãÂäøÂàÜÈáè</li>
<li>ËÆ°ÁÆóÂéüÂ∫èÂàó‰∏éË∂ãÂäøÂàÜÈáèÁöÑÂ∑ÆÂÄºÔºåÂæóÂà∞Â≠£ËäÇÊÄßÂàÜÈáè</li>
</ul>
</blockquote>
<p>Ôºà3Ôºâ<strong>moving_avg.forward(x)</strong></p>
<blockquote>
<p>ÊâßË°åÁßªÂä®Âπ≥ÂùáËÆ°ÁÆó:</p>
<ul>
<li>ÈÄöËøáÈáçÂ§çÈ¶ñÂ∞æÂÖÉÁ¥†ËøõË°åÂ∫èÂàóÂ°´ÂÖÖ</li>
</ul>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><a href="#__codelineno-30-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">front</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a><a href="#__codelineno-30-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">end</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a><a href="#__codelineno-30-3"><span class="linenos" data-linenos="3 "></span></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">front</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">end</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<ul>
<li>Â∫îÁî®‰∏ÄÁª¥Âπ≥ÂùáÊ±†ÂåñÊìç‰Ωú</li>
</ul>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><a href="#__codelineno-31-1"><span class="linenos" data-linenos="1 "></span></a>x = self.avg(x.permute(0, 2, 1))
</span></code></pre></div>
<p><strong>ËØ¥Êòé ‰∏∫‰ªÄ‰πàÂ°´ÂÖÖÔºåÊòØ‰∏∫‰∫Ü ‰øùËØÅÂ∫èÂàóÂú®Âπ≥ÂùáÊ±†ÂåñÂêé ÈïøÂ∫¶‰∏çÂèò</strong></p>
<ul>
<li>ËøîÂõûÂπ≥ÊªëÂêéÁöÑË∂ãÂäøÂàÜÈáè</li>
</ul>
<p>ËøôÈÉ®ÂàÜÁöÑÂΩ¢Áä∂ÂèòÂåñÔºö </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319224010427.png"><img alt="image-20250319224010427" src="../images/image-20250319224010427.png"/></a> </p>
</blockquote>
<p>Áé∞Âú®ÂºÄÂßã ËøîÂõû <strong>moving_avg.forward(x)</strong> ÊòØÂà©Áî® 1D Âπ≥ÂùáÊ±†Âåñ ÂæóÂà∞ Ë∂ãÂäøÂ∫èÂàóÔºåÂ∞ÜÁªìÊûúËøîÂõûÁªô <strong>series_decomp</strong> Ôºå‰πüÂ∞±ÊòØËøôÂè•‰ª£Á†Å <code>moving_mean = self.moving_avg(x)</code>ÔºåÂæóÂà∞Ë∂ãÂäøÂ∫èÂàó‰ª•ÂêéÔºåÊ∞∏ËøúÂ∫èÂàóÂáèË∂ãÂäøÂ∫èÂàó <code>res = x - moving_mean</code> ÔºåÂæóÂà∞Â≠£ËäÇÂàÜÈáèÔºå‰πüÂ∞±ÊòØÂë®ÊúüÊÄß‰ø°ÊÅØ„ÄÇÂÖ∑‰ΩìÁöÑ‰ª£Á†ÅÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319224315222.png"><img alt="image-20250319224315222" src="../images/image-20250319224315222.png"/></a></p>
<p>ÊúÄÁªà Â∞ÜÁªìÊûú ËøîÂõûÁªô Autoformer forward ‰∏≠ÁöÑ seasonal_init, trend_init</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319224700908.png"><img alt="image-20250319224700908" src="../images/image-20250319224700908.png"/></a></p>
<p>Âπ∂‰∏î Áî®Ëøô‰∏§‰∏™ init ÂàùÂßãÂåñ Ëß£Á†ÅÂô®ÁöÑËæìÂÖ•„ÄÇ</p>
<p>ËøôÈáåÂæóÊ≥®ÊÑè‰∏Ä‰∏ãÔºåÂØπ‰∫é Ê†áÁ≠æÂ∫èÂàóÔºå‰πüÂ∞±ÊòØ ËæìÂÖ•Â∫èÂàóÁöÑË∂ãÂäø‰ø°ÊÅØÁöÑÊèêÂèñÁî®ÁöÑÊòØ 1DÂπ≥ÂùáÊ±†ÂåñÔºåËÄåÂØπÈ¢ÑÊµã predict length ÁöÑË∂ãÂäø‰ø°ÊÅØÂàùÂßãÂåñ Â∞±Áõ¥Êé•Áî®ÁöÑ ËæìÂÖ•Â∫èÂàóÁöÑÂùáÂÄº</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a><a href="#__codelineno-32-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">mean</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_enc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<p>Âë®ÊúüÊÄßË∂ãÂäø‰πüÊòØÔºålabel length ÁöÑÂ≠£ËäÇË∂ãÂäøÊòØ ÊÆãÂ∑ÆÔºå‰πüÂ∞±ÊòØ ÂéüÂßãÂ∫èÂàó ÂáèÂéª Ë∂ãÂäøÂ∫èÂàóÔºåËÄå predict length ÁöÑ Â≠£ËäÇË∂ãÂäøÂ∞±ÊòØÁõ¥Êé•ÂàùÂßãÂåñ‰∏∫ 0 ‰∫Ü„ÄÇ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><a href="#__codelineno-33-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">zeros</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">x_dec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span><span class="p">,</span> <span class="n">x_dec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">device</span><span class="o">=</span><span class="n">x_enc</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> 
</span></code></pre></div>
<p>ËøôÈáåÊòØ Â∞èÂ∞èÁöÑÂå∫Âà´ÔºåÂ∞èÂ∞èÁöÑÊ≥®ÊÑè„ÄÇ</p>
<p>Â•Ω‰∫Ü ËøôÈÉ®ÂàÜÔºåÂ∫èÂàóÂàÜËß£ËØ¥ÂÆå‰∫ÜÔºå‰ª£Á†ÅËÆ≤‰∫ÜÔºåÂéüÊñáËÆ≤‰∫ÜÔºåÂÖ¨ÂºèÂØπÂ∫î‰∏ä‰∫ÜÔºåÂõæ‰πüËØ¥‰∫Ü„ÄÇÂéüÊñá <code>Series decomposition block</code>  Â∞±ËøáÂï¶</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319225341745.png"><img alt="image-20250319225341745" src="../images/image-20250319225341745.png"/></a> </p>
<p>Â∫èÂàóÂàÜËß£ over</p>
<hr/>
<h3 id="model-inputs">model inputs<a class="headerlink" href="#model-inputs" title="Permanent link">¬∂</a></h3>
<p>‰∏ãÈù¢ÂºÄÂßã Ê®°ÂûãÁöÑËæìÂÖ•ÔºåÂÖà‰ªéËÆ∫ÊñáÂºÄÂßãËÆ≤Ëß£Ôºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250319225433558.png"><img alt="image-20250319225433558" src="../images/image-20250319225433558.png"/></a> </p>
<p>Ê®°ÂûãÁöÑËæìÂÖ•ÈÉ®ÂàÜÔºåÊ®°ÂûãÁöÑËæìÂÖ•ÂåÖÊã¨ÁºñÁ†ÅÂô®ÁöÑËæìÂÖ•ÂíåËß£Á†ÅÂô®ÁöÑËæìÂÖ•„ÄÇÂÖ∑‰ΩìÊù•ËØ¥Ôºå</p>
<p>ÁºñÁ†ÅÂô®ÁöÑËæìÂÖ•ÊòØËøáÂéª <span class="arithmatex">\(I\)</span> ‰∏™Êó∂Èó¥Ê≠•ÔºåÊñá‰∏≠ÁªôÂá∫ÁöÑÁ¨¶Âè∑Ë°®Á§∫ <span class="arithmatex">\(\mathcal{X}^{I \times d}\)</span> Ôºå<span class="arithmatex">\(I\)</span> Ë°®Á§∫Êó∂Èó¥Ê≠•ÈïøÔºå<span class="arithmatex">\(d\)</span> Ë°®Á§∫ÊØè‰∏™Êó∂Èó¥Ê≠•ÁöÑÁâπÂæÅÊï∞„ÄÇ</p>
<p>Ëß£Á†ÅÂô®ÁöÑËæìÂÖ•ÂåÖÊã¨‰∫Ü Â≠£ËäÇÊÄßÂ∫èÂàó Âíå Ë∂ãÂäøÊÄßÂ∫èÂàóÔºåÂÖ∑‰ΩìÁöÑÁ¨¶Âè∑Ë°®Á§∫ÂàÜÂà´ÊòØ <span class="arithmatex">\(\mathcal{X}_{des}\)</span>  Âíå <span class="arithmatex">\(\mathcal{X}_{det}\)</span>    ÂΩ¢Áä∂ÊòØ‰∏ÄÊ†∑ÁöÑÔºö<span class="arithmatex">\((\frac{I}{2}+O)\)</span>  „ÄÅ<span class="arithmatex">\(\frac{I}{2}\)</span> ÊòØ label length ÁöÑÈïøÂ∫¶ÔºåÂèñÁöÑÊòØÂéüÂßãËæìÂÖ•Â∫èÂàóÈïøÂ∫¶ÁöÑ ‰∏ÄÂçä„ÄÇO ÊòØ È¢ÑÊµãÊ≠•Èïø predict length„ÄÇd ÂêåÊ†∑ÊòØÊØè‰∏™Êó∂Èó¥Ê≠•ÁöÑÁâπÂæÅÊï∞„ÄÇÊé•‰∏ãÊù•ÔºåÊàë‰ª¨Êù•ÁúãÂÖ¨ÂºèÊòØÊÄé‰πàË°®Á§∫ÁöÑÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320085551155.png"><img alt="image-20250320085551155" src="../images/image-20250320085551155.png"/></a></p>
<p><span class="arithmatex">\(\mathcal{X}_{ens}„ÄÅ\mathcal{X}_{ent}\)</span>  ÂàÜÂà´Ë°®Á§∫ ‰ªé ÂéüÂßã ËæìÂÖ•Â∫èÂàó <span class="arithmatex">\(\mathcal{X}_{en}\)</span> ÂàÜËß£Âá∫ÁöÑÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜÔºåÊà™ÂèñÂá∫ÂêéÂçäÈÉ®ÂàÜ <span class="arithmatex">\(\frac{I}{2}:I\)</span> ‰Ωú‰∏∫ label lengthÔºå‰∏éÈïøÂ∫¶‰∏∫ predict  length ÁöÑÊó∂Èó¥Ê≠•ËøõË°åÊãºÊé•ÔºåÁî® 0 Â°´ÂÖÖÁöÑÈïøÂ∫¶‰∏∫ predict lengthÁöÑÂêëÈáèËÆ∞‰Ωú <span class="arithmatex">\(\mathcal{X}_0\)</span> ÔºåÁî®ËæìÂÖ•Êó∂Èó¥Â∫èÂàóÊó∂Èó¥Ê≠•ÂùáÂÄºÂ°´ÂÖÖÁöÑÈïøÂ∫¶‰∏∫ predict length ÁöÑÂêëÈáèËÆ∞‰Ωú <span class="arithmatex">\(\mathcal{X}_{mean}\)</span></p>
<p>ÁÑ∂ÂêéÔºå<span class="arithmatex">\(\mathcal{X}_{ens}\)</span> ‰∏é <span class="arithmatex">\(\mathcal{X}_0\)</span> ËøõË°å concat ÂæóÂà∞ Ëß£Á†ÅÂô®Â≠£ËäÇÊàêÂàÜÁöÑÂàùÂßãÂÄº  <span class="arithmatex">\(\mathcal{X}_{des}\)</span></p>
<p>ÂØπÂ∫îÁùÄÁöÑ <span class="arithmatex">\(\mathcal{X}_{ent}\)</span> ‰∏é <span class="arithmatex">\(\mathcal{X}_{mean}\)</span> concat ÂæóÂà∞Ëß£Á†ÅÂô®Ë∂ãÂäøÊàêÂàÜÁöÑÂàùÂßãÂÄº <span class="arithmatex">\(\mathcal{X}_{mean}\)</span></p>
<p><strong>ÂÜçÂº∫Ë∞É‰∏Ä‰∏ãÔºåËøôÈáåÊâÄÊ∂âÂèäÁöÑÂêëÈáèÁöÑËÆ∞Âè∑ÂíåÂΩ¢Áä∂Ôºö</strong> </p>
<ul>
<li>ÁºñÁ†ÅÂô®ÁöÑËæìÂÖ•ÊòØ ËøáÂéª <span class="arithmatex">\(I\)</span> ‰∏™Êó∂Èó¥Ê≠•ÔºåË°®Á§∫ <span class="arithmatex">\(\mathcal{X}^{I \times d}\)</span> Ôºå<span class="arithmatex">\(I\)</span> Ë°®Á§∫Êó∂Èó¥Ê≠•ÈïøÔºå<span class="arithmatex">\(d\)</span> Ë°®Á§∫ÊØè‰∏™Êó∂Èó¥Ê≠•ÁöÑÁâπÂæÅÊï∞„ÄÇ</li>
<li>Ëß£Á†ÅÂô®Â≠£ËäÇÊàêÂàÜÁöÑËæìÂÖ•ÊòØ <span class="arithmatex">\(\mathcal{X}_{des} ^{(\frac{I}{2}+O)\times d}\)</span> „ÄÅËß£Á†ÅÂô®Ë∂ãÂäøÊàêÂàÜÁöÑËæìÂÖ•ÊòØ <span class="arithmatex">\(\mathcal{X}_{det} ^{(\frac{I}{2}+O)\times d}\)</span> </li>
<li>Ê∂âÂèäÂà∞ÁöÑ‰∏≠Èó¥ÂèòÈáèÔºå<span class="arithmatex">\(\mathcal{X}^{\frac{I}{2} \times d}_{ens}\)</span> Ôºå<span class="arithmatex">\(\mathcal{X}^{\frac{I}{2} \times d}_{ent}\)</span> ÂèØ‰ª•ÁêÜËß£‰∏∫Ê†áÁ≠æÂ∫èÂàóÁöÑÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜÔºåÂ∞±ÊòØ‰ªéËæìÂÖ•Â∫èÂàóÂàÜËß£ÁöÑÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ‰∏≠Êà™ÂèñÁöÑÂêéÂçäÊÆµ„ÄÇ</li>
<li>È¢ÑÊµãÂ∫èÂàóÂ≠£ËäÇÊàêÂàÜÁöÑÂàùÂßãÂÄºÊòØ <span class="arithmatex">\(\mathcal{X}_0 ^{O \times d}\)</span> ÔºåË∂ãÂäøÊàêÂàÜÂàùÂßãÂÄºÊòØ <span class="arithmatex">\(\mathcal{X}^{O \times d} _{Mean}\)</span></li>
</ul>
<p>‰πüÂ∞±ÊòØËÆ∫Êñá‰∏≠Ê®°ÂûãÁªìÊûÑÂõæÁöÑÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320091412914.png"><img alt="image-20250320091412914" src="../images/image-20250320091412914.png"/></a></p>
<p>ÂÖ∑‰ΩìÂà∞‰ª£Á†ÅÔºåÂ∞±ÊòØ autoformer forwardÁöÑÂâç 5 Ë°åÔºåÂÖ∂‰∏≠ self.decompÊòØÊàë‰ª¨ÂàöÂàö‰ªîÁªÜËÆ≤ËøáÁöÑ Â∫èÂàóÂàÜËß£Ê®°Âùó Series decomposition blockÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320091921116.png"><img alt="image-20250320091921116" src="../images/image-20250320091921116.png"/></a></p>
<p>ËøôÈÉ®ÂàÜ‰ª£Á†ÅÊØîËæÉÂ•ΩÁêÜËß£ÔºåÂ∞±ËøôÊ†∑Ôºå‰ª•‰∏äÈÉ®ÂàÜÂÆåÊàê‰∫ÜÂØπÂéüÊñá model inputs ÈÉ®ÂàÜÁöÑËÆ≤Ëß£Ôºå‰ª£Á†ÅÔºåËÆ∫ÊñáÔºåÂõæÔºåÂÖ¨ÂºèÈÉΩËÆ≤‰∫Ü„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320092158923.png"><img alt="image-20250320092158923" src="../images/image-20250320092158923.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320092214513.png"><img alt="image-20250320092214513" src="../images/image-20250320092214513.png"/></a></p>
<h3 id="encoder">Encoder<a class="headerlink" href="#encoder" title="Permanent link">¬∂</a></h3>
<p><strong>Êé•‰∏ãÊù•ËøõÂÖ•ËÆ∫ÊñáÁöÑ Encoder ÈÉ®ÂàÜ</strong> </p>
<p>‰ºöÂêåÊ†∑ÊåâÁÖßÔºåËÆ∫Êñá„ÄÅÂõæ„ÄÅÂÖ¨Âºè„ÄÅ‰ª£Á†Å‰∏Ä‰∏ÄÂØπÂ∫îÁöÑÈÄªËæëËøõË°åËÆ≤Ëß£</p>
<p><strong>È¶ñÂÖàÔºåAutoformer ÈÅµÂæ™ÂéüÂßã Transformer ÁöÑÁªìÊûÑÔºå</strong> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320092445230.png"><img alt="image-20250320092445230" src="../images/image-20250320092445230.png"/></a></p>
<p>ÁºñÁ†ÅÂô®ÔºåËß£Á†ÅÂô®ÔºåÁºñÁ†ÅÂô®Êé•Êî∂ÁöÑ input ÊòØ word embedding + positional embeddingÔºåÁÑ∂ÂêéÈÄöËøáËá™Ê≥®ÊÑèÂäõÊú∫Âà∂ÂíåÂâçÈ¶àÁ•ûÁªèÁΩëÁªú„ÄÇËß£Á†ÅÂô®Êé•Êî∂ÁöÑ ËæìÂÖ•ÊòØ outputÔºåÈ¢ÑÊµãÈÉ®ÂàÜÔºåÂêåÊ†∑ÊòØ word embedding+positional embeddingÔºåÁÑ∂ÂêéÂàÜÂà´ÁªèËøáËß£Á†ÅÂô®ËæìÂÖ•ÁöÑ Ëá™Ê≥®ÊÑèÂäõÊú∫Âà∂Ôºå‰ª•ÂèäÂíåÁºñÁ†ÅÂô®ËæìÂá∫ ÁöÑ ‰∫§ÂèâÊ≥®ÊÑèÂäõÔºåÊúÄÂêéÁªèËøá ÂÖ®ËøûÊé•Â±ÇÔºåÂæóÂà∞ÊúÄÁªàÁöÑËæìÂá∫„ÄÇ</p>
<p>È¶ñÂÖàÂº∫Ë∞É‰∏Ä‰∏ãÂÖ≥‰∫éTransformer ‰∏∫‰ªÄ‰πàÊòØÊ≥®ÊÑèÂäõÊú∫Âà∂ÂíåÂÖ®ËøûÊé•Â±ÇÁöÑËÆæËÆ°Ôºü</p>
<blockquote>
<p>È¶ñÂÖàÔºåTransformer Âú® NLP‰∏≠Êé•Êî∂ÁöÑÊï∞ÊçÆÊ†ºÂºè ÊòØ [B,L,D]Ôºåbatch sizeÔºå‰∏Ä‰∏™ batch ‰∏≠ÊúâÂ§öÂ∞ë‰∏™Âè•Â≠êÔºå‰∏Ä‰∏™Âè•Â≠ê‰∏≠ÊúâÂá†‰∏™ËØç LÔºåÊØè‰∏™ËØçÁöÑÂµåÂÖ•DÔºå‰πüÂ∞±ÊòØÊØè‰∏™ËØçÁî®ÈïøÂ∫¶‰∏∫Â§öÂ∞ëÁöÑÂêëÈáèË°®Á§∫</p>
<p>ÊúÄÁõ¥ËßÇÁöÑËÆ≤Ëß£ÔºåÂ∞±ÊòØ Ê≥®ÊÑèÂäõÊú∫Âà∂ËøõË°å L Â±ÇÈù¢ÁöÑ‰∫§‰∫íÔºåÂâçÈ¶àÁ•ûÁªèÁΩëÁªúËøõË°å D Â±ÇÈù¢ÁöÑ‰∫§‰∫í„ÄÇ</p>
<p><strong>L Â±ÇÈù¢‰πüÂ∞±ÊòØÊ≥®ÊÑèÂà∞‰∫Ü ËØç‰∏éËØç‰πãÈó¥ÁöÑ‰∫§‰∫íÔºåD Â±ÇÈù¢Â∞±ÊòØËØç‰∏éËØç‰πãÈó¥ÁâπÂæÅÁöÑ‰∫§‰∫í</strong> </p>
<blockquote>
<p>Âú®LÂ±ÇÈù¢ÔºàÂçïËØçÂ±ÇÈù¢ÔºâËøõË°å‰∫§‰∫íÔºåËÆ°ÁÆóÊØè‰∏™ÂçïËØçÂØπÂÖ∂‰ªñÂçïËØçÁöÑÊ≥®ÊÑèÂäõÊùÉÈáçÔºåÊçïÊçâËØç‰∏éËØç‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºõ</p>
<p>Âú®DÂ±ÇÈù¢ÔºàÂç≥ÂçïËØçÂµåÂÖ•ÁöÑÁâπÂæÅÂ±ÇÈù¢ÔºâËøõË°å‰∫§‰∫íÔºåÂØπÊØè‰∏™ÂçïËØçÁöÑÂµåÂÖ•ÂêëÈáèËøõË°åÈùûÁ∫øÊÄßÂèòÊç¢ÔºåÊçïÊçâËØç‰∏éËØç‰πãÈó¥ÁöÑÁâπÂæÅ‰∫§‰∫í </p>
</blockquote>
<p><strong>ÂØπÂ∫îÂà∞Êó∂Èó¥Â∫èÂàó‰∏≠</strong></p>
<p>1Ô∏è‚É£ Ê†áÂáÜ <mark>ËæìÂÖ•</mark> Ê†ºÂºè‰πüÊòØ BLDÔºåÂÖ∑‰ΩìÁöÑËß£ÈáäÔºö </p>
<blockquote>
<p>B = 32 (ÊâπÈáèÂ§ßÂ∞èÔºå32‰∏™Êó∂Èó¥Â∫èÂàóÊ†∑Êú¨)
L = 36 (ÊØè‰∏™Ê†∑Êú¨Êúâ36‰∏™Êó∂Èó¥Ê≠•ÔºåÂ¶ÇËøáÂéª36Â§©ÁöÑÊï∞ÊçÆ)
D = 7 (ÊØè‰∏™Êó∂Èó¥Ê≠•Êúâ7‰∏™ÁâπÂæÅÔºåÂ¶ÇÂØπ‰∫éËÇ°Á•®ÂèØËÉΩÂåÖÊã¨ÂºÄÁõò‰ª∑„ÄÅÊî∂Áõò‰ª∑„ÄÅÊúÄÈ´ò‰ª∑„ÄÅÊúÄ‰Ωé‰ª∑„ÄÅ‰∫§ÊòìÈáèÁ≠â)</p>
</blockquote>
<p>2Ô∏è‚É£ <mark>Â§ÑÁêÜ</mark>   Ê≥®ÊÑèÂäõÊú∫Âà∂</p>
<p>ÁºñÁ†ÅÂô®‰∏≠ÔºåÊ≥®ÊÑèÂäõÂú®ÊâÄÊúâ36‰∏™Êó∂Èó¥Ê≠•‰πãÈó¥Âª∫Á´ãËøûÊé•
Ëß£Á†ÅÂô®‰∏≠ÔºåÊ≥®ÊÑèÂäõÊó¢Âú®È¢ÑÊµãÂ∫èÂàóÂÜÖÈÉ®Âª∫Á´ãËøûÊé•Ôºå‰πü‰∏éÁºñÁ†ÅÂô®ËæìÂá∫Âª∫Á´ãËøûÊé•</p>
<p>Êó∂Èó¥Ê≠•‰πãÈó¥ÁöÑÂª∫Ê®° ÂèØ‰ª• ÂèëÁé∞ËÇ°Á•®‰ª∑Ê†ºÊØèÂë®‰∫îÂèØËÉΩ‰∏ãË∑åÔºåÊàñËÄÖÊØèÊúàÂàùÂèØËÉΩ‰∏äÊ∂®ÁöÑÊ®°Âºè</p>
<p>3Ô∏è‚É£ <mark>Â§ÑÁêÜ</mark>  ÂâçÈ¶àÂÖ®ËøûÊé•Â±Ç</p>
<p>Â§ÑÁêÜÊØè‰∏™Êó∂Èó¥Ê≠•ÂÜÖ7‰∏™ÁâπÂæÅ‰πãÈó¥ÁöÑÂÖ≥Á≥ª</p>
<p>‰æãÂ¶ÇÔºå‰∫§ÊòìÈáè‰∏é‰ª∑Ê†ºÂèòÂä®ÁöÑÂÖ≥Á≥ªÔºåÊàñÂºÄÁõò‰ª∑‰∏éÊî∂Áõò‰ª∑ÁöÑÂÖ≥Á≥ª</p>
</blockquote>
<p>ËØ∂ÔºåËØ¥Ëµ∑Ëøô‰∏™ÔºåÂÖ≥‰∫éÁî®Áé∞ÂÆû‰æãÂ≠êÁêÜËß£Ëøô‰∫õÊ®°ÂûãÔºå</p>
<p><strong>È¶ñÂÖàÔºåÂç∑ÁßØÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü</strong> </p>
<p>ÂÅáÂ¶ÇÊàë‰ª¨Ë¶ÅËÆ§ËØÜ‰∏Ä‰∏™‰∫∫AÔºåB ÊòØ A ÁöÑÁõ¥Êé•ÊúãÂèãÔºåÂΩ¢Êàê‰∫ÜB ÂØπ A ÁöÑÁ¨¨‰∏ÄÊ¨°ËÆ§ËØÜÔºåB Â∞±Áõ∏ÂΩì‰∫éÂç∑ÁßØÊ†∏‰∫ÜÔºåÈÇ£Áõ¥Êé•ËÆ§ËØÜ AÁöÑËÇØÂÆö‰∏çÊ≠¢‰∏Ä‰∏™‰∫∫ÔºåËøòÊúâB1ÔºåB2ÔºåB3...Á≠âÔºåÊØè‰∏™‰∫∫ÂØπÂΩ¢Êàê‰∫ÜÂØπ A ÁöÑÁ¨¨‰∏ÄÊ¨°ËÆ§ËØÜÔºåÁà∂ÊØçËÆ§ËØÜ AÊõ¥ÂÖ≥Ê≥®ÁîüÊ¥ªÂ±ÇÈù¢ÔºåÂ≠¶Ê†°‰∏≠Áõ¥Êé•ËÆ§ËØÜÁöÑ A Êõ¥ÂÖ≥‰∫é‰∏∫‰∫∫Â§Ñ‰∫ãÈÉ®ÂàÜÔºåÂ∑•‰Ωú‰∏≠Áõ¥Êé•ËÆ§ËØÜÁöÑ A Êõ¥ÂÖ≥‰∫é A ÁöÑÁîü‰∫ßÊÄß„ÄÇËøôÈáåÁõ¥Êé•ËÆ§ËØÜ A ÁöÑB1ÔºåB2ÔºåB3...Â∞±ÊòØÊØè‰∏ÄÂ±Ç‰∏≠ Âç∑ÁßØÊ†∏ÁöÑ‰∏™Êï∞„ÄÇÈô§‰∫ÜÁõ¥Êé•ËÆ§ËØÜ A ÁöÑÔºåËøòÊúâÈÄöËøáÁõ¥Êé•ËÆ§ËØÜ A ÁöÑ‰∫∫B ËÆ§ËØÜ AÔºåËøôÊ≥¢‰∫∫Âè´ CÔºåÈÇ£ËøòÊúâÈÄöËøá C ËÆ§ËØÜ A ÁöÑÔºåÈÇ£ C ÂèàËÆ§ËØÜ DÔºåD ÂèàÈÄöËøá C ËÆ§ËØÜ A„ÄÇÈô§‰∫ÜÂà´‰∫∫ËÆ§ËØÜ AÔºåA Ëá™Â∑±‰πüÊúâÂØπËá™Â∑±ÁöÑËÆ§ËØÜ„ÄÇ</p>
<p><strong>TransformerÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü</strong></p>
<p>Èô§‰∫ÜÂàöÂàöËØ¥ÁöÑ Ê≥®ÊÑèÂäõÊú∫Âà∂ÂíåÂâçÈ¶àÂÖ®ËøûÊé•Â±ÇÁöÑÁêÜËß£ÔºåËøòÊúâ Encoder „ÄÅDecoder „ÄÅÂ§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂ÁöÑÁêÜËß£„ÄÇ</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Encoder&amp;Decoder ÁöÑ‰∫§‰∫íÊÄé‰πàÁêÜËß£Ôºü</li>
</ul>
<p>È¶ñÂÖàÔºåÊï¥‰Ωì‰∏äÁöÑËøô‰∏™ÂõæÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320095403477.png"><img alt="image-20250320095403477" src="../images/image-20250320095403477.png"/></a></p>
<p>ÁºñÁ†ÅÂô®Áõ∏ÂΩì‰∫éÁî≤ÊñπÔºåËß£Á†ÅÂô®Áõ∏ÂΩì‰∫é‰πôÊñπÔºåÁî≤ÊñπÊúâÈúÄÊ±ÇÔºåËá™Â∑±ÂÖ¨Âè∏ÂÜÖÈÉ®‰∏ÄÁ∫ß‰∏ÄÁ∫ßÊ≤üÈÄöÔºå‰ªéÊúÄÂºÄÂßãÁöÑÊÉ≥Ê≥ïÊúÄÁªàÂΩ¢ÊàêÊñπÊ≥ï‰∫§ÁªôÊúÄÂêé‰∏Ä‰∏™‰∫∫ÔºåËøô‰∏™‰∫∫ÂéªÂíå‰πôÂÖ¨Âè∏Ê≤üÈÄöÔºå‰πôÂÖ¨Âè∏ÂèàÊúâÂæàÂ§ö‰∏™ÈÉ®ÂàÜÔºåÊØè‰∏™ÈÉ®ÂàÜÂàÜÂà´ÂÆåÊàêÁî≤ÂÖ¨Âè∏ÊèêÂá∫ÁöÑÊñπÊ°àÁöÑ‰∏ÄÈÉ®ÂàÜÔºåËøô‰∏Ä‰∏™ËøáÁ®ã‰∏≠ÈúÄË¶Å‰∏çÊñ≠ÁöÑ‰∏éÁî≤ÂÖ¨Âè∏ÊâãÊãøÊúÄÁªàÊñπÊ°àÁöÑ‰∫∫‰∏çÊñ≠Ê≤üÈÄöÔºåÊúÄÁªà‰πôÂÖ¨Âè∏ÂÆåÊàêÊñπÊ°à„ÄÇ</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂ÊÄé‰πàÁêÜËß£</li>
</ul>
<p>ÂØπ‰∫é BLD ÁöÑÂ∫èÂàóÔºåÈ¶ñÂÖàÊòéÁôΩÁöÑÊòØÔºåÈÇ£‰∏™Áª¥Â∫¶ÂàÜÂ§öÂ§¥‰∫ÜÔºåÊòØ D Áª¥Â∫¶ÂàÜÊàê num headÁª¥Â∫¶Âíå head dimÔºåÂÖ∂‰∏≠ num head √ó head dim = embedding dimÔºàDÔºâÔºåÁõ∏ÂΩì‰∫é‰ªÄ‰πàÊÑèÊÄùÔºå‰∏Ä‰∏™‰∫∫Â≠¶Áü•ËØÜÔºàB =1ÔºâÔºåL ÊòØË¶ÅÂ≠¶ÁöÑÂá†Êú¨‰π¶ÔºåD ÊòØÊØèÊú¨‰π¶ÊúâÂá†‰∏™Á´†ËäÇÔºå‰∏ÄËà¨ÊòØ‰∏Ä‰∏™ËÄÅÂ∏àÊïôÊàë‰ª¨Â≠¶‰∏ÄÊï¥Êú¨‰π¶Ôºå‰ΩÜÂ§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂ÁöÑÊÑèÊÄùÊòØÔºå‰∏ÄÊú¨‰π¶ÁöÑÂá†‰∏™Á´†ËäÇÔºåÂàÜÂºÄÔºåÊØîÂ¶ÇÁ¨¨‰∏Ä‰∏™ËÄÅÂ∏àÊïôÁ¨¨‰∏ÄÁ´†ÂíåÁ¨¨‰∫åÁ´†ÔºåÁ¨¨‰∫å‰∏™ËÄÅÂ∏àÊïôÁ¨¨‰∏âÁ´†ÂíåÁ¨¨ÂõõÁ´†ÔºåÊúÄÂêé‰∏§Âº†Á¨¨‰∏â‰∏™ËÄÅÂ∏àÊïôÔºåËøôÊ†∑Â≠¶‰π†ÁöÑÊó∂ÂÄôÔºåÂêåÊ†∑ÊòØ‰∏Ä‰∏™Â≠¶ÊúüÔºå‰∏Ä‰∏™ËÄÅÂ∏àÂè™ÈúÄË¶ÅÂÖ≥Ê≥®‰∏§Á´†ÁöÑÂÜÖÂÆπÔºåÂØπ‰∫éËØæÁ®ãËäÇÂ•èÁöÑÊääÊè°Áü•ËØÜÁêÜËß£ÁöÑÊõ¥ÈÄèÂΩªÔºåÊïàÊûú‰ºöÊØî‰∏Ä‰∏™ËÄÅÂ∏àÊïô‰∏ÄÊï¥Êú¨‰π¶ÁöÑÂÜÖÂÆπË¶ÅÂ•Ω‰∏Ä‰∫õ„ÄÇ</p>
<p>B=3ÔºåÂ∞±ÊòØÁè≠ÈáåÁöÑ 3 ‰∏™‰∫∫ÔºåÊØè‰∏™‰∫∫ËøôÂ≠¶ÊúüÈÉΩË¶Å‰∏äËøôÂá†Êú¨ËØæÔºåÂêåÊ†∑ÁöÑ LD„ÄÇ</p>
<blockquote>
<p>ÊúÄÂêé‰∏Ä‰∏™ linear Â±ÇÔºåÂ∫îËØ•ÊòØ‰∏∫‰∫ÜËøòÂéüÂéüÂßãÁª¥Â∫¶ÁöÑ„ÄÇ</p>
</blockquote>
<h4 id="_8">ËÆ∫Êñá<a class="headerlink" href="#_8" title="Permanent link">¬∂</a></h4>
<p><strong>Â•Ω‰∫ÜÔºåÊâ©Â±ïÁöÑËøú‰∫ÜÔºåÂõûÂà∞ËÆ∫Êñá‰∏≠Encoder ÈÉ®ÂàÜ</strong> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320092249326.png"><img alt="image-20250320092249326" src="../images/image-20250320092249326.png"/></a></p>
<p>ÂéüÊñá‰∏≠ËØ¥ÔºåÈ¶ñÂÖàÁºñÁ†ÅÂô®Êõ¥‰∏ìÊ≥®Â≠£ËäÇÈÉ®ÂàÜÁöÑÂª∫Ê®°ÔºåÁºñÁ†ÅÂô®ÁöÑËæìÂá∫ÂåÖÂê´ËøáÂéªÁöÑÂ≠£ËäÇÊÄß‰ø°ÊÅØÔºåÂπ∂Â∞Ü‰Ωú‰∏∫‰∫§Âèâ‰ø°ÊÅØÂ∏ÆÂä©Ëß£Á†ÅÂô®ÁªÜÂåñÈ¢ÑÊµãÁªìÊûúÔºåÂÅáËÆæÊúâ N ‰∏™ÁºñÁ†ÅÂô®ÔºåÂàôÁ¨¨ i Â±ÇÁºñÁ†ÅÂô®ÁöÑÊÄª‰ΩìÊñπÁ®ãÂèØ‰ª•Ë°®Á§∫‰∏∫ <span class="arithmatex">\(\mathcal{X}_{en}^l = Encoder(\mathcal{X}_{en}^{l-1})\)</span> ÔºåÂ∞±ÊòØËØ¥ Á¨¨ <span class="arithmatex">\(l\)</span> Â±ÇÁºñÁ†ÅÂô®Êé•Êî∂ Á¨¨ <span class="arithmatex">\(l-1\)</span> Â±ÇÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ËæìÂÖ•ÔºåÂÖ∑‰ΩìÁöÑÁªÜËäÇÊòØÂéüÊñáÁöÑÂÖ¨Âºè(3)</p>
<p><strong>‰∏ãÈù¢ÂØπ ÂÖ¨Âºè 3 ËøõË°åËÆ≤Ëß£</strong></p>
<p>È¶ñÂÖàÔºåÁ≠âÂè∑Â∑¶ËæπÔºå‰∏ãÂàíÁ∫øË°®Á§∫ÂøΩÁï•ÊéâÂ≠£ËäÇÊàêÂàÜÔºåÂè™ÂÖ≥Ê≥®Â≠£ËäÇÊàêÂàÜ„ÄÇ</p>
<p><span class="arithmatex">\(\mathcal{X}_{en}^l = \mathcal{S}_{en}^{l,2},l \in {1,...,N}\)</span>  Ë°®Á§∫ Á¨¨ <span class="arithmatex">\(l\)</span> Â±ÇÁºñÁ†ÅÂô®ÁöÑËæìÂá∫„ÄÇ</p>
<ul class="task-list">
<li>
<p>ÂàùÂßãÂÄºÔºå‰πüÂ∞±ÊòØÁºñÁ†ÅÂô®ÁöÑËæìÂÖ•ÊòØ <span class="arithmatex">\(\mathcal{X}_{en}^0\)</span> ÊòØ ËæìÂÖ•Êó∂Èó¥Â∫èÂàóÁöÑ <span class="arithmatex">\(\mathcal{X}_{en}\)</span> ÁöÑ word embedding</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> <span class="arithmatex">\(\mathcal{S}_{en}^{l,i},i \in {1,2}\)</span> Ë°®Á§∫ Á¨¨ <span class="arithmatex">\(l\)</span>Â±Ç‰∏≠ Á¨¨ i ‰∏™Â∫èÂàóÂàÜËß£Ê®°Âùó‰πãÂêéÁöÑÂ≠£ËäÇÊÄßÊàêÂàÜÔºåÁÑ∂ÂêéÂÖ¨Âºè‰∏≠ÁöÑ Auto-correlation ÂêéÈù¢ÂÜçËØ¥ÔºåËøôÊòØÊú¨ÊñáÁöÑ‰∏Ä‰∏™ÂàõÊñ∞ÁÇπ„ÄÇÔºàpsÔºåÂêéÈù¢Ë¶ÅÈáçÁÇπÁúãËøô‰∏™ÊòØ‰ªÄ‰πàÊÑèÊÄù„ÄÇÔºâ</p>
</li>
</ul>
<blockquote>
<p>ÔºàÊàëÊúÄÂºÄÂßãÁúãËßÅËøôÈáåÁöÑÁñëÈóÆÔºå‰∏çÁî®ËÆ≤ÔºåÂøΩÁï•ÊéâÂç≥ÂèØÔºâÂÖàÁúãÂÖ¨ÂºèÁ≠âÂè∑ÁöÑÂ∑¶ËæπÔºå <span class="arithmatex">\(\mathcal{S}_{en}^{l,1}\)</span> È¶ñÂÖàÔºå‰∏ãÊ†á <span class="arithmatex">\(en\)</span> Â∞±ÊòØË°®Á§∫ ÁºñÁ†ÅÂô®Ôºå<span class="arithmatex">\(l\)</span> Ë°®Á§∫Á¨¨Âá†‰∏™ÁºñÁ†ÅÂô®ÔºåÈÇ£Ëøô‰∏™ <span class="arithmatex">\(1\)</span>ÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü</p>
</blockquote>
<p><strong>ÂéüÊñáÂíåÂÖ¨ÂºèËØ¥‰∫ÜÔºåÊé•‰∏ãÊù•Êù•Áúã‰ª£Á†ÅÔºåEncoder ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ„ÄÇ</strong></p>
<h4 id="encoder-embedding_1">Encoder Embedding<a class="headerlink" href="#encoder-embedding_1" title="Permanent link">¬∂</a></h4>
<p><mark>È¶ñÂÖàÔºåÊûÑÈÄ† Encoder ÁöÑËæìÂÖ•</mark> ÔºåÁºñÁ†ÅÂô®ÂµåÂÖ•„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320143146767.png"><img alt="image-20250320143146767" src="../images/image-20250320143146767.png"/></a></p>
<p>ÂÖ∑‰ΩìÊÄé‰πàÂÅöÁöÑÁúãautoformer ÁöÑ init ÈÉ®ÂàÜÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320143228968.png"><img alt="image-20250320143228968" src="../images/image-20250320143228968.png"/></a></p>
<p>ÁúãÂà∞ËøôËæπË∞ÉÁî®ÁöÑ <code>DataEmbedding_wo_pos</code> Ëøô‰∏™Á±ªÔºåÂÖ∂‰∏≠ÂÖ∑‰ΩìÂú∞ valueEmbedding ÂíåTemporaryEmbedding ÂèàÂàÜÂà´Âú® init ‰∏≠ÊòæÁ§∫Ë∞ÉÁî®‰∫Ü <code>TokenEmbedding</code> Á±ªÂíå <code>TemporalEmbedding</code> Á±ª</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320143256379.png"><img alt="image-20250320143256379" src="../images/image-20250320143256379.png"/></a></p>
<h5 id="_9">Á±ªÂõæ<a class="headerlink" href="#_9" title="Permanent link">¬∂</a></h5>
<p>ÂµåÂÖ•ÈÉ®ÂàÜÁöÑË∞ÉÁî®ÂÖ≥Á≥ªÁî®ÊµÅÁ®ãÂõæÊù•Ë°®Á§∫Ôºö</p>
<pre class="mermaid"><code>classDiagram
    class DataEmbedding_wo_pos {
        +TokenEmbedding value_embedding
        +PositionalEmbedding position_embedding
        +TemporalEmbedding temporal_embedding
        +Dropout dropout
        +forward(x, x_mark)
    }

    class TokenEmbedding {
        +Conv1d tokenConv
        +forward(x)
    }

    class PositionalEmbedding {
        +Tensor pe
        +forward(x)
    }

    class TemporalEmbedding {
        +Embedding minute_embed
        +Embedding hour_embed
        +Embedding weekday_embed
        +Embedding day_embed
        +Embedding month_embed
        +forward(x)
    }

    class TimeFeatureEmbedding {
        +Linear embed
        +forward(x)
    }

    DataEmbedding_wo_pos --&gt; TokenEmbedding
    DataEmbedding_wo_pos --&gt; PositionalEmbedding
    DataEmbedding_wo_pos --&gt; TemporalEmbedding
    TemporalEmbedding --&gt; TimeFeatureEmbedding
</code></pre>
<p>È¶ñÂÖàÔºåË∑üÂ§ßÂÆ∂ËØ¥Ëøô‰∏™ÂõæÊÄé‰πàÁîªÔºåÈ¶ñÂÖàÂú®Ë∞ÉËØïÁöÑËøáÁ®ã‰∏≠ÔºåÁúãÂà∞Ë∞ÉÁî®Áõ∏ÂÖ≥ÁöÑ‰ª£Á†ÅÔºåÂ∞±Á≤òË¥¥Áªô gptÔºåÁÑ∂ÂêéËÆ© gpt Áîª„ÄÇËøô‰∏™ÂõæÂ∞±ÊòØ gpt ÁªôÊàëÁîªÁöÑÔºåÂÆÉÁî®ÁöÑ mermaid ÔºåÁîüÊàê‰ª£Á†ÅÔºåÁÑ∂ÂêéÊàëÁ≤òË¥¥Âà∞ÊàëÁöÑ markdown ÊñáÊ°£‰∏≠ÔºåÊàëÁî®ÁöÑ markdown ÁºñËæëÂô®ÊòØ TyporaÔºåÂèØ‰ª•Ëß£Êûê mermaidÔºåÁî®Âú®Á∫ømermaid ‰πüÂèØ‰ª•ÊòæÁ§∫Âá∫Âõæ„ÄÇÁõ¥Êé•Êêú Âú®Á∫ø mermaid„ÄÇÊàñËÄÖË∑ü gpt ËØ¥ÔºåÁî®ÁÆÄÂçïÁöÑÊµÅÁ®ãÂõæÁîªÔºå‰∏çÁî® mermaidÔºåÈÉΩËÉΩÂ∏Æ‰Ω†ÊääËá™Â∑±ÁöÑ‰ª£Á†ÅÁêÜÊ∏ÖÊ•ö„ÄÇ</p>
<p>mermaid ÁîªÂá∫ÁöÑÁ±ªË∞ÉÁî®ÂõæÔºå‰∏Ä‰∏™Á±ªÁî®‰∏âË°åË°®Á§∫ÔºåÁ¨¨‰∏ÄË°å Á±ªÂêç„ÄÅÁ¨¨‰∫åË°åÔºåinit ÈÉ®ÂàÜÁöÑÂÆö‰πâ„ÄÅÁ¨¨‰∏âË°åÁ±ª‰∏≠ÊñπÊ≥ïÁöÑÂÆö‰πâ</p>
<p><strong>Â•Ω‰∫ÜÔºåÁé∞Âú®ÂºÄÂßãËÆ≤ÂõæÔºå</strong> </p>
<p>ÂèØ‰ª•ÁúãÂà∞ <code>DataEmbedding_wo_pos</code> Á±ª ÁöÑ init ÂàÜÂà´Ë∞ÉÁî®‰∫Ü <code>TokenEmbedding</code>Á±ª„ÄÅ<code>PositionalEmbedding</code>Á±ªÂíå <code>TemporalEmbedding</code>Á±ªÔºåÂêåÊó∂ËøòÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ dropout Â±Ç„ÄÇ</p>
<p>üîµ Ë∞ÉÁî® <code>tokenEmbedding</code>Á±ªÔºåinit ÈÉ®ÂàÜÊòØ‰ΩøÁî®‰∏Ä‰∏™ <code>nn.Conv1d</code> ÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∏™Âç∑ÁßØÂ±ÇÔºå‰º†Áªô <code>self.tokenConv</code> ÔºåÂêéÈù¢Âú® Ëøô‰∏™Á±ª‰∏≠ÁöÑ forward ÊñπÊ≥ï‰∏≠Áî®„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320144456851.png"><img alt="image-20250320144456851" src="../images/image-20250320144456851.png"/></a></p>
<p>ÈÄö‰øóÁÇπËØ¥ÔºåËøôÈáåÁöÑ tokenEmbedding Â∞±ÊòØÈÄöËøá‰∏Ä‰∏™1D Âç∑ÁßØÂÆûÁé∞ÁöÑÔºåÂÖ∑‰ΩìÁöÑÂΩ¢Áä∂ÂèòÂåñÊ≥®Èáä‰∏≠‰πüÁªôÂá∫‰∫Ü„ÄÇ</p>
<blockquote>
<p>ÊÄé‰πàÁîüÊàêÊ≥®ÈáäÔºü</p>
<p>È¶ñÂÖàÊää‰ª£Á†ÅÁ≤òÁªô gptÔºåÁÑ∂ÂêéÔºåË∑üÂÆÉËØ¥Ôºö<code>‰∏∫ÊØèË°å‰ª£Á†Å Ê∑ªÂä† ‰∏§Ë°åÊ≥®ÈáäÔºå‰∏ÄË°åËØ¥ÊòéËøôË°å‰ª£Á†ÅÁöÑÁõÆÁöÑÔºå‰∏ÄË°åËØ¥Êòé ÂΩ¢Áä∂ÁöÑÂèòÂåñÂíåÊìç‰Ωú ÂΩ¢Áä∂-&gt;Êìç‰Ωú-&gt;ÂΩ¢Áä∂ÁöÑÊ†ºÂºèÔºåÊìç‰ΩúÁöÑÊ†ºÂºèÁ±ª‰ºº DecoderLayer.forward ÊòæÁ§∫Âá∫Ë∞ÉÁî®ÁöÑ‰ªÄ‰πàÁ±ªÂêç.ÊñπÊ≥ï</code></p>
</blockquote>
<p>üîµ Êé•‰∏ãÊù•Áúã ‰ΩçÁΩÆÁºñÁ†Å Positional EmbeddingÔºåÁî±‰∫éËøôÈáåÊ≤°ÊúâÁî®ÔºåÂ∞±‰∏çËØ¥‰∫Ü„ÄÇ</p>
<p>üîµ ÊúÄÂêéÔºåÊó∂Èó¥Êà≥ÁºñÁ†ÅÔºå</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320145727249.png"><img alt="image-20250320145727249" src="../images/image-20250320145727249.png"/></a></p>
<p>Ê≥®ÊÑèËøôÈáåÁöÑÊó∂Èó¥Êà≥ÁºñÁ†ÅÊòØÊúâ‰∏Ä‰∏™Âà§Êñ≠ÁöÑÔºåÁªèËøáË∞ÉËØïÔºåÊàë‰ª¨ËøôÈáåË∞ÉÁî®ÁöÑÊòØ <code>TimeFeatureEmbedding</code> Á±ª„ÄÇ</p>
<p>‰πüÂ∞±ÊòØËØ¥‰ªÄ‰πàÊÑèÊÄùÔºåËøô‰∏™ÂõæÁîªÁöÑÊúâÈóÆÈ¢òÔºå‰∏çËøáÊÑèÊÄù‰πüÊòØÂØπÁöÑÔºåÂ∞±‰∏çÊ∑±Á©∂‰∫Ü„ÄÇ</p>
<p>Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Ë∑≥Âà∞ <code>TimeFeatureEmbedding</code> Ëøô‰∏™Á±ªÁöÑÂÆö‰πâ„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320150012753.png"><img alt="image-20250320150012753" src="../images/image-20250320150012753.png"/></a> </p>
<p>Â∞±ÊòØÈÄöËøá‰∏Ä‰∏™Á∫øÊÄßÂ±ÇÔºåÂ∞Ü Êó∂Èó¥Êà≥ÁâπÂæÅÂµåÂÖ•Âà∞ÊåáÂÆöÁª¥Â∫¶„ÄÇ</p>
<p>È¶ñÂÖàÔºåÂµåÂÖ•Âà∞ÊåáÂÆöÁª¥Â∫¶ÊòØÂõ†‰∏∫È´òÁª¥ÂêëÈáèË°®Á§∫ÁâπÂæÅÊõ¥Á≤æÁªÜ„ÄÇ</p>
<p>ÂÖ∂Ê¨°ÔºåÊàë‰ª¨ËøôÈáå‰ΩøÁî®ÁöÑÊòØÁñæÁóÖÊï∞ÊçÆÈõÜÔºåÊòØÂ∞èÊó∂ÁöÑÔºåÊâÄ‰ª•Áª¥Â∫¶ 4ÔºåË°®Á§∫ÁöÑÁöÑÊòØÔºåÂ∞èÊó∂-Â§©ÔºåÂ§©-Âë®ÔºåÂ§©-ÊúàÔºåÂ§©-Âπ¥„ÄÇËøô‰∏ÄÈÉ®ÂàÜ‰πüËØ¥ËøáÂæàÂ§öÊ¨°‰∫ÜÔºåÂÜçËØ¥‰∏ÄÊ¨°ÔºåÂä†Ê∑±Âç∞Ë±°„ÄÇ</p>
<p>ÂÖ∑‰ΩìÊù•ËØ¥ËæìÂÖ•ÁöÑ <code>x_mark.shape=32,36,4 ‚Üí nn.Linear ‚Üí 32,36,512</code></p>
<p>Êé•‰∏ãÊù•ÔºåÊÄªÁªì‰∏Ä‰∏ãËøôÈáåÁöÑÂµåÂÖ•„ÄÇÈ¶ñÂÖà Êú¨ÊñáÁî®Âà∞ÁöÑÊâÄÊúâÂµåÂÖ•ÈÉΩÂÆö‰πâÂú®‰∫Ü  <code>Embed.py</code>Êñá‰ª∂‰∏≠</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320150552474.png"><img alt="image-20250320150552474" src="../images/image-20250320150552474.png"/></a></p>
<p>ËÄåËøô‰∏™Êñá‰ª∂‰∏≠ÔºåÂèàÂÆö‰πâ‰∫ÜÊâÄÊúâÁöÑÂµåÂÖ•Á±ªÔºåÂèàÊúâ 8 ‰∏™„ÄÇ</p>
<blockquote>
<p>È¢òÂ§ñËØùÔºåËøô‰∏™ÊÄé‰πàÁúãÔºåÊòØ vscode ÁöÑÂ§ßÁ∫≤ËßÜÂõæÔºåÊâæÂá∫Êù•ÔºåÂ∞±ËÉΩÁúãÂà∞‰∫Ü</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320150811010.png"><img alt="image-20250320150811010" src="../images/image-20250320150811010.png"/></a></p>
<p>Â§ßÁ∫≤ËßÜÂõæ‰∏≠ÔºåÁ´ãÊñπ‰ΩìË°®Á§∫ÂÆö‰πâÁöÑÂáΩÊï∞ÔºåÂ∞èÊ†ëÊùàÁöÑ‰∏úË•øÊòØÁ±ªÔºåÁ±ª‰∏≠ÊúâÂ∞èÁ´ãÊñπ‰ΩìÔºåÊòØÁ±ª‰∏≠ÂÆö‰πâÁöÑÂáΩÊï∞ÔºåÁ±ª‰∏≠ÂÆö‰πâÁöÑÂáΩÊï∞Ôºå‰πüÂ∞±ÊòØÂ∞èÁ´ãÊñπ‰Ωì‰∏≠ÔºåÊäòÂè†ÁöÑÈÉ®ÂàÜÊòØ ‰ΩøÁî®Ëøô‰∏™ÂáΩÊï∞ÊàñËÄÖÁ±ªÊâÄÈúÄË¶ÅÁöÑÂàùÂßãÂåñÂèÇÊï∞„ÄÇÊñπÊã¨Âè∑+Â∞èÁ´ãÊñπ‰ΩìÂåÖÊã¨ÁöÑÈÉ®ÂàÜÊòØ Á±ª‰∏≠Ë∞ÉÁî®ÁöÑÁ±ªÁöÑÂØπË±°ÂêçÔºåÊØîÂ¶ÇËøôÈáåÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320151133019.png"><img alt="image-20250320151133019" src="../images/image-20250320151133019.png"/></a></p>
<p>‰ª•Ëøô‰∏™ TemporalEmbedding Á±ª‰∏∫‰æãÔºå Ëøô‰∏™TemporalEmbedding Á±ª‰∏≠Êúâ‰∏§‰∏™ÊñπÊ≥ïÊñπÊ≥ïÔºåÂàÜÂà´ÊòØ init Âíå forward„ÄÇ</p>
<p>init ÊäòÂè†ÁöÑÈÉ®ÂàÜÊòØ ÂàùÂßãÂåñËøô‰∏™Á±ªÊâÄÈúÄË¶ÅÁöÑÂèÇÊï∞Ôºå forward ÊäòÂè†ÁöÑÈÉ®ÂàÜÊòØË∞ÉÁî®Ëøô‰∏™Êó∂ÊâÄÈúÄË¶ÅÁöÑÂèÇÊï∞ÔºåÂÖ∂‰∏≠ init ÈÉ®ÂàÜËøòÂÆû‰æãÂåñ‰∫Ü 5 ‰∏™ÂØπË±°ÔºåÂØπË±°ÂêçÂàÜÂà´ÊòØ mintue_embed„ÄÅhour_embed„ÄÅweekday_embed„ÄÅday_embed„ÄÅmonth_embedÔºå‰ΩÜÊòØËøôÈáåÂÖ∑‰ΩìÂÆû‰æãÂåñÁöÑÂì™‰∏™Á±ª„ÄÇËøôÈáåÊòØÊ≤°ÊúâÊòæÁ§∫ÁöÑÔºåÂæóÁÇπËøõÂéªËá™Â∑±ÁúãÔºåÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™ÂØπË±°ÂÖ∂ÂÆûÈÉΩÊòØÂÆû‰æãÂåñÁöÑEmbed Ëøô‰∏™Á±ªÔºåÂæàÊòéÊòæÊòØ‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÔºåÊÉ≥ÁúãËøòÂæóÊ≠•ËøõÁúãÂÖ∑‰ΩìÂÆû‰æãÂåñÁöÑÂì™‰∏™Á±ª„ÄÇ</p>
</blockquote>
<p>‰ª•‰∏äÂÆåÊàê‰∫Ü Encoder Input ÁöÑ Embedding ÈÉ®ÂàÜÔºåÂàÜÂà´ËøõË°å‰∫Ü token Embedding Âíå TemporaryEmbeddingÊù•ÂØπÂéÜÂè≤Êó∂Èó¥Ê≠•ÁâπÂæÅËøõË°åÂµåÂÖ•ÂíåÊó∂Èó¥ÁâπÂæÅËøõË°åÂµåÂÖ•„ÄÇ</p>
<p>Ê±áÊÄªËøôÈáåÁöÑÁª¥Â∫¶ÂΩ¢Áä∂ÂèòÂåñÔºö</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a><a href="#__codelineno-34-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># x [B, L, D] ‚Üí permute ‚Üí [B, D, L] ‚Üí Âç∑ÁßØ ‚Üí [B, d_model, L] ‚Üí transpose ‚Üí [B, L, d_model]</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a><a href="#__codelineno-34-2"><span class="linenos" data-linenos="2 "></span></a><span class="c1"># x_mark [B, L, d_inp] ‚Üí Á∫øÊÄßÂ±ÇÂèòÊç¢(Êó∂Èó¥ÁâπÂæÅÊï¥‰ΩìÊò†Â∞Ñ) ‚Üí [B, L, d_model]</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a><a href="#__codelineno-34-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># [B, L, d_model] + [B, L, d_model] ‚Üí [B, L, d_model]</span>
</span></code></pre></div>
<p><strong>Êé•‰∏ãÊù•ÊÉ≥ÁªôÂ§ßÂÆ∂ËØ¥ÁöÑÊòØÔºå 1D Âç∑ÁßØÊÄé‰πàËøõË°åÁöÑ tokenEmbeddingÔºö</strong> </p>
<p>Â∞èÂ∞èÁöÑÁÇπÔºåÂ∞èÂ∞èÁöÑÊ≥®ÊÑè„ÄÇ</p>
<p>Êé•Êî∂ÁöÑÊ†áÂáÜËæìÂÖ•ÊòØ BLD</p>
<ul>
<li>È¶ñÂÖàËøõË°åÁöÑÊòØ permuteÔºåÂ∞ÜÊÉ≥Ë¶ÅÂµåÂÖ•ÁöÑÁª¥Â∫¶<code>D</code> ÁßªÂà∞‰∏≠Èó¥ÔºåÁÑ∂ÂêéËøõË°å 1D Âç∑ÁßØÔºåÂµåÂÖ•Âà∞ <code>d_model</code>  Ôºà <code>Embedding dim</code>ÔºâÔºåÂØπÂ∫îÂà∞ 1D Âç∑ÁßØ‰∏≠ÔºåÂ∞±ÊòØËæìÂÖ•ÈÄöÈÅìÊòØ DÔºåËæìÂá∫ÈÄöÈÅìÊòØ <code>d_model</code></li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320152707837.png"><img alt="image-20250320152707837" src="../images/image-20250320152707837.png"/></a></p>
<ul>
<li>‰∏∫‰ªÄ‰πàËøô‰πàÂÅöÔºüÂõ†‰∏∫Âç∑ÁßØÊúÄÂºÄÂßã‰∏ªË¶ÅÁî®‰∫éÂõæÂÉèÔºåÂõæÂÉèÁöÑÊ†áÂáÜÊ†ºÂºèÊòØ BCHWÔºåÂõæÂÉè‰∏≠ÁöÑ HW Â∞±Ë°®Á§∫ÂõæÂÉèÁöÑÁâπÂæÅÔºåÂè™‰∏çËøáÊòØÁî® 2DÁöÑÁü©Èòµ Ë°®Á§∫ÁöÑÔºåËÄå‰∏îËøô‰∏™ 2D Áü©Èòµ‰øùÂ≠ò‰∫Ü‰ΩçÁΩÆ‰ø°ÊÅØÔºå‰∏çËÉΩÈöèÊÑèÂ±ïÂπ≥„ÄÇÈÇ£Ê≠§Êó∂ÔºåC ‰πüÂ∞±ÂèØ‰ª•ÁêÜËß£‰∏∫ÊØè‰∏™ÂÉèÁ¥†ÁöÑÁâπÂæÅÊï∞„ÄÇÊØîÂ¶ÇÊØè‰∏™ÂÉèÁ¥†Áî®ÂΩ©Ëâ≤ÁöÑ RGB ‰∏â‰∏™ÂÖÉÁ¥†Ë°®Á§∫„ÄÇ</li>
<li>ÊâÄ‰ª•Êàë‰ª¨ËøôÈáåÁöÑÊó∂Èó¥Â∫èÂàó‰∏≠ÁöÑ 1D Âç∑ÁßØÔºå‰πü‰ªøÁÖßÂõæÂÉè‰∏≠Âç∑ÁßØÁöÑÂÆö‰πâÔºåÊØè‰∏™Êó∂Èó¥Ê≠•ÁöÑÁâπÂæÅÊï∞ÊîæÂà∞‰∏≠Èó¥ÔºåË°®Á§∫ËæìÂÖ•ÈÄöÈÅìÊï∞ÔºåÁÑ∂ÂêéÂ∞ÜÊØè‰∏™Êó∂Èó¥Ê≠•ÁöÑÁâπÂæÅÔºåÊò†Â∞ÑÂà∞ËæìÂá∫Áª¥Â∫¶Â§ßÂ∞èÔºåËøôÈáåË°®Á§∫‰∏∫ <code>Embedding dim</code>Ôºå‰πüÂ∞±ÊòØ <code>d_model</code>„ÄÇ</li>
</ul>
<p>Áî®‰∏ÄÂº†ÂõæÊù•Ë°®Á§∫Ôºå(ËøôÈáåÂÖ∂ÂÆûÂæàÂÉè SegRNN ÁöÑËßÜËßíËΩ¨Êç¢)Ôºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320154515642.png"><img alt="image-20250320154515642" src="../images/image-20250320154515642.png"/></a></p>
<p>ËÄå Êó∂Èó¥Êà≥ÁâπÂæÅÁöÑ nn.LinearÂ∞±ÊòØÁõ¥Êé•ÂØπÊúÄÂêé‰∏Ä‰∏™Áª¥Â∫¶ËøõË°åÂµåÂÖ•‰∫Ü</p>
<p><code>x_mark [B, L, d_inp] ‚Üí Á∫øÊÄßÂ±ÇÂèòÊç¢(Êó∂Èó¥ÁâπÂæÅÊï¥‰ΩìÊò†Â∞Ñ) ‚Üí [B, L, d_model]</code></p>
<p>pytorch‰∏≠Â∏∏Áî®ÁöÑÊòØÁª¥Â∫¶ÂèòÊç¢ÂáΩÊï∞ permute„ÄÅtranspose„ÄÅview ÈÉΩÊòØÁõ¥Êé•ÂÜôÁª¥Â∫¶ÂèòÊç¢„ÄÇ</p>
<p>Â∏¶ÁùÄËµ∞‰∏ÄÈÅç‰ª£Á†Å„ÄÇ</p>
<h4 id="encoder-forward">Encoder forward<a class="headerlink" href="#encoder-forward" title="Permanent link">¬∂</a></h4>
<p><strong>Ë°å‰∫ÜÔºåÂµåÂÖ•ËÆ≤ÂÆå‰∫ÜÔºåÊé•‰∏ãÊù•ÔºåËøõÂÖ•Ê≠£ÂºèÁöÑ Encoder ÁöÑÈÉ®ÂàÜÁöÑÊï∞ÊçÆÊµÅÂä®„ÄÇ</strong></p>
<p>ÔºàÁªà‰∫éÔºâ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320160444391.png"><img alt="image-20250320160444391" src="../images/image-20250320160444391.png"/></a></p>
<p>‰ªé Autoformer forward ÁöÑ self.encoder ËøõÂÖ•„ÄÇ</p>
<p>Âú®Ê≠•Ëøõ‰πãÂâçÁúã‰∏ÄÁúºÊÄé‰πàÂàùÂßãÂåñÁöÑ„ÄÇÈùûÂ∏∏Â§çÊùÇÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320160615516.png"><img alt="image-20250320160615516" src="../images/image-20250320160615516.png"/></a></p>
<p>Êù•Áõ¥Êé•ÁúãÂõæÂêßÔºåÂÖ∑‰ΩìÊÄé‰πàÂ§çÊùÇ„ÄÇ</p>
<h5 id="_10">Á±ªÂõæ<a class="headerlink" href="#_10" title="Permanent link">¬∂</a></h5>
<pre class="mermaid"><code>classDiagram
    class Model {
        +Encoder encoder
    }

    class Encoder {
        +List~EncoderLayer~ layers
        +my_Layernorm norm_layer
        +forward(x, attn_mask)
    }

    class EncoderLayer {
        +AutoCorrelationLayer attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +Dropout dropout
        +activation
        +forward(x, attn_mask)
    }

    class AutoCorrelationLayer {
        +AutoCorrelation attention
        +Linear query_projection
        +Linear key_projection
        +Linear value_projection
        +Linear out_projection
        +forward(queries, keys, values, attn_mask)
    }

    class AutoCorrelation {
        +bool mask_flag
        +int factor
        +float scale
        +Dropout dropout
        +bool output_attention
        +time_delay_agg_training(values, corr)
        +time_delay_agg_inference(values, corr)
        +forward(queries, keys, values, attn_mask)
    }

    Model --&gt; Encoder
    Encoder --&gt; EncoderLayer
    EncoderLayer --&gt; AutoCorrelationLayer
    EncoderLayer --&gt; Conv1d
    EncoderLayer --&gt; series_decomp
    AutoCorrelationLayer --&gt; AutoCorrelation
</code></pre>
<p>È¶ñÂÖàÂõæ‰∏≠Ê∏ÖÊ•öÁöÑÂ±ïÁ§∫‰∫ÜÔºåÂ∞±ÂõæÊù•ËØ¥Ôºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320161544932.png"><img alt="image-20250320161544932" src="../images/image-20250320161544932.png"/></a> </p>
<p>ÈÄöËøá Autoformer ÂÆö‰πâÁöÑ model ‰∏≠ÔºåÂÆö‰πâ‰∫ÜËøô‰∏™ Encoder Á±ªÔºå‰º†Áªô‰∫Ü self.encoder „ÄÇ</p>
<p>Êé•ÁùÄÁúãËøô‰∏™ Encoder Á±ªÁöÑÂÆö‰πâÔºåËøô‰∏™ Encoder ÁöÑÂàùÂßãÂåñË∞ÉÁî®‰∫ÜEncoderLayerÁ±ªÔºå‰º†Áªô‰∫Ü layersÔºàÂ∞±ÊòØEncoderLayerÁ±ªÁöÑÂÆû‰æãÂåñÂØπË±°Ôºâ„ÄÇ</p>
<p>ÂØπÂ∫îÂà∞‰ª£Á†ÅÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320161505407.png"><img alt="image-20250320161505407" src="../images/image-20250320161505407.png"/></a></p>
<p>Êé•ÁùÄÔºåEncoder Á±ªË∞ÉÁî®‰∫Ü EncoderLayer Á±ªÔºåÈÇ£Êé•‰∏ãÊù•Â∞±Áúã EncoderLayer ÁöÑÂÆö‰πâÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320161704846.png"><img alt="image-20250320161704846" src="../images/image-20250320161704846.png"/></a></p>
<p>ÁúãÂõæ‰ª•Âèä‰ª£Á†ÅÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320162010963.png"><img alt="image-20250320162010963" src="../images/image-20250320162010963.png"/></a></p>
<p>ÔºàÁúã‰ª£Á†ÅÔºâÔºöÁ∫¢Ê°ÜÊòØ‰∏äÈù¢ËÆ≤ÁöÑÔºå<code>Encoder</code> ÁöÑÂàùÂßãÂåñÈúÄË¶ÅË∞ÉÁî® <code>EncoderLayer</code> Á±ª</p>
<p>Á¨¨‰∏Ä‰∏™Á∫¢Ê°ÜË°®Á§∫Ôºå<code>EncoderLayer</code> ‰∏≠ÁöÑ <code>init</code> ÂàùÂßãÂåñ‰∏≠ÂèàË∞ÉÁî®‰∫Ü <code>AutoCorrelationLayer</code> Á±ªÔºåÂπ∂‰∏î‰º†ÂÖ•‰∫Ü  <code>EncoderLayer</code> ÂàùÂßãÂåñËøáÁ®ã‰∏≠ÊâÄÈúÄË¶ÅÁöÑÂèÇÊï∞ ÔºåÂéª <code>EncoderLayer</code> Ëøô‰∏™Á±ª„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320162631428.png"><img alt="image-20250320162631428" src="../images/image-20250320162631428.png"/></a></p>
<p>ÁªìÂêà Âõæ Âíå ‰ª£Á†ÅÔºåËøôÈÉ®ÂàÜÂ∞±ÂèØ‰ª•ÁêÜËß£‰∫Ü„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320163036643.png"><img alt="image-20250320163036643" src="../images/image-20250320163036643.png"/></a> </p>
<p>‰∏ªË¶ÅÁöÑÂ§çÊùÇÁÇπÂ∞±ÊòØÂàùÂßãÂåñ‰∏Ä‰∏™Á±ªÁöÑÂêåÊó∂ÂèàÈúÄË¶ÅÂàùÂßãÂåñÂè¶‰∏Ä‰∏™Á±ªÔºåÂàùÂßãÂåñÂè¶‰∏Ä‰∏™Á±ªÂèàÈúÄË¶ÅÂàùÂßãÂåñÁ±ª„ÄÇÂ•ΩÂ•ΩÁúãÁúãÊòØÂèØ‰ª•ÁêÜËß£ÁöÑ„ÄÇ</p>
<p>ÂêéÈù¢ËøòÊúâ AutoCorrelationLayer ÁöÑÂàùÂßãÂåñÔºåÂèàË¶ÅË∞ÉÁî® AutoCorrelation Á±ª</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320163322154.png"><img alt="image-20250320163322154" src="../images/image-20250320163322154.png"/></a></p>
<p>ÁêÜËß£ÁöÑÈÄªËæëÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<p>È¶ñÂÖà‰ª£Á†Å Autoformer forward EncoderÁöÑÂàùÂßãÂåñËøáÁ®ã‰∏≠ÔºåÁªôÂá∫‰∫ÜÊØè‰∏™Á±ªÂàùÂßãÂåñÊâÄÈúÄË¶ÅÁöÑ‰º†ÂÖ•ÂèÇÊï∞</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320163438704.png"><img alt="image-20250320163438704" src="../images/image-20250320163438704.png"/></a></p>
<p>ËÄå‰∏äÈù¢ mermaid ÁîªÁöÑÂõæÔºåÂ±ïÁ§∫‰∫ÜÊØè‰∏™Á±ª‰∏≠ init ‰∏≠ÂÖ∑‰ΩìË∞ÉÁî®ÁöÑÁ±ªÂíåÂÆû‰æãÂåñÁöÑÂØπË±°Âêç„ÄÇ‰ª•ÂèäÈô§‰∫Ü init ÊñπÊ≥ïÂ§ñÔºåËøòÊúâÁ±ª‰∏≠ÂèØ‰ª•Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÔºåÊØîÂ¶Ç AutoCorrelation‰∏≠ÔºåÈô§‰∫Ü init„ÄÅforward ‰ª•Â§ñÔºåËøòÊúâ <code>time_delay_agg_training</code>  Âíå <code>time_delay_agg_inference</code> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320163849697.png"><img alt="image-20250320163849697" src="../images/image-20250320163849697.png"/></a></p>
<p>ËøôÈÉ®ÂàÜË∞ÉÁî®ÂÖ≥Á≥ªÂ∏åÊúõÊàëËÆ≤ÊòéÁôΩ‰∫ÜÔºåÂÜçÁî®‰∏ÄÂº†ÂõæËØ¥Êòé‰∏Ä‰∏ãÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="https://i-blog.csdnimg.cn/direct/f98d7865ca134201a76ece97f66b7e51.png"><img alt="img" src="https://i-blog.csdnimg.cn/direct/f98d7865ca134201a76ece97f66b7e51.png"/></a></p>
<p>Â∞±ÊòØËØ¥Âú®Êàë‰ª¨Âú® Encoder forward ‰∏≠‰º†ÂÖ•Âà∞ÁöÑxÔºå‰ºö‰º†ÂÖ•Âà∞ EncoderLayer ‰∏≠ÁöÑ forward ‰∏≠ËøõË°åÂ§ÑÁêÜÔºåËÄå   EncoderLayer forward ‰∏≠ÂèàË∞ÉÁî®‰∫Ü AutoCorrelation Layer ‰∏≠ÁöÑ forwardÔºåÁÑ∂ÂêéÂë¢ÔºåAutoCorrelation Layer ‰∏≠ÁöÑ forwardÂèàË∞ÉÁî®‰∫Ü AutoCorrelationÁöÑ forwardÔºåÊúÄÂêéAutoCorrelationÂèàË∞ÉÁî®‰∫ÜËá™Â∑± AutoCorrelation time delay agg tranning ÊàñËÄÖ inference„ÄÇ</p>
<p>ÔºàË∞ÅÊáÇÂïä„ÄÇÂΩìÂàùÈÄêÊ≠•Ë∞ÉËØïÁöÑÊó∂ÂÄôÔºåÊ≠•Ëøõ‰∏Ä‰∏™ÂèàÊ≠•Ëøõ‰∏Ä‰∏™ÔºåÈÉΩÊâæ‰∏çÂà∞Â§¥ T_TÔºâÔºå‰∏∫‰ªÄ‰πàËØ¥ËøôÈÉ®ÂàÜË∞ÉÁî®‰∏çÂ•ΩÁêÜËß£ÔºåÊòØÂõ†‰∏∫ÊåâÁêÜËØ¥Ôºåforward ‰∏≠ÊúâË∞ÉÁî®ÔºåÂéª init ‰∏≠Êâæ„ÄÇ</p>
<p>ÂÖ∑‰ΩìÊù•ËØ¥ÔºåAutoformer ÁöÑ forward ‰∏≠Ë∞ÉÁî®‰∫Ü <code>self.encoder</code> ÔºåÂú® init ‰∏≠ÊâæÂà∞‰∫Ü</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320164728075.png"><img alt="image-20250320164728075" src="../images/image-20250320164728075.png"/></a></p>
<p>ÈÇ£Êåâ‰Ωè commandÔºåË∑≥ËøõEncoder ÁöÑÂÆö‰πâÔºå‰∏çÁÆ°ÊòØ init ËøòÊòØ forward ‰∏≠ÈÉΩÊ≤°ÊúâÊòæÁ§∫ÁöÑËØ¥Êòé attn_layerÊòØË∞ÉÁî®ÁöÑ‰ªÄ‰πà„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320164939255.png"><img alt="image-20250320164939255" src="../images/image-20250320164939255.png"/></a></p>
<p>ÊâÄ‰ª•ÊúÄÂºÄÂßãÊ≠•ËøõËøôÈáåÁöÑÊó∂ÂÄôÔºåÂ∞±ÂæàÊôï„ÄÇÂÖ∂ÂÆûËøôÈáåÊâÄÊúâÁöÑÂàùÂßãÂåñ‰ª•ÂèäË∞ÉÁî®ÈÉΩÂú®ÊúÄÊúÄÂºÄÂßãÁöÑ  Autoformer ÁöÑ self.encoderÁöÑÂàùÂßãÂåñ‰∏≠Áªô‰∫Ü„ÄÇÂú®ÂêéÈù¢ÂÆö‰πâÁöÑÁ±ª‰∏≠ÔºåÊåâ‰Ωè command ‰∏çËÉΩË∑≥Âà∞Á±ªÁöÑÂÆö‰πâ„ÄÇÂæó‰ªéÂ§¥ÂºÄÂßã„ÄÇÂΩìÁÑ∂‰∫ÜÔºåÊ≠•ËøõÂ∞±‰∏çÁî®ÁÆ°Ëøô‰∫õ‰∫Ü„ÄÇËá™Â∑±Â∞±Ë∑≥Êù•Ë∑≥Âéª‰∫Ü„ÄÇ</p>
<p><strong>Â•Ω‰∫Ü ‰ª•‰∏äÂÆåÊàê‰∫Ü self.encoderÁöÑÂàùÂßãÂåñÔºåÂàöÂàöÊòØÂØπ ÁºñÁ†ÅÂô®ÊâÄÊé•Êî∂ÁöÑËæìÂÖ•ËøõË°åÂµåÂÖ•ÔºåËøôÈáåÊòØÊ®°ÂûãÁöÑÂÆö‰πâ</strong></p>
<p>Âü∫‰∫é‰ª•‰∏äÁöÑËÆ§ËØÜÔºåÊé•‰∏ãÊù•ËøõÂÖ• forward ‰∏≠ÔºåÁúãÊï∞ÊçÆÁöÑÊµÅÂä®ËøáÁ®ã„ÄÇ</p>
<h4 id="encoderlayer">EncoderLayer<a class="headerlink" href="#encoderlayer" title="Permanent link">¬∂</a></h4>
<p>È¶ñÂÖàÔºå‰ªé ‚¨áÔ∏è ÂºÄÂßãÊ≠•Ëøõ„ÄÇ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><a href="#__codelineno-35-1"><span class="linenos" data-linenos="1 "></span></a> <span class="n">enc_out</span><span class="p">,</span> <span class="n">attns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">enc_out</span><span class="p">,</span> <span class="n">attn_mask</span><span class="o">=</span><span class="n">enc_self_mask</span><span class="p">)</span>
</span></code></pre></div>
<p>Â¶ÇÊàë‰ª¨ÊâÄÊñôÔºåÊ≠•ËøõÂà∞‰∫Ü Encoder Á±ªÁöÑ forwardÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320165637015.png"><img alt="image-20250320165637015" src="../images/image-20250320165637015.png"/></a></p>
<p>ÁªßÁª≠Ê≠•ËøõÔºå‰∏ÄÊ≠•Ê≠•ÊâßË°åÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320165724095.png"><img alt="image-20250320165724095" src="../images/image-20250320165724095.png"/></a></p>
<p>Êù°‰ª∂Âà§Êñ≠ÊâßË°å elseÔºåË∑≥Âà∞</p>
<blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ÊØè‰∏ÄÊ≠•ÁöÑÁé∞ÂÆûÊÑè‰πâÂú®ÂÅö‰ªÄ‰πà</li>
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ÂΩ¢Áä∂ÂèòÂåñ„ÄÅË∞ÉÁî®ÂÖ≥Á≥ª</li>
</ul>
</blockquote>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320211248706.png"><img alt="image-20250320211248706" src="../images/image-20250320211248706.png"/></a></p>
<p>EncoderLayer ÁöÑ forward ‰∏≠Ë∞ÉÁî®‰∫ÜËá™Áõ∏ÂÖ≥Êú∫Âà∂ÔºàËá™Áõ∏ÂÖ≥Êú∫Âà∂=AutoCorrelation Layer + AutoCorrelationÔºâÔºåËøôÊòØÊú¨ÊñáÁöÑÂàõÊñ∞ÁÇπÔºåÂêéÈù¢ÂÜçËØ¥„ÄÇËÆ∫Êñá‰∏≠‰πüÊòØËØ¥‰∫ÜÂêéÈù¢ÂÜçËØ¥Ôºå‰ΩúËÄÖËÆæËÆ°‰∫ÜËøô‰∏™Ê®°ÂùóÂ∞±Â∞±ÊòØ‰ª£Êõø‰∫ÜÂéüÂßã Transformer ÁöÑ self attention ÁöÑËÆ°ÁÆóÔºå‰Ω†ÁúãËøô‰∏™ÂëΩÂêçÔºåËôΩÁÑ∂Ë∞ÉÁî®ÁöÑÊòØAutoCorrelation LayerÔºå‰ΩÜÊòØÂèòÈáèÂëΩÂêçÊó∂Ôºå‰ªçÁÑ∂ÊòØ self.attention ‰πüÂ∞±ÂèØ‰ª•ÁêÜËß£‰∏∫‰ΩúËÄÖÊòØÊîπËøõ‰∫ÜÂéüÂßã Transformer ‰∏≠ÁöÑËá™Ê≥®ÊÑèÂäõÊú∫Âà∂„ÄÇ</p>
<p>Âõ†Ê≠§Êàë‰ª¨ËøôÈáåÂú®Ë∞ÉËØï Encoder ÁöÑÂÖ∑‰ΩìËøáÁ®ãÊó∂ÔºåÊöÇÊó∂‰∏çÊ≠•ËøõÂà∞ self.attentionÁöÑÂÖ∑‰ΩìÁöÑÊâßË°åËøáÁ®ã‰∏≠„ÄÇ</p>
<p>Âçï‰∏™ Encoder ÁöÑÊâßË°åÂ∞±ÊòØ ÊâßË°å‰∏ÄÊ¨° EncoderLayerÔºåÊúâÂá†‰∏™ EncoderÂ∞±ÊâßË°åÂá†Ê¨° EncoderLayer„ÄÇ</p>
<p>Áé∞Âú®ËØ¥ÊòéËøô‰∏™ EncoderLayer ÁöÑÊâßË°åËøáÁ®ãÔºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a><a href="#__codelineno-36-1"><span class="linenos" data-linenos="1 "></span></a>def forward(self, x, attn_mask=None)
</span></code></pre></div>
<p>È¶ñÂÖà EncoderLayer Êé•Êî∂ÁöÑËæìÂÖ•ÊòØ xÔºåmask ÊòØÂèØÈÄâÂèÇÊï∞„ÄÇ</p>
<p>ËæìÂÖ•<code>x</code>ÂΩ¢Áä∂‰∏∫[B, L, d_model]</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a><a href="#__codelineno-37-1"><span class="linenos" data-linenos="1 "></span></a>       new_x, attn = self.attention(
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a><a href="#__codelineno-37-2"><span class="linenos" data-linenos="2 "></span></a>            x, x, x,
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a><a href="#__codelineno-37-3"><span class="linenos" data-linenos="3 "></span></a>            attn_mask=attn_mask
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a><a href="#__codelineno-37-4"><span class="linenos" data-linenos="4 "></span></a>        )
</span></code></pre></div>
<p>Êé•‰∏ãÊù•ËøõË°å Encoder ÈÉ®ÂàÜÁöÑËá™Ê≥®ÊÑèÂäõÊú∫Âà∂ÁöÑËÆ°ÁÆóÔºåËøôÈáåÂÆûÈôÖË∞ÉÁî®ÁöÑÊòØ‰ΩúËÄÖÁöÑÂàõÊñ∞Ê®°ÂùóÔºåËá™Áõ∏ÂÖ≥Â±Ç„ÄÇÂêéÈù¢‰∏çÂÜçÂå∫ÂàÜÂè´Ê≥ï„ÄÇ</p>
<p>Ëá™Ê≥®ÊÑèÂäõÊú∫Âà∂==Êé•Êî∂==ÁöÑÂèÇÊï∞ qkvÈÉΩÁ≠â‰∫é xÔºåÂõ†‰∏∫ÊòØËá™Ê≥®ÊÑèÂäõÊú∫Âà∂ÔºåÂΩ¢Áä∂ÊòØ‰∏ÄÊ†∑ÁöÑ [B, L, d_model]„ÄÇ</p>
<p>ËøôÈáåÁöÑ <code>attn_mask=None</code></p>
<p>Ëá™Ê≥®ÊÑèÂäõÊú∫Âà∂ËøîÂõûÁöÑ ÂèòÈáèÊúâ <code>new_x</code>, <code>attn</code>ÔºåÂΩ¢Áä∂ÂàÜÂà´ÊòØ</p>
<p>new_x<code>[B, L, d_model]</code>ÂíåÊ≥®ÊÑèÂäõÊùÉÈáçattn<code>[B, n_heads, L, L]</code></p>
<p>ËøôÈáåÁöÑ new_x ÊÑèÊÄùÊòØ Êúâ‰∫ÜÂØπÂÖ∂‰ªñÊó∂Èó¥Ê≠•ÊùÉÈáçÁöÑ xÔºåattn Â≠òÁöÑÊòØ‰∏§‰∏§Êó∂Èó¥Ê≠•‰πãÈó¥ÁöÑÊ≥®ÊÑèÂäõÂæóÂàÜ„ÄÇÔºàÂΩìÁÑ∂‰∫ÜÔºåËøôÊòØÂéüÂßã Ëá™Ê≥®ÊÑèÂäõÊú∫Âà∂ <span class="arithmatex">\(softmax(\frac{QK^T}{\sqrt{d_k}})V\)</span> ÁöÑËÆ°ÁÆóÔºåËÆ∫ÊñáÂÆûÁé∞ÁöÑËøôÈáåÈù¢ÊòØÂï•ÂÜçËØ¥Ôºâ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><a href="#__codelineno-38-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span>
</span></code></pre></div>
<p>Êé•‰∏ãÊù•ÔºåÂçï‰∏™ Encoder ÁöÑËæìÂá∫ ÊòØ <code>dropout(new_x)</code> ÔºåÂÜçÁªèËøáÊÆãÂ∑ÆËøûÊé•„ÄÇËøôÈáåÂ∞±ÊòØ<span id="ÂéüÂßã Transformer Êû∂ÊûÑ">ÂéüÂßã Transformer Êû∂ÊûÑ</span>„ÄêËßÅ<a href="#ÈôÑÂΩï">ÈôÑÂΩï</a>„Äë‰∏≠ÁöÑ‰∏úË•øÔºå‰πüÂ∞±ÊòØÁªèËøáËá™Ê≥®ÊÑèÂäõÊú∫Âà∂‰ª•ÂêéËøõË°å ÊÆãÂ∑ÆËøûÊé•ÂíåÂΩí‰∏ÄÂåñ„ÄÇ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a><a href="#__codelineno-39-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
<p>Êé•‰∏ãÊù•ÔºåÊòØÂ∫èÂàóÂàÜËß£</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320214539531.png"><img alt="image-20250320214539531" src="../images/image-20250320214539531.png"/></a></p>
<p>Â∫èÂàóÂàÜËß£ÁöÑÁ¨¨‰∏Ä‰∏™ËøîÂõûÂÄºÊòØÂ≠£ËäÇÊàêÂàÜÔºåÁ¨¨‰∫å‰∏™ËøîÂõûÂÄºÊòØ‰ΩøÁî®ÁßªÂä®Âπ≥ÂùáÂæóÂà∞Ë∂ãÂäøÊÄßÊàêÂàÜ</p>
<p>Âú® Encoder ‰∏≠‰ΩøÁî®ÁöÑÂ∫èÂàóÂàÜËß£Êó∂Ôºå‰∏çË¶ÅË∂ãÂäøÊàêÂàÜÔºåÂè™Áïô‰∏ãÂ≠£ËäÇÊàêÂàÜ</p>
<p>Êé•Êî∂ÁöÑÂèÇÊï∞ x ÊòØË¶ÅÂàÜËß£ÁöÑÂéüÂßãÂ∫èÂàóÔºåÂΩ¢Áä∂ÊòØ [B, L, d_model]</p>
<p>ËøîÂõûÁöÑÂèÇÊï∞ x ÊòØÂàÜËß£‰ª•ÂêéÁöÑÂ≠£ËäÇÊàêÂàÜÔºåÂΩ¢Áä∂‰æùÁÑ∂ÊòØ [B, L, d_model]</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320215159566.png"><img alt="image-20250320215159566" src="../images/image-20250320215159566.png"/></a> </p>
<p>ËøôÈÉ®ÂàÜ‰ª£Á†ÅÂ∞±ÊòØÂéüÊñáÂÖ¨Âºè 3 ÁöÑÁ¨¨‰∏ÄË°åÂÖ¨Âºè„ÄÇ</p>
<p>Êää‰ª£Á†ÅË¥¥Âà∞ËøôÈáåÂÜç‰Ωì‰ºö‰∏Ä‰∏ãÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320215324397.png"><img alt="image-20250320215324397" src="../images/image-20250320215324397.png"/></a></p>
<p>ÂØπÁ¨¨ <code>l-1</code> Â±Ç Encoder ÁöÑËæìÂá∫ËøõË°åËá™Áõ∏ÂÖ≥Êú∫Âà∂ÁöÑËÆ°ÁÆóÔºåÂæóÂà∞ÁöÑËæìÂá∫‰∏éÂéüÂßãÁöÑ x ËøõË°åÊÆãÂ∑ÆËøûÊé•ÔºåÊúÄÂêéÂØπÊÆãÂ∑ÆËøûÊé•‰ª•ÂêéÁöÑËæìÂá∫ËøõË°åË∂ãÂäøÂàÜËß£ÔºåÂêåÊó∂Âè™‰øùÁïô Â≠£ËäÇÊàêÂàÜÔºåÂøΩÁï•ÊéâË∂ãÂäøÊàêÂàÜ„ÄÇ</p>
<p><strong>Êé•‰∏ãÊù•ÔºåËøõË°åÂÖ¨Âºè 3 ÁöÑÁ¨¨‰∫åË°åÂÖ¨ÂºèÊâÄÂØπÂ∫îÁöÑ‰ª£Á†ÅËÆ≤Ëß£Ôºö</strong> </p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a><a href="#__codelineno-40-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
</span></code></pre></div>
<p>‰∏ã‰∏ÄÂè•ÔºåÊñ∞Âª∫ x ÁöÑÂâØÊú¨Ôºå‰øùÂ≠òÊàê yÔºåÂêéÈù¢ÈÉΩÂØπ x ÁöÑÂâØÊú¨ ‰πüÂ∞±ÊòØËøô‰∏™ y Êìç‰ΩúÔºåx ÂÖàÊîæÁùÄ‰∏çÁî®ÔºåÂêéÈù¢Áî®‰∫é FFN ‰ª•ÂêéÁöÑ ÊÆãÂ∑ÆËøûÊé•„ÄÇ</p>
<p>ÈÇ£ÂÖ∑‰ΩìËøôÈáåÁöÑ FFN ÊòØÊÄé‰πàÂÅöÁöÑÂë¢Ôºü</p>
<p>ÁúãÂà∞‰ª£Á†Å</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320215804289.png"><img alt="image-20250320215804289" src="../images/image-20250320215804289.png"/></a></p>
<p>‰∏çÁúãdropout ÂíåÊøÄÊ¥ªÂ±ÇÔºåÂõ†‰∏∫Ëøô‰∏§‰∏™Êìç‰ΩúÂπ∂‰∏ç‰ºöÊîπÂèòËæìÂÖ•Âº†ÈáèÁöÑÂΩ¢Áä∂ÔºåÊé•‰∏ãÊù•ÁúãÂà∞FFN ÊòØÁî±‰∏§‰∏™ 1d Âç∑ÁßØ‰πüÂ∞±ÊòØconv1d ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320215914272.png"><img alt="image-20250320215914272" src="../images/image-20250320215914272.png"/></a></p>
<p>Êé•‰∏ãÊù•ÔºåÂÜçÁúã Encoder ÁöÑ init ÈÉ®ÂàÜÔºåËøô‰∏§‰∏™ 1d Âç∑ÁßØÊòØÊÄé‰πàÂÆö‰πâÁöÑÔºåËØ∂ÔºåÂ∞±ÊòØ‰∏Ä‰∏™ÂÖàÂçáÁª¥ÂêéÈôçÁª¥ÁöÑÊìç‰ΩúÔºåÂ∞±ÂÆåÊàê‰∫Ü FFN„ÄÇ</p>
<p>Â∞±ÊòØËØ¥ self.conv1ÊòØÂ∞ÜÂçï‰∏™Êó∂Èó¥Ê≠•ÂµåÂÖ•Áª¥Â∫¶ <code>d_model</code>ÂçáÁª¥Âà∞ <code>d_ff</code>ÔºõÊé•‰∏ãÊù• self.conv2Â∞±ÊòØÂ∞Ü <code>d_ff</code> ÂèàÊÅ¢Â§çÊàêÂéüÂßãÂΩ¢Áä∂ <code>d_model</code>„ÄÇÂ§öËØ¥‰∏ÄÂè•ÔºåÂ•ΩÂÉèÊ≤°ÊÑè‰πâÔºåÂÖ∂ÂÆûÊúâÊÑè‰πâÔºåÁ¨¨‰∫åÊ¨°ÊÅ¢Â§çÁöÑ <code>d_model</code> ÂÖ∂ÂÆûÊòØÁ≤æÁªÜÂåñÁöÑÂ≠¶‰π†‰∫Ü ÁâπÂæÅ‰∏éÁâπÂæÅ‰πãÈó¥ÁöÑÁõ∏ÂÖ≥ÂÖ≥Á≥ªÔºåÂπ∂ËøîÂõûÁªô‰∫Ü <code>d_model</code> ‰∏≠ËøõË°å‰øùÂ≠ò„ÄÇ</p>
<p>ÁúãÂà∞‰ª£Á†ÅÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320220835532.png"><img alt="image-20250320220835532" src="../images/image-20250320220835532.png"/></a></p>
<p>ÂÖ≥‰∫éËøôÈáåÔºåÊàëÊúâ‰ª•‰∏ãÂá†ÁÇπÊÉ≥ËØ¥Ôºö</p>
<p>Á¨¨‰∏ÄÁÇπÔºåÂçáÁª¥ÁöÑÊìç‰ΩúÔºåÁªèËøá conv1d ‰ª•ÂêéÔºåÁõ∏ÂΩì‰∫éËøõË°å‰∫ÜÂÖ®ËøûÊé•Ôºå‰πüÂ∞±ÊòØÁõ∏ÂΩì‰∫énn.LinearÁöÑ‰ΩúÁî®ÔºåÈÇ£ÂÜôËøá‰ª£Á†ÅÁöÑÈÉΩÊòØÂà∞Ôºånn.Linear‰ª•ÂêéËøõË°åÊøÄÊ¥ªÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂ¢ûÂä†Ê®°ÂûãÁöÑÈùûÁ∫øÊÄßË°®ËææËÉΩÂäõÔºåËøôÁÇπÊùéÊ≤êÁöÑ‰π¶‰∏ä‰πüÊèêÂà∞Ëøá„ÄÇËøôÈáåÂ∞±‰ªøÁÖßÁùÄ conv1d ÁöÑËæìÂá∫‰πüÂä†‰∏ä‰∫ÜÊøÄÊ¥ªÂáΩÊï∞„ÄÇÂä†ÁöÑÊâÄÊúâ dropout ÈÉΩÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢ËøáÊãüÂêàÔºåÈöèÊú∫Â§±Ê¥ª‰∏Ä‰∫õËäÇÁÇπ„ÄÇ</p>
<blockquote>
<p>Ê†áÂáÜÂâçÈ¶àÁ•ûÁªèÁΩëÁªúÁöÑËÆæËÆ°Ê®°ÂºèÔºöÁ∫øÊÄßÂèòÊç¢‚ÜíÈùûÁ∫øÊÄßÊøÄÊ¥ª‚ÜíÁ∫øÊÄßÂèòÊç¢Ôºõ</p>
<p>Âú®TransformerÂéüÂßãËÆæËÆ°‰∏≠ÔºåFFNÈÉ®ÂàÜË°®Á§∫‰∏∫Ôºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a><a href="#__codelineno-41-1"><span class="linenos" data-linenos="1 "></span></a>FFN(x) = max(0, xW‚ÇÅ + b‚ÇÅ)W‚ÇÇ + b‚ÇÇ
</span></code></pre></div>
<p>ReLU ÊøÄÊ¥ªÂáΩÊï∞Âíå‰∏§‰∏™ nn.Linear</p>
</blockquote>
<p>Á¨¨‰∫åÁÇπÔºåÂâçÈù¢Â∑≤ÁªèËØ¥ËøáÔºå1d Âç∑ÁßØÂçáÁª¥ÈôçÁª¥ÊåáÁöÑÊòØÈÄöÈÅìÁª¥Â∫¶Ôºå‰πüÂ∞±ÊòØ dim=1ÔºåÊâÄ‰ª•ËøôÈáåËøõË°å 1d Âç∑ÁßØ‰πãÂâç‰πüÊòØËøõË°å‰∫Ü transpose„ÄÇ</p>
<p><del>Á¨¨‰∏âÁÇπÔºå‰∏∫‰ªÄ‰πàËøôÈáåÊòØ conv1dÔºåËÄå‰∏çÊòØ nn.LinearÔºåÂõ†‰∏∫Êó∂Èó¥Â∫èÂàóË¶Å‰øùÊåÅÊó∂Èó¥Ê≠•ÁöÑÂâçÂêéÂÖ≥Á≥ªÔºåÊâÄ‰ª•Áî® conv1dÔºåÁ±ª‰ººÊªëÂä®Á™óÂè£ÔºåÊ≤øÁùÄÊó∂Èó¥Ê≠•ÁöÑÂâçÂêéÈ°∫Â∫èÈÄêÊ≠•ÊªëÂä®ÔºåÊØèÊ¨°ÁßªÂä® stride ‰∏™Ê≠•Èïø„ÄÇ</del> ÔºàÊàëÁêÜËß£ÁöÑ‰∏çÂØπÔºâÂäüËÉΩ‰∏äÂ∞±ÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂè™ÊòØÊï∞ÊçÆÁöÑÁªÑÁªáÂΩ¢Âºè‰∏çÂêåÔºå‰∏çÁî®ÂàªÊÑèÁöÑÂå∫ÂàÜ„ÄÇ</p>
<p>Á¨¨ÂõõÁÇπÔºåËøôÈáåÁöÑ d_ff ÂâçÈ¶àÁ•ûÁªèÁΩëÁªúÁöÑÂµåÂÖ•ÊòØ 2048„ÄÇ</p>
<blockquote>
<p>d_ffÈÄöÂ∏∏ËÆæÁΩÆ‰∏∫d_modelÁöÑ4ÂÄçÔºåÂØπ‰∫éd_model=512ÁöÑÊÉÖÂÜµÔºåd_ffÂ∞±ÊòØ2048„ÄÇËøô‰πüÊòØTransformerÂéüÂßãËÆ∫Êñá‰∏≠ÁöÑËÆæÁΩÆ„ÄÇÂ¢ûÂ§ß‰∏≠Èó¥Â±ÇÁª¥Â∫¶ÂèØ‰ª•ÊèêÈ´òÊ®°ÂûãÁöÑË°®ËææËÉΩÂäõ„ÄÇ</p>
</blockquote>
<p>Á¨¨‰∫îÁÇπÔºåself.conv2dÁöÑËæìÂá∫ÔºåÂú®ËøõË°åÂΩ¢Áä∂ÂèòÊç¢<code>transpose</code>ÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÊÅ¢Â§çÊàêÊó∂Èó¥Â∫èÂàóÁöÑÊ†áÂáÜÊï∞ÊçÆÊ†ºÂºè„ÄÇ</p>
<blockquote>
<p>Â∞ÜÊï∞ÊçÆÊ†ºÂºè‰ªéÂç∑ÁßØÂèãÂ•ΩÁöÑ<code>[B, C, L]</code>ËΩ¨ÂõûÂà∞TransformerÊû∂ÊûÑÈÄöÁî®ÁöÑ<code>[B, L, D]</code>Ê†ºÂºè</p>
</blockquote>
<p>ÂÜçÊ¨°Áõ¥ËßÇÂú∞ËØ¥ÊòéËøô‰∏ÄÈÉ®ÂàÜÂ∞±ÊòØËøôÊ†∑ÁöÑÔºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a><a href="#__codelineno-42-1"><span class="linenos" data-linenos=" 1 "></span></a># Á¨¨‰∏ÄÊ≠•ÔºöËΩ¨ÁΩÆ‰ΩøÁâπÂæÅÁª¥Â∫¶Êàê‰∏∫ÈÄöÈÅìÁª¥Â∫¶
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2"></a><a href="#__codelineno-42-2"><span class="linenos" data-linenos=" 2 "></span></a>y.transpose(-1, 1)  # [B, L, d_model] -&gt; [B, d_model, L]
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3"></a><a href="#__codelineno-42-3"><span class="linenos" data-linenos=" 3 "></span></a>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4"></a><a href="#__codelineno-42-4"><span class="linenos" data-linenos=" 4 "></span></a># Á¨¨‰∫åÊ≠•ÔºöÂ∫îÁî®Á¨¨‰∏Ä‰∏™Âç∑ÁßØÊâ©Â±ïÈÄöÈÅìÁª¥Â∫¶
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5"></a><a href="#__codelineno-42-5"><span class="linenos" data-linenos=" 5 "></span></a>self.conv1(...)  # [B, d_model, L] -&gt; [B, d_ff, L]
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6"></a><a href="#__codelineno-42-6"><span class="linenos" data-linenos=" 6 "></span></a>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7"></a><a href="#__codelineno-42-7"><span class="linenos" data-linenos=" 7 "></span></a># Á¨¨‰∏âÊ≠•ÔºöÂ∫îÁî®Á¨¨‰∫å‰∏™Âç∑ÁßØÊÅ¢Â§çÂéüÂßãÈÄöÈÅìÁª¥Â∫¶
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8"></a><a href="#__codelineno-42-8"><span class="linenos" data-linenos=" 8 "></span></a>self.conv2(...)  # [B, d_ff, L] -&gt; [B, d_model, L]
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9"></a><a href="#__codelineno-42-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10"></a><a href="#__codelineno-42-10"><span class="linenos" data-linenos="10 "></span></a># Á¨¨ÂõõÊ≠•ÔºöËΩ¨ÁΩÆÂõûÂéüÂßãÂ∫èÂàóÊ†ºÂºè
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11"></a><a href="#__codelineno-42-11"><span class="linenos" data-linenos="11 "></span></a>(...).transpose(-1, 1)  # [B, d_model, L] -&gt; [B, L, d_model]
</span></code></pre></div>
<p><strong>ÂêéËÆ∞Ôºö</strong> </p>
<blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> <span id="‰∏∫‰ªÄ‰πàConv2‰πãÂêéÊ≤°ÊúâËøõË°åÊøÄÊ¥ªÂáΩÊï∞ÁöÑÂ∫îÁî®">‰∫ßÁîüÁöÑÁñëÈóÆ</span>Ôºö<a href="#ÈôÑÂΩï">‰∏∫‰ªÄ‰πàConv2‰πãÂêéÊ≤°ÊúâËøõË°åÊøÄÊ¥ªÂáΩÊï∞ÁöÑÂ∫îÁî®</a> </li>
</ul>
<p>Áõ¥ËßÇÁöÑÁêÜËß£ÊàëÁöÑÁñëÈóÆÔºö</p>
<p><strong>Áé∞ÊúâËÆæËÆ° (Á¨¨‰∫åÂ±ÇÊó†ÊøÄÊ¥ª)Ôºö</strong></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a><a href="#__codelineno-43-1"><span class="linenos" data-linenos="1 "></span></a>y = Conv1 -&gt; ReLU -&gt; Dropout -&gt; Conv2 -&gt; Dropout
</span></code></pre></div>
<p><strong>Êõø‰ª£ËÆæËÆ° (‰∏§Â±ÇÈÉΩÊúâÊøÄÊ¥ª)</strong> </p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1"></a><a href="#__codelineno-44-1"><span class="linenos" data-linenos="1 "></span></a>y = Conv1 -&gt; ReLU -&gt; Dropout -&gt; Conv2 -&gt; ReLU -&gt; Dropout
</span></code></pre></div>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ‰∏∫‰ªÄ‰πàÊòØ conv1dÔºåËÄå‰∏çÊòØ nn.Linear</li>
</ul>
<p>Ê≤°Âï•ÂøÖË¶Å‰∫ÜÔºå‰∏ªË¶ÅÊòØÂú®Êï∞ÊçÆÁªÑÁªáÂíåËÆ°ÁÆóÊïàÁéáÊñπÈù¢ÊúâÂ∑ÆÂºÇÔºåAutoformerÈÄâÊã©Conv1DËÄåÈùûLinearÔºåÊòØÂü∫‰∫éÊû∂ÊûÑ‰∏ÄËá¥ÊÄß„ÄÅËÆ°ÁÆóÊïàÁéáÂíåÊú™Êù•Êâ©Â±ïÊÄßÔºàËÆæÁΩÆ kernel size ‰ª•ÂêéÂèØ‰ª•ÊçïÊçâÊó∂Èó¥Ê≠•‰πãÈó¥ÁöÑÂ±ÄÈÉ®Áõ∏ÂÖ≥ÊÄßÔºâÁöÑËÄÉËôëÔºåÂäüËÉΩ‰∏äÊòØÂÆåÂÖ®‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ÊâìÂç∞‰∫ÜÂçï‰∏™ EncoderLayerÁöÑÊ®°ÂûãÂèÇÊï∞</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321163630773.png"><img alt="image-20250321163630773" src="../images/image-20250321163630773.png"/></a> </p>
</blockquote>
<p>ÊúÄÂêéËøòÊúâ‰∏ÄÂè•ÔºåÂ∞ÜÂéüÂßãÁâπÂæÅx‰∏éÂèòÊç¢ÂêéÁöÑÁâπÂæÅyÁõ∏Âä†ÔºåÂÜçÊ¨°Â∫îÁî®Â∫èÂàóÂàÜËß£ÊèêÂèñÂ≠£ËäÇÊÄßÈÉ®ÂàÜ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a><a href="#__codelineno-45-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># Â∞ÜÂéüÂßãÁâπÂæÅx‰∏éÂèòÊç¢ÂêéÁöÑÁâπÂæÅyÁõ∏Âä†ÔºåÂÜçÊ¨°Â∫îÁî®Â∫èÂàóÂàÜËß£ÊèêÂèñÂ≠£ËäÇÊÄßÈÉ®ÂàÜ</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2"></a><a href="#__codelineno-45-2"><span class="linenos" data-linenos="2 "></span></a><span class="c1"># (x + y)[B, L, d_model] -&gt; Â∫èÂàóÂàÜËß£ -&gt; ËæìÂá∫res[B, L, d_model]ÂíåÊú™‰ΩøÁî®ÁöÑË∂ãÂäøÂàÜÈáè_[B, L, d_model]</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3"></a><a href="#__codelineno-45-3"><span class="linenos" data-linenos="3 "></span></a><span class="n">res</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp2</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Âà∞‰∫ÜËøô‰∏ÄÊ≠•ÔºåÂÖ∂ÂÆû‰ª£Á†ÅËØ•ËÆ≤ÁöÑ‰πüËÆ≤ÂÆå‰∫ÜÔºåÊõ¥ÈáçË¶ÅÁöÑÂú®‰∫éÂºÄÂßãÊÄùËÄÉÔºå‰∏∫‰ªÄ‰πàËøôÊ†∑ËÆæËÆ°Ôºü</strong></p>
<ul>
<li>Á≤òË¥¥Ëá™ gpt ÁöÑÁ≠îÊ°àË¥¥Âú®ÈôÑÂΩï‰∏≠‰∫ÜÔºåËß£ÈáäÂæóÊå∫Â•ΩÁöÑÔºåËøòÊúâÂíå‰º†Áªü Transformer ÁöÑÂØπÊØî</li>
<li>ÔºàÊàëÁêÜËß£ÁöÑÈÉ®ÂàÜËá™Â∑±Â§çËø∞Ôºâ‰ΩøÂæóÁºñÁ†ÅÂô®Âú®ÈÄêÂ±ÇÁºñÁ†ÅÁöÑËøáÁ®ã‰∏≠ÔºåÊõ¥ÂÖ≥Ê≥®È´òÈ¢ëÁöÑÂ≠£ËäÇÊàêÂàÜÔºåÊâÄ‰ª•ÊØèÊ¨°‰º†ËøõÁºñÁ†ÅÂô®ÁöÑÊòØÔºåÊäõÂºÉ‰∫ÜË∂ãÂäøÊàêÂàÜÁöÑÂ≠£ËäÇÊàêÂàÜ„ÄÇ</li>
</ul>
<p>ÁºñÁ†ÅÂô®‰∏≠ÂÖ≥‰∫éÂ≠£ËäÇÊàêÂàÜ„ÄÅË∂ãÂäøÊàêÂàÜÁöÑÁêÜËß£Ôºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1"></a><a href="#__codelineno-46-1"><span class="linenos" data-linenos=" 1 "></span></a>ËæìÂÖ• x [B,L,D] (Ê∑∑ÂêàÂ≠£ËäÇÊÄßÂíåË∂ãÂäø)
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2"></a><a href="#__codelineno-46-2"><span class="linenos" data-linenos=" 2 "></span></a>  ‚Üì
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3"></a><a href="#__codelineno-46-3"><span class="linenos" data-linenos=" 3 "></span></a>Ëá™Ê≥®ÊÑèÂäõÂ§ÑÁêÜ
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4"></a><a href="#__codelineno-46-4"><span class="linenos" data-linenos=" 4 "></span></a>  ‚Üì
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5"></a><a href="#__codelineno-46-5"><span class="linenos" data-linenos=" 5 "></span></a>ÊÆãÂ∑ÆËøûÊé• x + dropout(new_x) (‰ªçÂê´Ê∑∑ÂêàÊàêÂàÜ)
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6"></a><a href="#__codelineno-46-6"><span class="linenos" data-linenos=" 6 "></span></a>  ‚Üì
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7"></a><a href="#__codelineno-46-7"><span class="linenos" data-linenos=" 7 "></span></a>Â∫èÂàóÂàÜËß£1 
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8"></a><a href="#__codelineno-46-8"><span class="linenos" data-linenos=" 8 "></span></a>  ‚Üì          ‚Üò
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9"></a><a href="#__codelineno-46-9"><span class="linenos" data-linenos=" 9 "></span></a>Â≠£ËäÇÊÄßÂàÜÈáèx    Ë∂ãÂäøÂàÜÈáè (‰∏¢ÂºÉ)
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10"></a><a href="#__codelineno-46-10"><span class="linenos" data-linenos="10 "></span></a>  ‚Üì
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11"></a><a href="#__codelineno-46-11"><span class="linenos" data-linenos="11 "></span></a>ÂâçÈ¶àÁΩëÁªúÂ§ÑÁêÜ (Conv1D ‚Üí ReLU ‚Üí Conv1D)
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12"></a><a href="#__codelineno-46-12"><span class="linenos" data-linenos="12 "></span></a>  ‚Üì
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13"></a><a href="#__codelineno-46-13"><span class="linenos" data-linenos="13 "></span></a>ÂâçÈ¶àËæìÂá∫ y (Â≠£ËäÇÊÄßÁâπÂæÅ)
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14"></a><a href="#__codelineno-46-14"><span class="linenos" data-linenos="14 "></span></a>  ‚Üì
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15"></a><a href="#__codelineno-46-15"><span class="linenos" data-linenos="15 "></span></a>Â≠£ËäÇÊÄßÂàÜÈáèx + ÂâçÈ¶àËæìÂá∫y (Ê∑∑ÂêàÂ≠£ËäÇÊÄß)
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16"></a><a href="#__codelineno-46-16"><span class="linenos" data-linenos="16 "></span></a>  ‚Üì
</span><span id="__span-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17"></a><a href="#__codelineno-46-17"><span class="linenos" data-linenos="17 "></span></a>Â∫èÂàóÂàÜËß£2
</span><span id="__span-46-18"><a id="__codelineno-46-18" name="__codelineno-46-18"></a><a href="#__codelineno-46-18"><span class="linenos" data-linenos="18 "></span></a>  ‚Üì          ‚Üò
</span><span id="__span-46-19"><a id="__codelineno-46-19" name="__codelineno-46-19"></a><a href="#__codelineno-46-19"><span class="linenos" data-linenos="19 "></span></a>Â≠£ËäÇÊÄßÂàÜÈáères  Ë∂ãÂäøÂàÜÈáè (‰∏¢ÂºÉ)
</span><span id="__span-46-20"><a id="__codelineno-46-20" name="__codelineno-46-20"></a><a href="#__codelineno-46-20"><span class="linenos" data-linenos="20 "></span></a>  ‚Üì
</span><span id="__span-46-21"><a id="__codelineno-46-21" name="__codelineno-46-21"></a><a href="#__codelineno-46-21"><span class="linenos" data-linenos="21 "></span></a>ËæìÂá∫Âà∞‰∏ã‰∏ÄÂ±Ç res (Á∫ØÂ≠£ËäÇÊÄß)
</span></code></pre></div>
<p>ÊúÄÂêéËÆ∞‰∏ã‰∏§Âè•ËØùÊääÔºö</p>
<ul>
<li>È¢ëÁéáÂüüÂàÜÊûêÔºö‰ªéÈ¢ëÁéáËßíÂ∫¶ÁúãÔºåË∂ãÂäøÂØπÂ∫î‰ΩéÈ¢ëÊàêÂàÜÔºåÂ≠£ËäÇÊÄßÂØπÂ∫îÈ´òÈ¢ëÊàêÂàÜÔºåÂàÜÂºÄÂ§ÑÁêÜÊúâÂä©‰∫éÊèêÂèñÂêÑËá™ÁöÑÁâπÁÇπ„ÄÇ</li>
<li>ÁºñÁ†ÅÂô®Ôºö‰∏ìÊ≥®‰∫éÊçïËé∑Âë®ÊúüÊÄßÂíåÂ≠£ËäÇÊÄßÊ®°ÂºèÔºàÈ´òÈ¢ëÊàêÂàÜÔºâ</li>
<li>ËôΩÁÑ∂Âú®ÁºñÁ†ÅÂô®Â±ÇÂÜÖÈÉ®‰∏¢ÂºÉ‰∫ÜË∂ãÂäø‰ø°ÊÅØÔºå‰ΩÜAutoformerÂπ∂Ê≤°ÊúâÂÆåÂÖ®ÂøΩÁï•Ë∂ãÂäø„ÄÇ</li>
<li>ÈÄöËøáÂú®ÊØè‰∏ÄÂ±ÇÈÉΩ‰∏¢ÂºÉË∂ãÂäøÊàêÂàÜÔºåÊ®°ÂûãËÉΩÂ§üÂú®Â§öÂ±ÇÂ†ÜÂè†ËøáÁ®ã‰∏≠ÊåÅÁª≠ÂÖ≥Ê≥®Â≠£ËäÇÊÄßÂèòÂåñÔºåËÄå‰∏çË¢´Ë∂ãÂäøÂèòÂåñÂπ≤Êâ∞„ÄÇ</li>
<li>Ëß£Á†ÅÂô®‰∏≠ÂçïÁã¨Á¥ØÁßØË∂ãÂäøÔºåÈÅøÂÖçË∂ãÂäøÈ¢ÑÊµãÂØπÂ≠£ËäÇÊÄßÈ¢ÑÊµãÁöÑÂπ≤Êâ∞</li>
<li>Ê∏êËøõÂºèÂàÜËß£Êû∂ÊûÑ</li>
<li>ÊØèÂ±ÇÈÉΩÂ∫îÁî®Â∫èÂàóÂàÜËß£ÔºåÈÄêÊ≠•ÊèêÁÇºÂ≠£ËäÇÊÄßÁâπÂæÅÔºåÂ§öÂ±ÇÂ†ÜÂè†ÂèØ‰ª•ÊçïËé∑‰∏çÂêåÂ∞∫Â∫¶ÁöÑÂ≠£ËäÇÊÄßÊ®°Âºè</li>
</ul>
<p>Ë°å‰∫ÜÔºå‰∏äÈù¢ÂÖ≥‰∫éÁºñÁ†ÅÂô®ÁöÑÈÉ®ÂàÜËÆ≤ÁöÑÂ∑Æ‰∏çÂ§ö‰∫Ü</p>
<p><strong>ÂÖ¨Âºè</strong> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321103256921.png"><img alt="image-20250321103256921" src="../images/image-20250321103256921.png"/></a></p>
<p>ÊúÄÂºÄÂßã‰∏äÊ†áÁöÑ 1 Âíå 2 ‰∏çÊòéÁôΩÔºåÁé∞Âú®‰πüÊòéÁôΩ‰∫ÜÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ 1 ÊòØËá™Ê≥®ÊÑèÂäõÊú∫Âà∂ÁöÑËæìÂá∫ÔºåÂè™‰øùÁïôÁöÑÂ≠£ËäÇÊàêÂàÜÔºõ2 ÊòØÁªèËøáÂâçÈ¶àÁΩëÁöÑËæìÂá∫ÔºåÂè™‰øùÁïô‰∫ÜÂ≠£ËäÇÊàêÂàÜ„ÄÇ</p>
<p>Ëøô‰∫õËá™Ê≥®ÊÑèÂäõÊú∫Âà∂ Âíå ÂâçÈ¶àÁΩë ÂêéÈù¢ÈÉΩÊúâÊÆãÂ∑ÆËøûÊé•„ÄÇËøô‰∏≠Èó¥ËøòÊúâ dropout„ÄÅÊøÄÊ¥ªÁ≠â„ÄÇ</p>
<p><strong>‰ª£Á†Å</strong></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1"></a><a href="#__codelineno-47-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">attn_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2"></a><a href="#__codelineno-47-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3"></a><a href="#__codelineno-47-3"><span class="linenos" data-linenos=" 3 "></span></a>    <span class="n">new_x</span><span class="p">,</span> <span class="n">attn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attention</span><span class="p">(</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4"></a><a href="#__codelineno-47-4"><span class="linenos" data-linenos=" 4 "></span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5"></a><a href="#__codelineno-47-5"><span class="linenos" data-linenos=" 5 "></span></a>        <span class="n">attn_mask</span><span class="o">=</span><span class="n">attn_mask</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6"></a><a href="#__codelineno-47-6"><span class="linenos" data-linenos=" 6 "></span></a>    <span class="p">)</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7"></a><a href="#__codelineno-47-7"><span class="linenos" data-linenos=" 7 "></span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8"></a><a href="#__codelineno-47-8"><span class="linenos" data-linenos=" 8 "></span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9"></a><a href="#__codelineno-47-9"><span class="linenos" data-linenos=" 9 "></span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10"></a><a href="#__codelineno-47-10"><span class="linenos" data-linenos="10 "></span></a>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11"></a><a href="#__codelineno-47-11"><span class="linenos" data-linenos="11 "></span></a>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12"></a><a href="#__codelineno-47-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13"></a><a href="#__codelineno-47-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14"></a><a href="#__codelineno-47-14"><span class="linenos" data-linenos="14 "></span></a>    <span class="n">res</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp2</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15"></a><a href="#__codelineno-47-15"><span class="linenos" data-linenos="15 "></span></a>
</span><span id="__span-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16"></a><a href="#__codelineno-47-16"><span class="linenos" data-linenos="16 "></span></a>    <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">attn</span>
</span></code></pre></div>
<p>ÂÜçÊù•Áúã‰∏ÄÁúº**Êñá‰∏≠Ê®°ÂûãÁªìÊûÑÂõæ**Ôºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321103610423.png"><img alt="image-20250321103610423" src="../images/image-20250321103610423.png"/></a> </p>
<p>ÂèØ‰ª•ÁúãÂà∞ ÈÉΩÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑ„ÄÇ</p>
<p>ÂØπÔºåËøòÊúâ‰∏Ä‰∏™ÔºåÂéüÊñáÂ†ÜÂè† Encoder ÁöÑÂ±ÇÊï∞=2„ÄÇ</p>
<hr/>
<h3 id="decoder">Decoder<a class="headerlink" href="#decoder" title="Permanent link">¬∂</a></h3>
<p><strong>‰∏ãÈù¢ËøõÂÖ•Ëß£Á†ÅÂô®ÈÉ®ÂàÜÔºåÁ¶ÅÁî®ÊâÄÊúâÊñ≠ÁÇπÔºåÂè™‰øùÁïôË∞ÉÁî®Ëß£Á†ÅÁöÑÈÉ®ÂàÜÔºö</strong> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321104519139.png"><img alt="image-20250321104519139" src="../images/image-20250321104519139.png"/></a></p>
<p>ÂêØÂä®ÂëΩ‰ª§Ôºö</p>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1"></a><a href="#__codelineno-48-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="o">(</span>base<span class="o">)</span><span class="w"> </span>$<span class="w"> </span>conda<span class="w"> </span>env<span class="w"> </span>list
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2"></a><a href="#__codelineno-48-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3"></a><a href="#__codelineno-48-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># conda environments:</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4"></a><a href="#__codelineno-48-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="c1">#</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5"></a><a href="#__codelineno-48-5"><span class="linenos" data-linenos=" 5 "></span></a>base<span class="w">                 </span>*<span class="w"> </span>/home/student2023/xiehr2023/miniconda3
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6"></a><a href="#__codelineno-48-6"><span class="linenos" data-linenos=" 6 "></span></a>Autoformer<span class="w">             </span>/home/student2023/xiehr2023/miniconda3/envs/Autoformer
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7"></a><a href="#__codelineno-48-7"><span class="linenos" data-linenos=" 7 "></span></a>SegRNN<span class="w">                 </span>/home/student2023/xiehr2023/miniconda3/envs/SegRNN
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8"></a><a href="#__codelineno-48-8"><span class="linenos" data-linenos=" 8 "></span></a>timesNet<span class="w">               </span>/home/student2023/xiehr2023/miniconda3/envs/timesNet
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9"></a><a href="#__codelineno-48-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10"></a><a href="#__codelineno-48-10"><span class="linenos" data-linenos="10 "></span></a><span class="o">(</span>base<span class="o">)</span><span class="w"> </span>$<span class="w"> </span>conda<span class="w"> </span>activate<span class="w"> </span>Autoformer
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11"></a><a href="#__codelineno-48-11"><span class="linenos" data-linenos="11 "></span></a><span class="o">(</span>Autoformer<span class="o">)</span><span class="w"> </span>$<span class="w"> </span>sh<span class="w"> </span>scripts/ILI_script/Autoformer.sh
</span></code></pre></div>
<p>Âú®Ê≠•Ëøõ‰ª£Á†Å‰πãÂâçÔºåÂÖàÁúãmermaid ÁîªÁöÑÁ±ªÂõæÔºåÁúãÊ∏ÖËß£Á†ÅÂô®ÁöÑË∞ÉÁî®ÊµÅÁ®ãÔºö  </p>
<h4 id="_11">Á±ªÂõæ<a class="headerlink" href="#_11" title="Permanent link">¬∂</a></h4>
<pre class="mermaid"><code>
classDiagram
    class Model {
        +int seq_len
        +int label_len
        +int pred_len
        +bool output_attention
        +series_decomp decomp
        +DataEmbedding_wo_pos enc_embedding
        +DataEmbedding_wo_pos dec_embedding
        +Encoder encoder
        +Decoder decoder
        +forward(x_enc, x_mark_enc, x_dec, x_mark_dec, enc_self_mask, dec_self_mask, dec_enc_mask)
    }

    class series_decomp {
        +moving_avg moving_avg
        +forward(x) res, moving_mean
    }
    class moving_avg {
        +int kernel_size
        +AvgPool1d avg
        +forward(x)
    }

    class DataEmbedding_wo_pos {
        +TokenEmbedding value_embedding
        +PositionalEmbedding position_embedding
        +TemporalEmbedding temporal_embedding
        +Dropout dropout
        +forward(x, x_mark)
    }

    class Encoder {
        +List~EncoderLayer~ layers
        +my_Layernorm norm_layer
        +forward(x, attn_mask)
    }

    class EncoderLayer {
        +AutoCorrelationLayer attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +Dropout dropout
        +activation
        +forward(x, attn_mask)
    }

    class AutoCorrelationLayer {
        +AutoCorrelation attention
        +Linear query_projection
        +Linear key_projection
        +Linear value_projection
        +Linear out_projection
        +forward(queries, keys, values, attn_mask)
    }

    class AutoCorrelation {
        +bool mask_flag
        +int factor
        +float scale
        +Dropout dropout
        +bool output_attention
        +time_delay_agg_training(values, corr)
        +time_delay_agg_inference(values, corr)
        +forward(queries, keys, values, attn_mask)
    }

    class Decoder {
        +List~DecoderLayer~ layers
        +my_Layernorm norm_layer
        +Linear projection
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    class DecoderLayer {
        +AutoCorrelationLayer self_attention
        +AutoCorrelationLayer cross_attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +series_decomp decomp3
        +Dropout dropout
        +activation
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    Model --&gt; series_decomp
    Model --&gt; DataEmbedding_wo_pos
    Model --&gt; Encoder
    Model --&gt; Decoder
    Encoder --&gt; EncoderLayer
    EncoderLayer --&gt; AutoCorrelationLayer
    EncoderLayer --&gt; Conv1d
    EncoderLayer --&gt; series_decomp
    AutoCorrelationLayer --&gt; AutoCorrelation
    Decoder --&gt; DecoderLayer
    DecoderLayer --&gt; AutoCorrelationLayer
    DecoderLayer --&gt; Conv1d
    DecoderLayer --&gt; series_decomp   
    series_decomp --&gt; moving_avg
    moving_avg --&gt; AvgPool1d
</code></pre>
<p>‰∏ãÈù¢ÂºÄÂßãËÆ≤Âõæ„ÄÇ</p>
<p><strong>Mode init</strong> </p>
<p>È¶ñÂÖàÔºå‰ªéÁ¨¨‰∏ÄÊ°ÜÂºÄÂßãÔºåmodel Â∞±ÊòØÊåáÁöÑ AutoformerÔºåÈ¶ñÂÖà Autoformer ÁöÑ init ÈÉ®ÂàÜÊúâ ËæìÂÖ•Â∫èÂàóÈïøÂ∫¶Ôºåsequence lengthÔºõÊ†áÁ≠æÂ∫èÂàóÁöÑÈïøÂ∫¶ label lengthÔºåÊ†áÁ≠æÂ∫èÂàóÁî®‰∫éÊåáÂØºÈ¢ÑÊµãÔºåÊú¨ÊñáÊà™ÂèñËæìÂÖ•Â∫èÂàóÈïøÂ∫¶ÁöÑ‰∏ÄÂçäÔºõÈ¢ÑÊµãÂ∫èÂàóÈïøÂ∫¶ predict lengthÔºåÂõ†‰∏∫Êú¨ÊñáËÆæÁΩÆÁöÑÊ†áÁ≠æÂ∫èÂàóÔºåÊâÄ‰ª•Ëß£Á†ÅÂô®ÂÆûÈôÖÁöÑËæìÂá∫Êó∂Èó¥Ê≠•ÊòØ label length+predict lengthÔºåÊâÄ‰ª•È¢ÑÊµãÁöÑÈÉ®ÂàÜÔºåËøòË¶ÅÊää label length Êà™Êéâ„ÄÇattention ÊöÇÊó∂‰∏çÁúãÔºåÊàë‰πü‰∏çÊòéÁôΩÊúâÂï•Áî®ÔºåÂ§ßÊ¶ÇÂ∞±ÊòØ‰∏Ä‰∏™ÂàùÂßãÂåñÂêß„ÄÇ</p>
<p>ÁÑ∂ÂêéÂ∞±ÊòØÂ∫èÂàóÂàÜËß£ÂáΩÊï∞ÔºåÂàÜËß£Â≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ„ÄÇË∂ãÂäøÊàêÂàÜÊòØ‰ΩéÈ¢ëÊàêÂàÜÔºåË°®Á§∫Êó∂Èó¥Â∫èÂàóÈïøÊúüÁ®≥ÂÆöÁöÑË∂ãÂäøÔºåÁî®ÁöÑÊòØÁßªÂä®Âπ≥ÂùáÔºåÂú®‰ª£Á†ÅÂÆûÁé∞‰∏≠ÔºåÂÖ∑‰ΩìÁî®ÁöÑÊòØ 1D Âπ≥ÂùáÊ±†Âåñ„ÄÇÂ≠£ËäÇÊàêÂàÜÊòØÈ´òÈ¢ëÊàêÂàÜÔºåË°®Á§∫Âë®ÊúüÊÄß‰ø°ÊÅØÔºåÂàÜËß£‰∏≠ÁöÑÂÅöÊ≥ïÊòØ ÂéüÂßãÂ∫èÂàóÂáèÂéªÂ≠£ËäÇÊàêÂàÜ„ÄÇres = ÂéüÂßãÂ∫èÂàó <code>x</code> - Ë∂ãÂäøÊàêÂàÜ <code>move_average</code></p>
<p>‰∏ãÈù¢ÊòØ‰∏§‰∏™ÂµåÂÖ•Â±ÇÔºåÁõÆÁöÑÊòØËøõË°å token Embedding Âíå temporal EmbeddingÔºåÂ∞ÜÂéüÂßãÊó∂Èó¥Ê≠•ÁâπÂæÅÂµåÂÖ•Âà∞ÊåáÂÆöÁª¥Â∫¶ÔºåÊõ¥Á≤æÁªÜÁöÑË°®Á§∫ÁâπÂæÅ„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºöÊó∂Èó¥Ê≠•ÁâπÂæÅ[32,36,7] ‚Üí [32,36,512]   [32,42,7] ‚Üí[32,42,512] ÔºõÔºàÊó∂Èó¥Ê≠•ÔºâÊó∂Èó¥ÁâπÂæÅ[32,36,4] ‚Üí [32,36,512]   [32,42,4] ‚Üí[32,42,512] </p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØ Encoder Âíå DecoderÔºåÂÖ∂‰∏≠ Encoder ‰ºöÂ†ÜÂè† EncoderLayerÔºåDecoder Â†ÜÂè† DecoderLayerÔºå</p>
<p>ÂÖ∂‰∏≠ EncoderLayer Â†ÜÂè†‰∫Ü 2 Â±ÇÔºåÁªìÂêàÂõæÂíå‰ª£Á†ÅÔºåÁúãÂçïÂ±Ç EncoderLayer Âíå DecoderLayer ÁöÑ Áõ∏Âêå‰∏é‰∏çÂêå„ÄÇ</p>
<p>Ôºà1ÔºâDecoder ÊØî Encoder Â§ö‰∫Ü‰∏Ä‰∏™Á∫øÊÄßÂ±Ç <code>nn.Linear</code> ÔºàÈÅµÂæ™‰∫ÜÊ†áÂáÜ Transformer Êû∂ÊûÑÔºâ</p>
<p>Ôºà2ÔºâDecoderLayer Ë∞ÉÁî®‰∫Ü‰∏§Ê¨° Ëá™Áõ∏ÂÖ≥Â±ÇÔºåËøôÊòØÂõ†‰∏∫ Decoder ‰∏≠ËøõË°å‰∏§ÁßçÊ≥®ÊÑèÂäõÊú∫Âà∂ÁöÑËøêÁÆóÔºåËá™Ê≥®ÊÑèÂäõÊú∫Âà∂Âíå‰∫§ÂèâÊ≥®ÊÑèÊú∫Âà∂ÔºåÂπ∂‰∏îÂÜçÊ¨°ËØ¥ÊòéÔºåËá™Ê≥®ÊÑèÂäõÂ±Ç„ÄÅ‰∫§ÂèâÊ≥®ÊÑèÂäõÂ±Ç„ÄÅFFN ‰ª•ÂêéÔºå‰ºöËøõË°åÊÆãÂ∑ÆËøûÊé•„ÄÇ</p>
<p>Ôºà3ÔºâDecoderLayer ËøõË°å‰∫Ü‰∏âÊ¨°Â∫èÂàóÂàÜËß£ÔºåÁåúÊµãÔºåÂàÜÂà´ÊòØÂú®Ëá™Ê≥®ÊÑèÊú∫Âà∂„ÄÅ‰∫§ÂèâÊ≥®ÊÑèÂäõÊú∫Âà∂‰ª•Âèä FFN ‰ª•ÂêéÔºåÂàÜÂà´ËøõË°åÂàÜËß£</p>
<p>Ôºà4ÔºâÂêåÊó∂Âú® DecoderLayer ‰∏≠ÔºåÂ∫îËØ•Â∞§ÂÖ∂Ê≥®ÊÑè Ë∂ãÂäøÊàêÂàÜÊòØÊÄé‰πàÂ§ÑÁêÜÁöÑÔºåÂõ†‰∏∫ EncoderLayer ‰∏≠ÔºåÂøΩÁï•Êéâ‰∫ÜË∂ãÂäøÊàêÂàÜ„ÄÇ</p>
<p>Ôºà5ÔºâÊé•‰∏ãÊù•ÂÖ±ÂêåË∞ÉÁî®ÁöÑ Ëá™Áõ∏ÂÖ≥Â±ÇÔºåÂçï‰∏™Ëá™Áõ∏ÂÖ≥Â±Ç„ÄÅ‰ª•ÂèäÂ∫èÂàóÂàÜËß£ÊòØÂÆåÂÖ®‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321160449357.png"><img alt="image-20250321160449357" src="../images/image-20250321160449357.png"/></a></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1"></a><a href="#__codelineno-49-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">Encoder</span><span class="p">(</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2"></a><a href="#__codelineno-49-2"><span class="linenos" data-linenos=" 2 "></span></a>    <span class="p">[</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3"></a><a href="#__codelineno-49-3"><span class="linenos" data-linenos=" 3 "></span></a>        <span class="n">EncoderLayer</span><span class="p">(</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4"></a><a href="#__codelineno-49-4"><span class="linenos" data-linenos=" 4 "></span></a>            <span class="n">AutoCorrelationLayer</span><span class="p">(</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5"></a><a href="#__codelineno-49-5"><span class="linenos" data-linenos=" 5 "></span></a>                <span class="n">AutoCorrelation</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">attention_dropout</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6"></a><a href="#__codelineno-49-6"><span class="linenos" data-linenos=" 6 "></span></a>                                <span class="n">output_attention</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">output_attention</span><span class="p">),</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7"></a><a href="#__codelineno-49-7"><span class="linenos" data-linenos=" 7 "></span></a>                <span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">n_heads</span><span class="p">),</span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8"></a><a href="#__codelineno-49-8"><span class="linenos" data-linenos=" 8 "></span></a>            <span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">,</span>
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9"></a><a href="#__codelineno-49-9"><span class="linenos" data-linenos=" 9 "></span></a>            <span class="n">configs</span><span class="o">.</span><span class="n">d_ff</span><span class="p">,</span>
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10"></a><a href="#__codelineno-49-10"><span class="linenos" data-linenos="10 "></span></a>            <span class="n">moving_avg</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">moving_avg</span><span class="p">,</span>
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11"></a><a href="#__codelineno-49-11"><span class="linenos" data-linenos="11 "></span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="__span-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12"></a><a href="#__codelineno-49-12"><span class="linenos" data-linenos="12 "></span></a>            <span class="n">activation</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">activation</span>
</span><span id="__span-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13"></a><a href="#__codelineno-49-13"><span class="linenos" data-linenos="13 "></span></a>        <span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">configs</span><span class="o">.</span><span class="n">e_layers</span><span class="p">)</span>
</span><span id="__span-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14"></a><a href="#__codelineno-49-14"><span class="linenos" data-linenos="14 "></span></a>    <span class="p">],</span>
</span><span id="__span-49-15"><a id="__codelineno-49-15" name="__codelineno-49-15"></a><a href="#__codelineno-49-15"><span class="linenos" data-linenos="15 "></span></a>    <span class="n">norm_layer</span><span class="o">=</span><span class="n">my_Layernorm</span><span class="p">(</span><span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">)</span>
</span><span id="__span-49-16"><a id="__codelineno-49-16" name="__codelineno-49-16"></a><a href="#__codelineno-49-16"><span class="linenos" data-linenos="16 "></span></a><span class="p">)</span>
</span><span id="__span-49-17"><a id="__codelineno-49-17" name="__codelineno-49-17"></a><a href="#__codelineno-49-17"><span class="linenos" data-linenos="17 "></span></a><span class="c1"># Decoder</span>
</span><span id="__span-49-18"><a id="__codelineno-49-18" name="__codelineno-49-18"></a><a href="#__codelineno-49-18"><span class="linenos" data-linenos="18 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Decoder</span><span class="p">(</span>
</span><span id="__span-49-19"><a id="__codelineno-49-19" name="__codelineno-49-19"></a><a href="#__codelineno-49-19"><span class="linenos" data-linenos="19 "></span></a>    <span class="p">[</span>
</span><span id="__span-49-20"><a id="__codelineno-49-20" name="__codelineno-49-20"></a><a href="#__codelineno-49-20"><span class="linenos" data-linenos="20 "></span></a>        <span class="n">DecoderLayer</span><span class="p">(</span>
</span><span id="__span-49-21"><a id="__codelineno-49-21" name="__codelineno-49-21"></a><a href="#__codelineno-49-21"><span class="linenos" data-linenos="21 "></span></a>            <span class="n">AutoCorrelationLayer</span><span class="p">(</span>
</span><span id="__span-49-22"><a id="__codelineno-49-22" name="__codelineno-49-22"></a><a href="#__codelineno-49-22"><span class="linenos" data-linenos="22 "></span></a>                <span class="n">AutoCorrelation</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">attention_dropout</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="__span-49-23"><a id="__codelineno-49-23" name="__codelineno-49-23"></a><a href="#__codelineno-49-23"><span class="linenos" data-linenos="23 "></span></a>                                <span class="n">output_attention</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
</span><span id="__span-49-24"><a id="__codelineno-49-24" name="__codelineno-49-24"></a><a href="#__codelineno-49-24"><span class="linenos" data-linenos="24 "></span></a>                <span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">n_heads</span><span class="p">),</span>
</span><span id="__span-49-25"><a id="__codelineno-49-25" name="__codelineno-49-25"></a><a href="#__codelineno-49-25"><span class="linenos" data-linenos="25 "></span></a>            <span class="n">AutoCorrelationLayer</span><span class="p">(</span>
</span><span id="__span-49-26"><a id="__codelineno-49-26" name="__codelineno-49-26"></a><a href="#__codelineno-49-26"><span class="linenos" data-linenos="26 "></span></a>                <span class="n">AutoCorrelation</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">attention_dropout</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="__span-49-27"><a id="__codelineno-49-27" name="__codelineno-49-27"></a><a href="#__codelineno-49-27"><span class="linenos" data-linenos="27 "></span></a>                                <span class="n">output_attention</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
</span><span id="__span-49-28"><a id="__codelineno-49-28" name="__codelineno-49-28"></a><a href="#__codelineno-49-28"><span class="linenos" data-linenos="28 "></span></a>                <span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">n_heads</span><span class="p">),</span>
</span><span id="__span-49-29"><a id="__codelineno-49-29" name="__codelineno-49-29"></a><a href="#__codelineno-49-29"><span class="linenos" data-linenos="29 "></span></a>            <span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">,</span>
</span><span id="__span-49-30"><a id="__codelineno-49-30" name="__codelineno-49-30"></a><a href="#__codelineno-49-30"><span class="linenos" data-linenos="30 "></span></a>            <span class="n">configs</span><span class="o">.</span><span class="n">c_out</span><span class="p">,</span>
</span><span id="__span-49-31"><a id="__codelineno-49-31" name="__codelineno-49-31"></a><a href="#__codelineno-49-31"><span class="linenos" data-linenos="31 "></span></a>            <span class="n">configs</span><span class="o">.</span><span class="n">d_ff</span><span class="p">,</span>
</span><span id="__span-49-32"><a id="__codelineno-49-32" name="__codelineno-49-32"></a><a href="#__codelineno-49-32"><span class="linenos" data-linenos="32 "></span></a>            <span class="n">moving_avg</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">moving_avg</span><span class="p">,</span>
</span><span id="__span-49-33"><a id="__codelineno-49-33" name="__codelineno-49-33"></a><a href="#__codelineno-49-33"><span class="linenos" data-linenos="33 "></span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="__span-49-34"><a id="__codelineno-49-34" name="__codelineno-49-34"></a><a href="#__codelineno-49-34"><span class="linenos" data-linenos="34 "></span></a>            <span class="n">activation</span><span class="o">=</span><span class="n">configs</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
</span><span id="__span-49-35"><a id="__codelineno-49-35" name="__codelineno-49-35"></a><a href="#__codelineno-49-35"><span class="linenos" data-linenos="35 "></span></a>        <span class="p">)</span>
</span><span id="__span-49-36"><a id="__codelineno-49-36" name="__codelineno-49-36"></a><a href="#__codelineno-49-36"><span class="linenos" data-linenos="36 "></span></a>        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">configs</span><span class="o">.</span><span class="n">d_layers</span><span class="p">)</span>
</span><span id="__span-49-37"><a id="__codelineno-49-37" name="__codelineno-49-37"></a><a href="#__codelineno-49-37"><span class="linenos" data-linenos="37 "></span></a>    <span class="p">],</span>
</span><span id="__span-49-38"><a id="__codelineno-49-38" name="__codelineno-49-38"></a><a href="#__codelineno-49-38"><span class="linenos" data-linenos="38 "></span></a>    <span class="n">norm_layer</span><span class="o">=</span><span class="n">my_Layernorm</span><span class="p">(</span><span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">),</span>
</span><span id="__span-49-39"><a id="__codelineno-49-39" name="__codelineno-49-39"></a><a href="#__codelineno-49-39"><span class="linenos" data-linenos="39 "></span></a>    <span class="n">projection</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">configs</span><span class="o">.</span><span class="n">d_model</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">c_out</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-49-40"><a id="__codelineno-49-40" name="__codelineno-49-40"></a><a href="#__codelineno-49-40"><span class="linenos" data-linenos="40 "></span></a><span class="p">)</span>
</span></code></pre></div>
<p>ËØ¥ÁùÄËØ¥ÁùÄÂ∞±Ëøú‰∫Ü</p>
<h4 id="_12">ËÆ∫Êñá<a class="headerlink" href="#_12" title="Permanent link">¬∂</a></h4>
<p>ÁªßÁª≠ÊåâÁÖßËÆ∫Êñá„ÄÅÂÖ¨Âºè„ÄÅ‰ª£Á†Å„ÄÅÂõæÁöÑÈÄªËæëËøõË°åËÆ≤Ëß£</p>
<p>ÁúãËÆ∫ÊñáÊää„ÄÇ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321163503744.png"><img alt="image-20250321163503744" src="../images/image-20250321163503744.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321163514281.png"><img alt="image-20250321163514281" src="../images/image-20250321163514281.png"/></a></p>
<p>‰∏ÄÂè•‰∏ÄÂè•ÁúãÂêßÔºö</p>
<p>üü¢   </p>
<blockquote>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321164634097.png"><img alt="image-20250321164634097" src="../images/image-20250321164634097.png"/></a></p>
<p>Ëß£Á†ÅÂô®</p>
<p>Ëß£Á†ÅÂô®ÂåÖÂê´‰∏§‰∏™ÈÉ®ÂàÜÔºåË°®Á§∫Ë∂ãÂäøÊàêÂàÜÁöÑÁ¥ØÁßØÁªìÊûÑ Âíå Â≠£ËäÇÊàêÂàÜÂ†ÜÂè†ÁöÑËá™Áõ∏ÂÖ≥Êú∫Âà∂</p>
<p>ÊØè‰∏™ÁöÑDecoderLayer ÂåÖÂê´‰∫ÜÂÜÖÈÉ®Ëá™Áõ∏ÂÖ≥Êú∫Âà∂(Ëá™Ê≥®ÊÑèÂäõÊú∫Âà∂)ÂíåÁºñÁ†ÅÂô®ÂíåËß£Á†ÅÂô®Áõ∏ÂÖ≥Êú∫Âà∂(‰∫§ÂèâÊ≥®ÊÑèÂäõÊú∫Âà∂)ÔºåÁõÆÁöÑÊòØ‰∏∫‰∫Ü  ‚ë† ÁªÜÂåñÈ¢ÑÊµã Âπ∂‰∏î ‚ë° ÂÖÖÂàÜÂà©Áî®ÂéÜÂè≤ÁöÑÂ≠£ËäÇ‰ø°ÊÅØ</p>
</blockquote>
<p>üü¢ </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321164717926.png"><img alt="image-20250321164717926" src="../images/image-20250321164717926.png"/></a> </p>
<blockquote>
<p>Ê≥®ÊÑèÔºåÊ®°ÂûãÊèêÂèñÊΩúÂú®ÁöÑË∂ãÂäø‰ø°ÊÅØÔºåÂú®Ëß£Á†ÅÂô®‰∏≠ÔºåÈÄöËøá‰∏≠Èó¥ÁöÑÈöêËóèÂèòÈáè„ÄÇ</p>
<p>ÔºàÊ≥®ÊÑèÔºåÂú®Ëß£Á†ÅÂô®‰∏≠ÔºåÊ®°Âûã ÈÄöËøá‰∏≠Èó¥ÁöÑÈöêËóèÂèòÈáè ÊèêÂèñÊΩúÂú®ÁöÑË∂ãÂäø‰ø°ÊÅØÔºâ</p>
<p>ËøôÁßçÊú∫Âà∂ ‰ΩøÂæóAutoformer ÈÄêÊ≠• ‰ºòÂåñ Ë∂ãÂäøÈ¢ÑÊµã Âπ∂‰∏î Ê∂àÈô§ Âπ≤Êâ∞‰ø°ÊÅØ</p>
<p>‰ª•‰æøÂú®Ëá™Áõ∏ÂÖ≥Êú∫Âà∂‰∏≠ ÂèëÁé∞ Âü∫‰∫éÂë®ÊúüÁöÑ‰æùËµñÂÖ≥Á≥ª„ÄÇ</p>
<blockquote>
<p>ÊàëÔºöÔºàÂ∞±ÊòØËØ¥ ÈöêËóèÁöÑ‰∏≠Èó¥ÂèòÈáèÈ¢ÑÊµãË∂ãÂäø‰ø°ÊÅØÔºåÂú®Ëá™Áõ∏ÂÖ≥Êú∫Âà∂‰∏≠ È¢ÑÊµãÂ≠£ËäÇ‰ø°ÊÅØÔºâ</p>
</blockquote>
<p>ÂÅáËÆæ Ëß£Á†ÅÂô® Êúâ M Â±ÇÔºåÁªìÂêàÊù•Ëá™ÁºñÁ†ÅÂô®ÁöÑÊΩúÂú®ÂèòÈáè <span class="arithmatex">\(\mathcal{X}_{en}^N\)</span> ÔºàÊàëÔºöÂ∫îËØ•ÊòØÁºñÁ†ÅÂô®ÁöÑÊúÄÂêé‰∏ÄÂ±ÇËæìÂá∫ÔºâÔºåÁ¨¨ l Â±ÇËß£Á†ÅÂô®ÁöÑÊñπÁ®ãÂèØ‰ª•Ë°®Á§∫‰∏∫ $ \mathcal{X}<em de="de">{de}^{l} = Decoder(\mathcal{X}</em><sup>{l-1},\mathcal{X}_{en}</sup>N)$ ÔºàÊàëÔºöÁ¨¨ <span class="arithmatex">\(l\)</span> Â±ÇËß£Á†ÅÂô®ÁöÑËæìÂÖ•ÔºåÊé•Êî∂Êù•Ëá™==‰∏ä‰∏ÄÂ±ÇËß£Á†ÅÂô®ÁöÑËæìÂá∫==  Âíå <mark>ÊúÄÂêé‰∏ÄÂ±ÇÁºñÁ†ÅÂô®ÁöÑËæìÂá∫</mark> ‰Ωú‰∏∫ËæìÂÖ•Ôºâ</p>
</blockquote>
<p>üü¢ Âçï‰∏™ DecoderLayer ÁöÑËøáÁ®ãÔºåÂèØ‰ª•Ê¶ÇÊã¨Â¶Ç‰∏ãÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321165833556.png"><img alt="image-20250321165833556" src="../images/image-20250321165833556.png"/></a> </p>
<p>Á¨¶Âè∑Ëß£Èáä</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321171255673.png"><img alt="image-20250321171255673" src="../images/image-20250321171255673.png"/></a> </p>
<ul>
<li><span class="arithmatex">\(\mathcal{X}_{de}^l = \mathcal{S}_{de}^{l,3},l \in \{1,...,M\}\)</span> Ë°®Á§∫Á¨¨ <span class="arithmatex">\(l\)</span> Â±ÇËß£Á†ÅÂ±ÇÁöÑËæìÂá∫ÔºåM ÊòØ DecoderLayer ÁöÑÂ±ÇÊï∞</li>
</ul>
<blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> 3 ÊòØÂï•Ôºü</li>
</ul>
</blockquote>
<ul>
<li><span class="arithmatex">\(\mathcal{X}_{de}^0\)</span> ÊòØÂØπÂéüÂßãËß£Á†ÅÂô®ËæìÂÖ• <span class="arithmatex">\(\mathcal{X}_{des}\)</span>  ÁöÑÂµåÂÖ• Ôºà <span class="arithmatex">\(\mathcal{X}_{des}\)</span> ‚Üí ÂµåÂÖ•Â±Ç ‚Üí  <span class="arithmatex">\(\mathcal{X}_{de}^0\)</span>Ôºâ </li>
</ul>
<blockquote>
<p>(outputs)ÔºàÂ∞±ÊòØÂéüÂßãÊï∞ÊçÆË°®Á§∫„ÄÅTransformer ÁªìÊûÑÂè≥‰æßËß£Á†ÅÂô®ÁöÑËæìÂÖ•ÔºàÁúüÊúç‰∫ÜÔºå‰∏∫‰∫ÜÊÄïËá™Â∑±ÂøòÔºåÁî®ÁùÄËøô‰πàÂ§öËß£ÈáäT.TÔºâÔºâ</p>
</blockquote>
<ul>
<li><span class="arithmatex">\(\mathcal{T}_{de}^0 = \mathcal{X}_{det}\)</span> Áî®‰∫éÁ¥ØÁßØ==ÔºàÊâÄ‰ª•Â∞±ÊòØË∂ãÂäøÂàÜÈáèÊòØÁ¥ØÂä†Êù•ÁöÑÔºâ==    </li>
</ul>
<blockquote>
<p>ÁúüÊôïÂïäÔºåÈÉΩÂï•Á¨¶Âè∑Âïä„ÄÇÁúüÊúç‰∫Ü„ÄÇÁøªÊää„ÄÇÊØïÁ´üÁ¨¶Âè∑ÊòØÁªü‰∏ÄÁöÑ„ÄÇ</p>
<p>ÊâæÂà∞‰∫ÜÔºÅ</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321171042677.png"><img alt="image-20250321171042677" src="../images/image-20250321171042677.png"/></a> </p>
<ul>
<li>de Ëß£Á†ÅÂô® „ÄÅs Â≠£ËäÇÂàÜÈáè„ÄÅt Ë∂ãÂäøÂàÜÈáè</li>
<li><span class="arithmatex">\(\mathcal{X}\)</span> ÂéüÂßãÊï∞ÊçÆÔºåÊú™ÁªèÂµåÂÖ•</li>
<li>‰∏äÊ†á 0 Ë°®Á§∫ÂàùÂßãÂÄº</li>
<li>s ÊàêÂàÜÔºàÂ≠£ËäÇÊàêÂàÜÔºâÁöÑÂàùÂßãÂåñÊòØ 0 Â°´ÂÖÖÁöÑ„ÄÅt ÊàêÂàÜÔºàË∂ãÂäøÊàêÂàÜÔºâÁöÑÂàùÂßãÂåñÊòØ ÂùáÂÄºÂ°´ÂÖÖÁöÑ</li>
<li><span class="arithmatex">\(\mathcal{T}\)</span> Ë°®Á§∫Ë∂ãÂäøÂàÜÈáèÔºåÔºàTrendÔºâ</li>
<li><span class="arithmatex">\(\mathcal{S}\)</span> Ë°®Á§∫ Â≠£ËäÇÂàÜÈáèÔºåÔºàSeasonÔºâ</li>
</ul>
<blockquote>
<p>‰∏çÈîôÔºåÂëΩÂêçËøòÊå∫ËÆ≤Á©∂ÁöÑ„ÄÇÊù•Ëá™ÊàëÁöÑË∂ÖÈ´òËØÑ‰ª∑ÔºåÂÆ≥ÔºåÁ†îÁ©∂Ëøô‰∏™ÁöÑÔºåÂì™ÊúâÂá†‰∏™Á≤æÁ•ûÁæé‰∏ΩÁöÑÔºåÂπ≤Ê¥ª‰∫Ü„ÄÇ</p>
</blockquote>
</blockquote>
<ul>
<li><span class="arithmatex">\(\mathcal{S}_{de}^{l,i}\)</span> „ÄÅ<span class="arithmatex">\(\mathcal{T}_{de}^{l,i}\)</span> $   i  \in {1,2,3}$ ÂàÜÂà´Ë°®Á§∫ Á¨¨<span class="arithmatex">\(l\)</span> Â±ÇÁöÑDecoderLayer ‰∏≠ÔºåÁ¨¨ <span class="arithmatex">\(i\)</span> Ê¨°Â∫èÂàóÂàÜËß£Âø´‰πãÂêéÂæóÂà∞ÁöÑÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ„ÄÇ(<span class="arithmatex">\(l\)</span> Ë°®Á§∫ <span class="arithmatex">\(l\)</span> Â±ÇÔºåÁºñÁ†ÅÂô®Ëß£Á†ÅÂô®‰∏≠ÂêåÁêÜ)</li>
<li><span class="arithmatex">\(\mathcal{W}_{l,i} , i\in \{1,2,3\}\)</span>  Ë°®Á§∫ ÂØπ Á¨¨ <span class="arithmatex">\(i\)</span> ‰∏™ÊèêÂèñÁöÑË∂ãÂäøÂàÜÈáè <span class="arithmatex">\(\mathcal{T}_{de}^{l,i}\)</span> ÁöÑ Á∫øÊÄßÊäïÂΩ±„ÄÇÔºàW ÊòØ‰ªÄ‰πàÁöÑÁº©ÂÜôÔºüÔºâ</li>
</ul>
<p>üü¢</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321172443831.png"><img alt="image-20250321172443831" src="../images/image-20250321172443831.png"/></a> </p>
<p>ÊúÄÁªàÁöÑÈ¢ÑÊµãÁªìÊûú ÊòØÂØπ‰∏§‰∏™ÂàÜËß£ÊàêÂàÜÁöÑÂä†ÂíåÔºåÂÖ¨ÂºèË°®Á§∫‰∏∫ <span class="arithmatex">\(\mathcal{W}_\mathcal{S} * \mathcal{X}_{de}^M + \mathcal{T}_{de}^M\)</span> </p>
<ul>
<li>ËøôÈáåÁöÑ <span class="arithmatex">\(\mathcal{W}\)</span> ÈÉΩË°®Á§∫Á∫øÊÄßÊäïÂΩ±„ÄÇ</li>
<li><span class="arithmatex">\(\mathcal{W}_\mathcal{S}\)</span> Â∞Ü ÊúÄÂêé‰∏ÄÂ±Ç Ëß£Á†ÅÂô®ÁöÑËæìÂá∫ ÊäïÂΩ±Âà∞ÁõÆÊ†áÁª¥Â∫¶</li>
</ul>
<blockquote>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321173400693.png"><img alt="image-20250321173400693" src="../images/image-20250321173400693.png"/></a> </p>
</blockquote>
<p>ÊàëÔºöËøô‰∏™ÂÖ¨Âºè  <span class="arithmatex">\(\mathcal{X}_{de}^{l} = \mathcal{S}_{de}^{l,3}\)</span> ‰πüÂ∞±ÊòØË°®Á§∫‰∫Ü Ëß£Á†ÅÂô®‰∏≠Êï∞ÊçÆÁöÑÁöÑÊµÅÂä®‰πüÊòØÂ≠£ËäÇÊàêÂàÜ„ÄÇ</p>
<h4 id="_13">‰ª£Á†Å<a class="headerlink" href="#_13" title="Permanent link">¬∂</a></h4>
<p><strong>Â•Ω‰∫ÜÔºåËÆ∫ÊñáÁúãÂÆå‰∫ÜÔºåÁé∞Âú®Áúã‰ª£Á†Å„ÄÇ</strong></p>
<ul>
<li>‰ªé Autoformer forward Âá∫Âèë</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321173752060.png"><img alt="image-20250321173752060" src="../images/image-20250321173752060.png"/></a></p>
<ul>
<li>ËøõÂÖ• Decoder forward</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321173851471.png"><img alt="image-20250321173851471" src="../images/image-20250321173851471.png"/></a> </p>
<ul>
<li>Decoder ÁöÑÂàùÂßãÂåñ</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321173954060.png"><img alt="image-20250321173954060" src="../images/image-20250321173954060.png"/></a></p>
<p>ÂÖ∂‰∏≠ <code>d_layers = 1</code> ÔºàÂÖ®Â±ÄÊêúÁ¥¢Ôºâ</p>
<p>ÂåÖÊã¨‰∫Ü‰∏ÄÂ±Ç DecoderLayer„ÄÅËá™Ê≥®ÊÑèÂäõÊú∫Âà∂„ÄÅ‰∫§ÂèâÊ≥®ÊÑèÂäõÊú∫Âà∂ÔºåÊúÄÂêéÁöÑÊäïÂΩ±Â±ÇÊòØ‰∏∫‰∫ÜÊääÂµåÂÖ•Áª¥Â∫¶ ËøòÂéü‰∏∫ ÂéüÂßãÁª¥Â∫¶„ÄÇ</p>
<h4 id="decoderlayer-forward">DecoderLayer  forward<a class="headerlink" href="#decoderlayer-forward" title="Permanent link">¬∂</a></h4>
<ul>
<li>Ê≠•ËøõÔºåÊûúÁÑ∂ËøõÂÖ•‰∫Ü DecoderLayer ÁöÑ forward</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321174221181.png"><img alt="image-20250321174221181" src="../images/image-20250321174221181.png"/></a> </p>
<ul>
<li>ÈÄêÊ≠•Ê≠•ËøõÊâßË°åÔºåÊûúÁÑ∂ËøõÂÖ•‰∫Ü AutoCorrelationLayer ÁöÑ forward</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321174253332.png"><img alt="image-20250321174253332" src="../images/image-20250321174253332.png"/></a> </p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØ qkv ÁöÑËÆ°ÁÆóÔºåËøôË°åÂÖ≥ÈîÆÔºå‰ºöÊ≠•ËøõÂà∞ÂÖ∑‰ΩìÁöÑ AutoCorrelationÁöÑËÆ°ÁÆó„ÄÇÁúãÁª¥Â∫¶ÔºåÂèØ‰ª•ÁúãÂà∞ËøôÈáåËøòÁî®ÁöÑ<span id="ËøîÂõûÁêÜËß£Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂"><a href="#Ë∑≥Âà∞ÁêÜËß£Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂">Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂</a></span>„ÄÇ  </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321174359890.png"><img alt="image-20250321174359890" src="../images/image-20250321174359890.png"/></a> </p>
<ul>
<li>Ê≠•ËøõÔºåÊûúÁÑ∂ Ë∑≥Âà∞‰∫Ü AutoCorrelation-forward</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321175357208.png"><img alt="image-20250321175357208" src="../images/image-20250321175357208.png"/></a> </p>
<p><strong>ÂÖ∂ÂÆûÔºåË∑≥ËøõÊù•Ê≤°Áî®ÔºåÂõ†‰∏∫ÊöÇÊó∂‰∏çÁúãËá™Áõ∏ÂÖ≥Êú∫Âà∂ÁöÑËÆ°ÁÆóÔºåËøôÊòØÊú¨ÊñáÁöÑÂàõÊñ∞„ÄÇÈÄêÊ≠•Ë∑≥Âá∫ÔºåÁúã DecoderLayer ÁöÑÂ§ÑÁêÜ„ÄÇ</strong></p>
<p>‰∏§‰∏™Ê≥®ÊÑèÂäõËÆ°ÁÆóÔºå‰∏â‰∏™Ë∂ãÂäøÂàÜËß£Ôºå‰∏Ä‰∏™ËøòÂéüÁª¥Â∫¶ÁöÑÁ∫øÊÄßÂ±Ç„ÄÇ</p>
<p><strong>DecoderLayer‰ª£Á†ÅÊâßË°åÁöÑÊµÅÁ®ãÂõæ</strong> </p>
<div class="language-markdown highlight"><span class="filename">Markdown</span><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1"></a><a href="#__codelineno-50-1"><span class="linenos" data-linenos=" 1 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2"></a><a href="#__codelineno-50-2"><span class="linenos" data-linenos=" 2 "></span></a>‚îÇ ËæìÂÖ•Â∫èÂàó x [B,L,d_model] ‚îÇ
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3"></a><a href="#__codelineno-50-3"><span class="linenos" data-linenos=" 3 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4"></a><a href="#__codelineno-50-4"><span class="linenos" data-linenos=" 4 "></span></a>               ‚Üì
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5"></a><a href="#__codelineno-50-5"><span class="linenos" data-linenos=" 5 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6"></a><a href="#__codelineno-50-6"><span class="linenos" data-linenos=" 6 "></span></a>‚îÇ     Ëá™Ê≥®ÊÑèÂäõ + ÊÆãÂ∑ÆËøûÊé•    ‚îÇ    x = x + dropout(self_attention(x,x,x))
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7"></a><a href="#__codelineno-50-7"><span class="linenos" data-linenos=" 7 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8"></a><a href="#__codelineno-50-8"><span class="linenos" data-linenos=" 8 "></span></a>               ‚Üì
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9"></a><a href="#__codelineno-50-9"><span class="linenos" data-linenos=" 9 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10"></a><a href="#__codelineno-50-10"><span class="linenos" data-linenos="10 "></span></a>‚îÇ       Â∫èÂàóÂàÜËß£ 1         ‚îÇ    x, trend1 = decomp1(x)
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11"></a><a href="#__codelineno-50-11"><span class="linenos" data-linenos="11 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12"></a><a href="#__codelineno-50-12"><span class="linenos" data-linenos="12 "></span></a>       ‚îÇ                  ‚Üò
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13"></a><a href="#__codelineno-50-13"><span class="linenos" data-linenos="13 "></span></a>       ‚îÇ                   trend1 [B,L,d_model] ‚Üí ‰øùÂ≠ò
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14"></a><a href="#__codelineno-50-14"><span class="linenos" data-linenos="14 "></span></a>       ‚Üì
</span><span id="__span-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15"></a><a href="#__codelineno-50-15"><span class="linenos" data-linenos="15 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16"></a><a href="#__codelineno-50-16"><span class="linenos" data-linenos="16 "></span></a>‚îÇ ‰∫§ÂèâÊ≥®ÊÑèÂäõ(ÁºñÁ†ÅÂô®ËæìÂá∫)     ‚îÇ    x = x + dropout(cross_attention(x,cross,cross))
</span><span id="__span-50-17"><a id="__codelineno-50-17" name="__codelineno-50-17"></a><a href="#__codelineno-50-17"><span class="linenos" data-linenos="17 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-18"><a id="__codelineno-50-18" name="__codelineno-50-18"></a><a href="#__codelineno-50-18"><span class="linenos" data-linenos="18 "></span></a>               ‚Üì
</span><span id="__span-50-19"><a id="__codelineno-50-19" name="__codelineno-50-19"></a><a href="#__codelineno-50-19"><span class="linenos" data-linenos="19 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-20"><a id="__codelineno-50-20" name="__codelineno-50-20"></a><a href="#__codelineno-50-20"><span class="linenos" data-linenos="20 "></span></a>‚îÇ       Â∫èÂàóÂàÜËß£ 2         ‚îÇ    x, trend2 = decomp2(x)
</span><span id="__span-50-21"><a id="__codelineno-50-21" name="__codelineno-50-21"></a><a href="#__codelineno-50-21"><span class="linenos" data-linenos="21 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-22"><a id="__codelineno-50-22" name="__codelineno-50-22"></a><a href="#__codelineno-50-22"><span class="linenos" data-linenos="22 "></span></a>       ‚îÇ                  ‚Üò
</span><span id="__span-50-23"><a id="__codelineno-50-23" name="__codelineno-50-23"></a><a href="#__codelineno-50-23"><span class="linenos" data-linenos="23 "></span></a>       ‚îÇ                   trend2 [B,L,d_model] ‚Üí ‰øùÂ≠ò
</span><span id="__span-50-24"><a id="__codelineno-50-24" name="__codelineno-50-24"></a><a href="#__codelineno-50-24"><span class="linenos" data-linenos="24 "></span></a>       ‚Üì
</span><span id="__span-50-25"><a id="__codelineno-50-25" name="__codelineno-50-25"></a><a href="#__codelineno-50-25"><span class="linenos" data-linenos="25 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-26"><a id="__codelineno-50-26" name="__codelineno-50-26"></a><a href="#__codelineno-50-26"><span class="linenos" data-linenos="26 "></span></a>‚îÇ        ÂâçÈ¶àÁΩëÁªú          ‚îÇ
</span><span id="__span-50-27"><a id="__codelineno-50-27" name="__codelineno-50-27"></a><a href="#__codelineno-50-27"><span class="linenos" data-linenos="27 "></span></a>‚îÇ  y=x (Â§çÂà∂Êìç‰Ωú)          ‚îÇ
</span><span id="__span-50-28"><a id="__codelineno-50-28" name="__codelineno-50-28"></a><a href="#__codelineno-50-28"><span class="linenos" data-linenos="28 "></span></a>‚îÇ  Âç∑ÁßØ1 + ÊøÄÊ¥ª + Dropout  ‚îÇ    y = dropout(activation(conv1(y.transpose)))
</span><span id="__span-50-29"><a id="__codelineno-50-29" name="__codelineno-50-29"></a><a href="#__codelineno-50-29"><span class="linenos" data-linenos="29 "></span></a>‚îÇ  Âç∑ÁßØ2 + Dropout        ‚îÇ    y = dropout(conv2(y).transpose)
</span><span id="__span-50-30"><a id="__codelineno-50-30" name="__codelineno-50-30"></a><a href="#__codelineno-50-30"><span class="linenos" data-linenos="30 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-31"><a id="__codelineno-50-31" name="__codelineno-50-31"></a><a href="#__codelineno-50-31"><span class="linenos" data-linenos="31 "></span></a>               ‚Üì
</span><span id="__span-50-32"><a id="__codelineno-50-32" name="__codelineno-50-32"></a><a href="#__codelineno-50-32"><span class="linenos" data-linenos="32 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-33"><a id="__codelineno-50-33" name="__codelineno-50-33"></a><a href="#__codelineno-50-33"><span class="linenos" data-linenos="33 "></span></a>‚îÇ ÊÆãÂ∑ÆËøûÊé• (x + y)         ‚îÇ
</span><span id="__span-50-34"><a id="__codelineno-50-34" name="__codelineno-50-34"></a><a href="#__codelineno-50-34"><span class="linenos" data-linenos="34 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-35"><a id="__codelineno-50-35" name="__codelineno-50-35"></a><a href="#__codelineno-50-35"><span class="linenos" data-linenos="35 "></span></a>               ‚Üì
</span><span id="__span-50-36"><a id="__codelineno-50-36" name="__codelineno-50-36"></a><a href="#__codelineno-50-36"><span class="linenos" data-linenos="36 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-37"><a id="__codelineno-50-37" name="__codelineno-50-37"></a><a href="#__codelineno-50-37"><span class="linenos" data-linenos="37 "></span></a>‚îÇ       Â∫èÂàóÂàÜËß£ 3         ‚îÇ    x, trend3 = decomp3(x + y)
</span><span id="__span-50-38"><a id="__codelineno-50-38" name="__codelineno-50-38"></a><a href="#__codelineno-50-38"><span class="linenos" data-linenos="38 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-39"><a id="__codelineno-50-39" name="__codelineno-50-39"></a><a href="#__codelineno-50-39"><span class="linenos" data-linenos="39 "></span></a>       ‚îÇ                  ‚Üò
</span><span id="__span-50-40"><a id="__codelineno-50-40" name="__codelineno-50-40"></a><a href="#__codelineno-50-40"><span class="linenos" data-linenos="40 "></span></a>       ‚îÇ                   trend3 [B,L,d_model] ‚Üí ‰øùÂ≠ò
</span><span id="__span-50-41"><a id="__codelineno-50-41" name="__codelineno-50-41"></a><a href="#__codelineno-50-41"><span class="linenos" data-linenos="41 "></span></a>       ‚Üì
</span><span id="__span-50-42"><a id="__codelineno-50-42" name="__codelineno-50-42"></a><a href="#__codelineno-50-42"><span class="linenos" data-linenos="42 "></span></a>       ‚îÇ
</span><span id="__span-50-43"><a id="__codelineno-50-43" name="__codelineno-50-43"></a><a href="#__codelineno-50-43"><span class="linenos" data-linenos="43 "></span></a>       ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-44"><a id="__codelineno-50-44" name="__codelineno-50-44"></a><a href="#__codelineno-50-44"><span class="linenos" data-linenos="44 "></span></a>       ‚îÇ    ‚îÇ   ÂêàÂπ∂Ë∂ãÂäø: trend1 + trend2 + trend3 ‚îÇ
</span><span id="__span-50-45"><a id="__codelineno-50-45" name="__codelineno-50-45"></a><a href="#__codelineno-50-45"><span class="linenos" data-linenos="45 "></span></a>       ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-46"><a id="__codelineno-50-46" name="__codelineno-50-46"></a><a href="#__codelineno-50-46"><span class="linenos" data-linenos="46 "></span></a>       ‚îÇ                    ‚Üì
</span><span id="__span-50-47"><a id="__codelineno-50-47" name="__codelineno-50-47"></a><a href="#__codelineno-50-47"><span class="linenos" data-linenos="47 "></span></a>       ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-48"><a id="__codelineno-50-48" name="__codelineno-50-48"></a><a href="#__codelineno-50-48"><span class="linenos" data-linenos="48 "></span></a>       ‚îÇ    ‚îÇ   Ë∂ãÂäøÊäïÂΩ± (Áª¥Â∫¶Ë∞ÉÊï¥)               ‚îÇ    residual_trend = projection(residual_trend)
</span><span id="__span-50-49"><a id="__codelineno-50-49" name="__codelineno-50-49"></a><a href="#__codelineno-50-49"><span class="linenos" data-linenos="49 "></span></a>       ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-50-50"><a id="__codelineno-50-50" name="__codelineno-50-50"></a><a href="#__codelineno-50-50"><span class="linenos" data-linenos="50 "></span></a>       ‚îÇ                    ‚Üì
</span><span id="__span-50-51"><a id="__codelineno-50-51" name="__codelineno-50-51"></a><a href="#__codelineno-50-51"><span class="linenos" data-linenos="51 "></span></a>       ‚îÇ                    ‚îÇ
</span><span id="__span-50-52"><a id="__codelineno-50-52" name="__codelineno-50-52"></a><a href="#__codelineno-50-52"><span class="linenos" data-linenos="52 "></span></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-50-53"><a id="__codelineno-50-53" name="__codelineno-50-53"></a><a href="#__codelineno-50-53"><span class="linenos" data-linenos="53 "></span></a>‚îÇ Â≠£ËäÇÊÄßËæìÂá∫ x   ‚îÇ  ‚îÇ Ë∂ãÂäøËæìÂá∫         ‚îÇ
</span><span id="__span-50-54"><a id="__codelineno-50-54" name="__codelineno-50-54"></a><a href="#__codelineno-50-54"><span class="linenos" data-linenos="54 "></span></a>‚îÇ [B,L,d_model] ‚îÇ  ‚îÇ [B,L,c_out]      ‚îÇ
</span><span id="__span-50-55"><a id="__codelineno-50-55" name="__codelineno-50-55"></a><a href="#__codelineno-50-55"><span class="linenos" data-linenos="55 "></span></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span></code></pre></div>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ‰∏∫‰ªÄ‰πàÂè™ÂØπË∂ãÂäøÊàêÂàÜËøõË°åÊäïÂΩ±ÔºüÔºàÁ≠îÔºöÈÉΩÊäïÂΩ±‰∫ÜÔºåÂè™ÊòØ‰ΩçÁΩÆ‰∏çÂêåÔºâ</li>
</ul>
<blockquote>
<p>ÈÄöËøáÊäïÂΩ±Â±ÇÂ∞ÜË∂ãÂäøÁª¥Â∫¶‰ªéd_modelË∞ÉÊï¥‰∏∫c_out(ËæìÂá∫ÁâπÂæÅÁª¥Â∫¶)</p>
<p>È¶ñÂÖàÔºåÈúÄË¶ÅÊòéÁ°ÆÔºåË∂ãÂäøÊàêÂàÜÂíåÂ≠£ËäÇÊàêÂàÜÊúÄÂêéÈÉΩÈúÄË¶Å ‰ªé <code>d_model</code> ËøòÂéü‰∏∫ <code>feature dim</code> ‰πüÂ∞±ÊòØÂéüÂßãÁöÑÊï∞ÊçÆÁª¥Â∫¶Ôºå‰ΩÜÊòØËøôÈáåË∂ãÂäøÊàêÂàÜÂíåÂ≠£ËäÇÊàêÂàÜËøòÂéüÁöÑ‰ΩçÁΩÆ‰∏çÂêåÔºåÊñπÂºè‰∏çÂêå„ÄÇ</p>
<p><strong>Á¨¨‰∏Ä‰∏™ËøòÂéü‰ΩçÁΩÆ</strong></p>
<p>‚ë† È¶ñÂÖàÊòéÁ°Æ Decoder Ë∞ÉÁî® DecoderLayer ËøõË°åÂçï‰∏™Ëß£Á†ÅÂô®ÁöÑÂ§ÑÁêÜ</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1"></a><a href="#__codelineno-51-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># ËøîÂõûÂ≠£ËäÇÊÄßÊàêÂàÜ(‰∏çËøõË°åÊäïÂΩ±)ÂíåÊäïÂΩ±ÂêéÁöÑË∂ãÂäøÊàêÂàÜ</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2"></a><a href="#__codelineno-51-2"><span class="linenos" data-linenos="2 "></span></a><span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">residual_trend</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3"></a><a href="#__codelineno-51-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># x: [B, L, d_model], residual_trend: [B, L, c_out]</span>
</span></code></pre></div>
<p>Âçï‰∏™ DecoderLayer ËøîÂõûÁöÑÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜÁöÑÁª¥Â∫¶Â∞±ÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ</p>
<p>‚ë° Â≠£ËäÇÊàêÂàÜÂú® Decoder ‰∏≠ËøòÂéüÁª¥Â∫¶ÔºåÈÄöËøá if Âà§Êñ≠</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1"></a><a href="#__codelineno-52-1"><span class="linenos" data-linenos="1 "></span></a>        <span class="c1"># Â¶ÇÊûúÂ≠òÂú®ÊäïÂΩ±Â±ÇÔºåÂàôÂØπËæìÂá∫ËøõË°åÊäïÂΩ±Â§ÑÁêÜ</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2"></a><a href="#__codelineno-52-2"><span class="linenos" data-linenos="2 "></span></a>        <span class="c1"># x[B, L, d_model] -&gt; Linear -&gt; x[B, L, c_out]</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3"></a><a href="#__codelineno-52-3"><span class="linenos" data-linenos="3 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4"></a><a href="#__codelineno-52-4"><span class="linenos" data-linenos="4 "></span></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ÈÇ£ÂÖ∑‰Ωì‰ªÄ‰πàÊó∂ÂÄôËß¶ÂèëÂë¢ÔºüÊØèÊ¨° DecoderLayer ÊâßË°åÂÆåÔºüËøòÊòØÊâÄÊúâ DecoderLayer ÊúÄÁªàÊâßË°åÂÆåÔºü ÂõûÁ≠îÔºöÂêéËÄÖÔºåÁêÜÁî±Ôºö</li>
</ul>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1"></a><a href="#__codelineno-53-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cross</span><span class="p">,</span> <span class="n">x_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cross_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2"></a><a href="#__codelineno-53-2"><span class="linenos" data-linenos=" 2 "></span></a>    <span class="c1"># ÈÅçÂéÜÊØè‰∏™Ëß£Á†ÅÂô®Â±ÇÔºåÂ§ÑÁêÜËæìÂÖ•Â∫èÂàóxÂíå‰∫§ÂèâÂ∫èÂàócross</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3"></a><a href="#__codelineno-53-3"><span class="linenos" data-linenos=" 3 "></span></a>    <span class="c1"># x[B, L, d_model] -&gt; DecoderLayer.forward -&gt; x[B, L, d_model], residual_trend[B, L, c_out]</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4"></a><a href="#__codelineno-53-4"><span class="linenos" data-linenos=" 4 "></span></a>    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5"></a><a href="#__codelineno-53-5"><span class="linenos" data-linenos=" 5 "></span></a>        <span class="c1"># Ë∞ÉÁî®Ëß£Á†ÅÂô®Â±ÇÁöÑÂâçÂêë‰º†Êí≠ÊñπÊ≥ïÔºåÊõ¥Êñ∞xÂíåÊÆãÂ∑ÆË∂ãÂäø</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6"></a><a href="#__codelineno-53-6"><span class="linenos" data-linenos=" 6 "></span></a>        <span class="c1"># x[B, L, d_model], cross[B, L, d_model] -&gt; DecoderLayer.forward -&gt; x[B, L, d_model], residual_trend[B, L, c_out]</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7"></a><a href="#__codelineno-53-7"><span class="linenos" data-linenos=" 7 "></span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">residual_trend</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cross</span><span class="p">,</span> <span class="n">x_mask</span><span class="o">=</span><span class="n">x_mask</span><span class="p">,</span> <span class="n">cross_mask</span><span class="o">=</span><span class="n">cross_mask</span><span class="p">)</span>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8"></a><a href="#__codelineno-53-8"><span class="linenos" data-linenos=" 8 "></span></a>        <span class="c1"># Êõ¥Êñ∞Ë∂ãÂäø‰ø°ÊÅØÔºåÂ∞ÜÊÆãÂ∑ÆË∂ãÂäøÊ∑ªÂä†Âà∞ÂΩìÂâçË∂ãÂäø</span>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9"></a><a href="#__codelineno-53-9"><span class="linenos" data-linenos=" 9 "></span></a>        <span class="c1"># trend[B, L, c_out] + residual_trend[B, L, c_out] -&gt; trend[B, L, c_out]</span>
</span><span id="__span-53-10"><a id="__codelineno-53-10" name="__codelineno-53-10"></a><a href="#__codelineno-53-10"><span class="linenos" data-linenos="10 "></span></a>        <span class="n">trend</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">residual_trend</span>
</span><span id="__span-53-11"><a id="__codelineno-53-11" name="__codelineno-53-11"></a><a href="#__codelineno-53-11"><span class="linenos" data-linenos="11 "></span></a>
</span><span id="__span-53-12"><a id="__codelineno-53-12" name="__codelineno-53-12"></a><a href="#__codelineno-53-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="c1"># Â¶ÇÊûúÂ≠òÂú®ÂΩí‰∏ÄÂåñÂ±ÇÔºåÂàôÂØπËæìÂá∫ËøõË°åÂΩí‰∏ÄÂåñÂ§ÑÁêÜ</span>
</span><span id="__span-53-13"><a id="__codelineno-53-13" name="__codelineno-53-13"></a><a href="#__codelineno-53-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="c1"># x[B, L, d_model] -&gt; LayerNorm -&gt; x[B, L, d_model]</span>
</span><span id="__span-53-14"><a id="__codelineno-53-14" name="__codelineno-53-14"></a><a href="#__codelineno-53-14"><span class="linenos" data-linenos="14 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-53-15"><a id="__codelineno-53-15" name="__codelineno-53-15"></a><a href="#__codelineno-53-15"><span class="linenos" data-linenos="15 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-53-16"><a id="__codelineno-53-16" name="__codelineno-53-16"></a><a href="#__codelineno-53-16"><span class="linenos" data-linenos="16 "></span></a>
</span><span id="__span-53-17"><a id="__codelineno-53-17" name="__codelineno-53-17"></a><a href="#__codelineno-53-17"><span class="linenos" data-linenos="17 "></span></a>    <span class="c1"># Â¶ÇÊûúÂ≠òÂú®ÊäïÂΩ±Â±ÇÔºåÂàôÂØπËæìÂá∫ËøõË°åÊäïÂΩ±Â§ÑÁêÜ</span>
</span><span id="__span-53-18"><a id="__codelineno-53-18" name="__codelineno-53-18"></a><a href="#__codelineno-53-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="c1"># x[B, L, d_model] -&gt; Linear -&gt; x[B, L, c_out]</span>
</span><span id="__span-53-19"><a id="__codelineno-53-19" name="__codelineno-53-19"></a><a href="#__codelineno-53-19"><span class="linenos" data-linenos="19 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-53-20"><a id="__codelineno-53-20" name="__codelineno-53-20"></a><a href="#__codelineno-53-20"><span class="linenos" data-linenos="20 "></span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
<p>for Âæ™ÁéØÊòØ‰∏∫Âæ™ÁéØ DecoderLayerÔºåDecoderLayer ÊâßË°åÂÆå‰∫ÜÔºåÂ∞±ÊòØÊúÄÂêéÁöÑÂ§ÑÁêÜ‰∫Ü„ÄÇ</p>
</blockquote>
<h4 id="_14">Êï∞ÊçÆÊµÅÂä®Âõæ<a class="headerlink" href="#_14" title="Permanent link">¬∂</a></h4>
<blockquote>
<p>‚ë¢ Ë∂ãÂäøÊàêÂàÜ Âú®ÊØèÊ¨° DecoderLayer  forward ÁöÑÊúÄÂêéÂ∞±‰ºöËøõË°åËøòÂéüÁª¥Â∫¶</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250322100529812.png"><img alt="image-20250322100529812" src="../images/image-20250322100529812.png"/></a></p>
<p><strong>ÁîªÂõæÁõ¥ËßÇÁêÜËß£ Decoder Âíå DecoderLayer ‰∏≠ÂÖ≥‰∫éÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜÁöÑÁêÜËß£</strong></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1"></a><a href="#__codelineno-54-1"><span class="linenos" data-linenos="  1 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2"></a><a href="#__codelineno-54-2"><span class="linenos" data-linenos="  2 "></span></a><span class="err">‚îÇ</span>                         <span class="n">Decoder</span><span class="o">.</span><span class="n">forward</span>                              <span class="err">‚îÇ</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3"></a><a href="#__codelineno-54-3"><span class="linenos" data-linenos="  3 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4"></a><a href="#__codelineno-54-4"><span class="linenos" data-linenos="  4 "></span></a>                                 <span class="err">‚Üì</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5"></a><a href="#__codelineno-54-5"><span class="linenos" data-linenos="  5 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6"></a><a href="#__codelineno-54-6"><span class="linenos" data-linenos="  6 "></span></a><span class="err">‚îÇ</span>  <span class="n">ËæìÂÖ•</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">],</span> <span class="n">cross</span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">],</span> <span class="n">trend</span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">],</span> <span class="n">masks</span>            <span class="err">‚îÇ</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7"></a><a href="#__codelineno-54-7"><span class="linenos" data-linenos="  7 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8"></a><a href="#__codelineno-54-8"><span class="linenos" data-linenos="  8 "></span></a>                                 <span class="err">‚Üì</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9"></a><a href="#__codelineno-54-9"><span class="linenos" data-linenos="  9 "></span></a>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10"></a><a href="#__codelineno-54-10"><span class="linenos" data-linenos=" 10 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span> <span class="n">DecoderLayer</span> <span class="mi">1</span> <span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11"></a><a href="#__codelineno-54-11"><span class="linenos" data-linenos=" 11 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12"></a><a href="#__codelineno-54-12"><span class="linenos" data-linenos=" 12 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span> <span class="n">ËæìÂÖ•Â∫èÂàó</span> <span class="n">x</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span> <span class="err">‚îÇ</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13"></a><a href="#__codelineno-54-13"><span class="linenos" data-linenos=" 13 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14"></a><a href="#__codelineno-54-14"><span class="linenos" data-linenos=" 14 "></span></a><span class="err">‚îÇ</span>                 <span class="err">‚Üì</span>                                                                         <span class="err">‚îÇ</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15"></a><a href="#__codelineno-54-15"><span class="linenos" data-linenos=" 15 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16"></a><a href="#__codelineno-54-16"><span class="linenos" data-linenos=" 16 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>   <span class="n">Ëá™Ê≥®ÊÑèÂäõ</span> <span class="o">+</span> <span class="n">ÊÆãÂ∑ÆËøûÊé•</span>     <span class="err">‚îÇ</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dropout</span><span class="p">(</span><span class="n">self_attention</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>                    <span class="err">‚îÇ</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17"></a><a href="#__codelineno-54-17"><span class="linenos" data-linenos=" 17 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18"></a><a href="#__codelineno-54-18"><span class="linenos" data-linenos=" 18 "></span></a><span class="err">‚îÇ</span>                 <span class="err">‚Üì</span>                                                                         <span class="err">‚îÇ</span>
</span><span id="__span-54-19"><a id="__codelineno-54-19" name="__codelineno-54-19"></a><a href="#__codelineno-54-19"><span class="linenos" data-linenos=" 19 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-20"><a id="__codelineno-54-20" name="__codelineno-54-20"></a><a href="#__codelineno-54-20"><span class="linenos" data-linenos=" 20 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>       <span class="n">Â∫èÂàóÂàÜËß£</span> <span class="mi">1</span>         <span class="err">‚îÇ</span>    <span class="n">x</span><span class="p">,</span> <span class="n">trend1</span> <span class="o">=</span> <span class="n">decomp1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                    <span class="err">‚îÇ</span>
</span><span id="__span-54-21"><a id="__codelineno-54-21" name="__codelineno-54-21"></a><a href="#__codelineno-54-21"><span class="linenos" data-linenos=" 21 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-22"><a id="__codelineno-54-22" name="__codelineno-54-22"></a><a href="#__codelineno-54-22"><span class="linenos" data-linenos=" 22 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                  <span class="err">‚Üò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-23"><a id="__codelineno-54-23" name="__codelineno-54-23"></a><a href="#__codelineno-54-23"><span class="linenos" data-linenos=" 23 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                   <span class="n">trend1</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="n">‰øùÂ≠ò</span>                                    <span class="err">‚îÇ</span>
</span><span id="__span-54-24"><a id="__codelineno-54-24" name="__codelineno-54-24"></a><a href="#__codelineno-54-24"><span class="linenos" data-linenos=" 24 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚Üì</span>                                                                                 <span class="err">‚îÇ</span>
</span><span id="__span-54-25"><a id="__codelineno-54-25" name="__codelineno-54-25"></a><a href="#__codelineno-54-25"><span class="linenos" data-linenos=" 25 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-26"><a id="__codelineno-54-26" name="__codelineno-54-26"></a><a href="#__codelineno-54-26"><span class="linenos" data-linenos=" 26 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span> <span class="n">‰∫§ÂèâÊ≥®ÊÑèÂäõ</span><span class="p">(</span><span class="n">ÁºñÁ†ÅÂô®ËæìÂá∫</span><span class="p">)</span>     <span class="err">‚îÇ</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dropout</span><span class="p">(</span><span class="n">cross_attention</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">cross</span><span class="p">,</span><span class="n">cross</span><span class="p">))</span>          <span class="err">‚îÇ</span>
</span><span id="__span-54-27"><a id="__codelineno-54-27" name="__codelineno-54-27"></a><a href="#__codelineno-54-27"><span class="linenos" data-linenos=" 27 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-28"><a id="__codelineno-54-28" name="__codelineno-54-28"></a><a href="#__codelineno-54-28"><span class="linenos" data-linenos=" 28 "></span></a><span class="err">‚îÇ</span>                 <span class="err">‚Üì</span>                                                                         <span class="err">‚îÇ</span>
</span><span id="__span-54-29"><a id="__codelineno-54-29" name="__codelineno-54-29"></a><a href="#__codelineno-54-29"><span class="linenos" data-linenos=" 29 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-30"><a id="__codelineno-54-30" name="__codelineno-54-30"></a><a href="#__codelineno-54-30"><span class="linenos" data-linenos=" 30 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>       <span class="n">Â∫èÂàóÂàÜËß£</span> <span class="mi">2</span>         <span class="err">‚îÇ</span>    <span class="n">x</span><span class="p">,</span> <span class="n">trend2</span> <span class="o">=</span> <span class="n">decomp2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                    <span class="err">‚îÇ</span>
</span><span id="__span-54-31"><a id="__codelineno-54-31" name="__codelineno-54-31"></a><a href="#__codelineno-54-31"><span class="linenos" data-linenos=" 31 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-32"><a id="__codelineno-54-32" name="__codelineno-54-32"></a><a href="#__codelineno-54-32"><span class="linenos" data-linenos=" 32 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                  <span class="err">‚Üò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-33"><a id="__codelineno-54-33" name="__codelineno-54-33"></a><a href="#__codelineno-54-33"><span class="linenos" data-linenos=" 33 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                   <span class="n">trend2</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="n">‰øùÂ≠ò</span>                                    <span class="err">‚îÇ</span>
</span><span id="__span-54-34"><a id="__codelineno-54-34" name="__codelineno-54-34"></a><a href="#__codelineno-54-34"><span class="linenos" data-linenos=" 34 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚Üì</span>                                                                                 <span class="err">‚îÇ</span>
</span><span id="__span-54-35"><a id="__codelineno-54-35" name="__codelineno-54-35"></a><a href="#__codelineno-54-35"><span class="linenos" data-linenos=" 35 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-36"><a id="__codelineno-54-36" name="__codelineno-54-36"></a><a href="#__codelineno-54-36"><span class="linenos" data-linenos=" 36 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>        <span class="n">ÂâçÈ¶àÁΩëÁªú</span>          <span class="err">‚îÇ</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-37"><a id="__codelineno-54-37" name="__codelineno-54-37"></a><a href="#__codelineno-54-37"><span class="linenos" data-linenos=" 37 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>  <span class="n">y</span><span class="o">=</span><span class="n">x</span> <span class="p">(</span><span class="n">Â§çÂà∂Êìç‰Ωú</span><span class="p">)</span>          <span class="err">‚îÇ</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-38"><a id="__codelineno-54-38" name="__codelineno-54-38"></a><a href="#__codelineno-54-38"><span class="linenos" data-linenos=" 38 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>  <span class="n">Âç∑ÁßØ1</span> <span class="o">+</span> <span class="n">ÊøÄÊ¥ª</span> <span class="o">+</span> <span class="n">Dropout</span>  <span class="err">‚îÇ</span>    <span class="n">y</span> <span class="o">=</span> <span class="n">dropout</span><span class="p">(</span><span class="n">activation</span><span class="p">(</span><span class="n">conv1</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">)))</span>              <span class="err">‚îÇ</span>
</span><span id="__span-54-39"><a id="__codelineno-54-39" name="__codelineno-54-39"></a><a href="#__codelineno-54-39"><span class="linenos" data-linenos=" 39 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>  <span class="n">Âç∑ÁßØ2</span> <span class="o">+</span> <span class="n">Dropout</span>        <span class="err">‚îÇ</span>    <span class="n">y</span> <span class="o">=</span> <span class="n">dropout</span><span class="p">(</span><span class="n">conv2</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">)</span>                          <span class="err">‚îÇ</span>
</span><span id="__span-54-40"><a id="__codelineno-54-40" name="__codelineno-54-40"></a><a href="#__codelineno-54-40"><span class="linenos" data-linenos=" 40 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-41"><a id="__codelineno-54-41" name="__codelineno-54-41"></a><a href="#__codelineno-54-41"><span class="linenos" data-linenos=" 41 "></span></a><span class="err">‚îÇ</span>                 <span class="err">‚Üì</span>                                                                         <span class="err">‚îÇ</span>
</span><span id="__span-54-42"><a id="__codelineno-54-42" name="__codelineno-54-42"></a><a href="#__codelineno-54-42"><span class="linenos" data-linenos=" 42 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-43"><a id="__codelineno-54-43" name="__codelineno-54-43"></a><a href="#__codelineno-54-43"><span class="linenos" data-linenos=" 43 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span> <span class="n">ÊÆãÂ∑ÆËøûÊé•</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>         <span class="err">‚îÇ</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-44"><a id="__codelineno-54-44" name="__codelineno-54-44"></a><a href="#__codelineno-54-44"><span class="linenos" data-linenos=" 44 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-45"><a id="__codelineno-54-45" name="__codelineno-54-45"></a><a href="#__codelineno-54-45"><span class="linenos" data-linenos=" 45 "></span></a><span class="err">‚îÇ</span>                 <span class="err">‚Üì</span>                                                                         <span class="err">‚îÇ</span>
</span><span id="__span-54-46"><a id="__codelineno-54-46" name="__codelineno-54-46"></a><a href="#__codelineno-54-46"><span class="linenos" data-linenos=" 46 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-47"><a id="__codelineno-54-47" name="__codelineno-54-47"></a><a href="#__codelineno-54-47"><span class="linenos" data-linenos=" 47 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span>       <span class="n">Â∫èÂàóÂàÜËß£</span> <span class="mi">3</span>         <span class="err">‚îÇ</span>    <span class="n">x</span><span class="p">,</span> <span class="n">trend3</span> <span class="o">=</span> <span class="n">decomp3</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>                                <span class="err">‚îÇ</span>
</span><span id="__span-54-48"><a id="__codelineno-54-48" name="__codelineno-54-48"></a><a href="#__codelineno-54-48"><span class="linenos" data-linenos=" 48 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-49"><a id="__codelineno-54-49" name="__codelineno-54-49"></a><a href="#__codelineno-54-49"><span class="linenos" data-linenos=" 49 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                  <span class="err">‚Üò</span>                                                              <span class="err">‚îÇ</span>
</span><span id="__span-54-50"><a id="__codelineno-54-50" name="__codelineno-54-50"></a><a href="#__codelineno-54-50"><span class="linenos" data-linenos=" 50 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                   <span class="n">trend3</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="n">‰øùÂ≠ò</span>                                    <span class="err">‚îÇ</span>
</span><span id="__span-54-51"><a id="__codelineno-54-51" name="__codelineno-54-51"></a><a href="#__codelineno-54-51"><span class="linenos" data-linenos=" 51 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                                                                                 <span class="err">‚îÇ</span>
</span><span id="__span-54-52"><a id="__codelineno-54-52" name="__codelineno-54-52"></a><a href="#__codelineno-54-52"><span class="linenos" data-linenos=" 52 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>    <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                      <span class="err">‚îÇ</span>
</span><span id="__span-54-53"><a id="__codelineno-54-53" name="__codelineno-54-53"></a><a href="#__codelineno-54-53"><span class="linenos" data-linenos=" 53 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>    <span class="err">‚îÇ</span> <span class="n">Á¥ØÂä†Ë∂ãÂäø</span><span class="p">:</span> <span class="n">trend1</span> <span class="o">+</span> <span class="n">trend2</span> <span class="o">+</span> <span class="n">trend3</span>   <span class="err">‚îÇ</span>     <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span>                    <span class="err">‚îÇ</span>
</span><span id="__span-54-54"><a id="__codelineno-54-54" name="__codelineno-54-54"></a><a href="#__codelineno-54-54"><span class="linenos" data-linenos=" 54 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>    <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                      <span class="err">‚îÇ</span>
</span><span id="__span-54-55"><a id="__codelineno-54-55" name="__codelineno-54-55"></a><a href="#__codelineno-54-55"><span class="linenos" data-linenos=" 55 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                    <span class="err">‚Üì</span>                                                            <span class="err">‚îÇ</span>
</span><span id="__span-54-56"><a id="__codelineno-54-56" name="__codelineno-54-56"></a><a href="#__codelineno-54-56"><span class="linenos" data-linenos=" 56 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>    <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                      <span class="err">‚îÇ</span>
</span><span id="__span-54-57"><a id="__codelineno-54-57" name="__codelineno-54-57"></a><a href="#__codelineno-54-57"><span class="linenos" data-linenos=" 57 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>    <span class="err">‚îÇ</span> <span class="n">Ë∂ãÂäøÊäïÂΩ±</span><span class="p">:</span> <span class="n">Âç∑ÁßØ</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>    <span class="err">‚îÇ</span>     <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>      <span class="err">‚îÇ</span>
</span><span id="__span-54-58"><a id="__codelineno-54-58" name="__codelineno-54-58"></a><a href="#__codelineno-54-58"><span class="linenos" data-linenos=" 58 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>    <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                      <span class="err">‚îÇ</span>
</span><span id="__span-54-59"><a id="__codelineno-54-59" name="__codelineno-54-59"></a><a href="#__codelineno-54-59"><span class="linenos" data-linenos=" 59 "></span></a><span class="err">‚îÇ</span>         <span class="err">‚îÇ</span>                    <span class="err">‚Üì</span>                                                            <span class="err">‚îÇ</span>
</span><span id="__span-54-60"><a id="__codelineno-54-60" name="__codelineno-54-60"></a><a href="#__codelineno-54-60"><span class="linenos" data-linenos=" 60 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>    <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                                                <span class="err">‚îÇ</span>
</span><span id="__span-54-61"><a id="__codelineno-54-61" name="__codelineno-54-61"></a><a href="#__codelineno-54-61"><span class="linenos" data-linenos=" 61 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span> <span class="n">Â≠£ËäÇÊÄßËæìÂá∫</span> <span class="n">x</span>   <span class="err">‚îÇ</span>    <span class="err">‚îÇ</span> <span class="n">Ë∂ãÂäøËæìÂá∫</span> <span class="n">residual_trend</span> <span class="err">‚îÇ</span>                                         <span class="err">‚îÇ</span>
</span><span id="__span-54-62"><a id="__codelineno-54-62" name="__codelineno-54-62"></a><a href="#__codelineno-54-62"><span class="linenos" data-linenos=" 62 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îÇ</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span> <span class="err">‚îÇ</span>    <span class="err">‚îÇ</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>       <span class="err">‚îÇ</span>                                                <span class="err">‚îÇ</span>
</span><span id="__span-54-63"><a id="__codelineno-54-63" name="__codelineno-54-63"></a><a href="#__codelineno-54-63"><span class="linenos" data-linenos=" 63 "></span></a><span class="err">‚îÇ</span>  <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>    <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                                                <span class="err">‚îÇ</span>
</span><span id="__span-54-64"><a id="__codelineno-54-64" name="__codelineno-54-64"></a><a href="#__codelineno-54-64"><span class="linenos" data-linenos=" 64 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-65"><a id="__codelineno-54-65" name="__codelineno-54-65"></a><a href="#__codelineno-54-65"><span class="linenos" data-linenos=" 65 "></span></a>           <span class="err">‚îÇ</span>                     <span class="err">‚Üì</span>
</span><span id="__span-54-66"><a id="__codelineno-54-66" name="__codelineno-54-66"></a><a href="#__codelineno-54-66"><span class="linenos" data-linenos=" 66 "></span></a>           <span class="err">‚îÇ</span>             <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-67"><a id="__codelineno-54-67" name="__codelineno-54-67"></a><a href="#__codelineno-54-67"><span class="linenos" data-linenos=" 67 "></span></a>           <span class="err">‚îÇ</span>             <span class="err">‚îÇ</span> <span class="n">Decoder‰∏≠Á¥ØÁßØË∂ãÂäø</span>   <span class="err">‚îÇ</span>     <span class="n">trend</span> <span class="o">+=</span> <span class="n">residual_trend</span>
</span><span id="__span-54-68"><a id="__codelineno-54-68" name="__codelineno-54-68"></a><a href="#__codelineno-54-68"><span class="linenos" data-linenos=" 68 "></span></a>           <span class="err">‚îÇ</span>             <span class="err">‚îÇ</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>        <span class="err">‚îÇ</span>     <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>
</span><span id="__span-54-69"><a id="__codelineno-54-69" name="__codelineno-54-69"></a><a href="#__codelineno-54-69"><span class="linenos" data-linenos=" 69 "></span></a>           <span class="err">‚îÇ</span>             <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-70"><a id="__codelineno-54-70" name="__codelineno-54-70"></a><a href="#__codelineno-54-70"><span class="linenos" data-linenos=" 70 "></span></a>           <span class="err">‚Üì</span>                       <span class="err">‚Üì</span>
</span><span id="__span-54-71"><a id="__codelineno-54-71" name="__codelineno-54-71"></a><a href="#__codelineno-54-71"><span class="linenos" data-linenos=" 71 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>    <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-72"><a id="__codelineno-54-72" name="__codelineno-54-72"></a><a href="#__codelineno-54-72"><span class="linenos" data-linenos=" 72 "></span></a><span class="err">‚îÇ</span>  <span class="n">x‰º†ÂÖ•‰∏ã‰∏ÄÂ±Ç</span>        <span class="err">‚îÇ</span>    <span class="err">‚îÇ</span>  <span class="n">trend‰º†ÂÖ•‰∏ã‰∏ÄÂ±Ç</span>    <span class="err">‚îÇ</span>
</span><span id="__span-54-73"><a id="__codelineno-54-73" name="__codelineno-54-73"></a><a href="#__codelineno-54-73"><span class="linenos" data-linenos=" 73 "></span></a><span class="err">‚îÇ</span>  <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span>     <span class="err">‚îÇ</span>    <span class="err">‚îÇ</span>  <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>       <span class="err">‚îÇ</span>
</span><span id="__span-54-74"><a id="__codelineno-54-74" name="__codelineno-54-74"></a><a href="#__codelineno-54-74"><span class="linenos" data-linenos=" 74 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>    <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-75"><a id="__codelineno-54-75" name="__codelineno-54-75"></a><a href="#__codelineno-54-75"><span class="linenos" data-linenos=" 75 "></span></a>         <span class="err">‚Üì</span>                           <span class="err">‚Üì</span>
</span><span id="__span-54-76"><a id="__codelineno-54-76" name="__codelineno-54-76"></a><a href="#__codelineno-54-76"><span class="linenos" data-linenos=" 76 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-77"><a id="__codelineno-54-77" name="__codelineno-54-77"></a><a href="#__codelineno-54-77"><span class="linenos" data-linenos=" 77 "></span></a><span class="err">‚îÇ</span>                         <span class="n">DecoderLayer</span> <span class="mi">2</span>                             <span class="err">‚îÇ</span>
</span><span id="__span-54-78"><a id="__codelineno-54-78" name="__codelineno-54-78"></a><a href="#__codelineno-54-78"><span class="linenos" data-linenos=" 78 "></span></a><span class="err">‚îÇ</span>                          <span class="p">(</span><span class="n">ÈáçÂ§çÊµÅÁ®ã</span><span class="p">)</span>                                 <span class="err">‚îÇ</span>
</span><span id="__span-54-79"><a id="__codelineno-54-79" name="__codelineno-54-79"></a><a href="#__codelineno-54-79"><span class="linenos" data-linenos=" 79 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-80"><a id="__codelineno-54-80" name="__codelineno-54-80"></a><a href="#__codelineno-54-80"><span class="linenos" data-linenos=" 80 "></span></a>         <span class="err">‚Üì</span>                                   <span class="err">‚Üì</span>
</span><span id="__span-54-81"><a id="__codelineno-54-81" name="__codelineno-54-81"></a><a href="#__codelineno-54-81"><span class="linenos" data-linenos=" 81 "></span></a>         <span class="o">.</span>                                   <span class="o">.</span>
</span><span id="__span-54-82"><a id="__codelineno-54-82" name="__codelineno-54-82"></a><a href="#__codelineno-54-82"><span class="linenos" data-linenos=" 82 "></span></a>         <span class="o">.</span>                                   <span class="o">.</span>
</span><span id="__span-54-83"><a id="__codelineno-54-83" name="__codelineno-54-83"></a><a href="#__codelineno-54-83"><span class="linenos" data-linenos=" 83 "></span></a>         <span class="err">‚Üì</span>                                   <span class="err">‚Üì</span>
</span><span id="__span-54-84"><a id="__codelineno-54-84" name="__codelineno-54-84"></a><a href="#__codelineno-54-84"><span class="linenos" data-linenos=" 84 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-85"><a id="__codelineno-54-85" name="__codelineno-54-85"></a><a href="#__codelineno-54-85"><span class="linenos" data-linenos=" 85 "></span></a><span class="err">‚îÇ</span>                         <span class="n">DecoderLayer</span> <span class="n">N</span>                             <span class="err">‚îÇ</span>
</span><span id="__span-54-86"><a id="__codelineno-54-86" name="__codelineno-54-86"></a><a href="#__codelineno-54-86"><span class="linenos" data-linenos=" 86 "></span></a><span class="err">‚îÇ</span>                          <span class="p">(</span><span class="n">ÈáçÂ§çÊµÅÁ®ã</span><span class="p">)</span>                                 <span class="err">‚îÇ</span>
</span><span id="__span-54-87"><a id="__codelineno-54-87" name="__codelineno-54-87"></a><a href="#__codelineno-54-87"><span class="linenos" data-linenos=" 87 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-88"><a id="__codelineno-54-88" name="__codelineno-54-88"></a><a href="#__codelineno-54-88"><span class="linenos" data-linenos=" 88 "></span></a>         <span class="err">‚Üì</span>                                   <span class="err">‚Üì</span>
</span><span id="__span-54-89"><a id="__codelineno-54-89" name="__codelineno-54-89"></a><a href="#__codelineno-54-89"><span class="linenos" data-linenos=" 89 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>             <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-90"><a id="__codelineno-54-90" name="__codelineno-54-90"></a><a href="#__codelineno-54-90"><span class="linenos" data-linenos=" 90 "></span></a><span class="err">‚îÇ</span>  <span class="n">ÊúÄÁªàÂ≠£ËäÇÊÄß</span> <span class="n">x</span>       <span class="err">‚îÇ</span>             <span class="err">‚îÇ</span>  <span class="n">Á¥ØÁßØË∂ãÂäø</span> <span class="n">trend</span>     <span class="err">‚îÇ</span>
</span><span id="__span-54-91"><a id="__codelineno-54-91" name="__codelineno-54-91"></a><a href="#__codelineno-54-91"><span class="linenos" data-linenos=" 91 "></span></a><span class="err">‚îÇ</span>  <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span>     <span class="err">‚îÇ</span>             <span class="err">‚îÇ</span>  <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>       <span class="err">‚îÇ</span>
</span><span id="__span-54-92"><a id="__codelineno-54-92" name="__codelineno-54-92"></a><a href="#__codelineno-54-92"><span class="linenos" data-linenos=" 92 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>             <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span><span id="__span-54-93"><a id="__codelineno-54-93" name="__codelineno-54-93"></a><a href="#__codelineno-54-93"><span class="linenos" data-linenos=" 93 "></span></a>         <span class="err">‚Üì</span>                                    <span class="err">‚îÇ</span>
</span><span id="__span-54-94"><a id="__codelineno-54-94" name="__codelineno-54-94"></a><a href="#__codelineno-54-94"><span class="linenos" data-linenos=" 94 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                        <span class="err">‚îÇ</span>
</span><span id="__span-54-95"><a id="__codelineno-54-95" name="__codelineno-54-95"></a><a href="#__codelineno-54-95"><span class="linenos" data-linenos=" 95 "></span></a><span class="err">‚îÇ</span> <span class="n">ÂΩí‰∏ÄÂåñ</span><span class="p">(</span><span class="n">Â¶ÇÊûúÂ≠òÂú®</span><span class="p">)</span>    <span class="err">‚îÇ</span>                        <span class="err">‚îÇ</span>
</span><span id="__span-54-96"><a id="__codelineno-54-96" name="__codelineno-54-96"></a><a href="#__codelineno-54-96"><span class="linenos" data-linenos=" 96 "></span></a><span class="err">‚îÇ</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span>      <span class="err">‚îÇ</span>                        <span class="err">‚îÇ</span>
</span><span id="__span-54-97"><a id="__codelineno-54-97" name="__codelineno-54-97"></a><a href="#__codelineno-54-97"><span class="linenos" data-linenos=" 97 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                        <span class="err">‚îÇ</span>
</span><span id="__span-54-98"><a id="__codelineno-54-98" name="__codelineno-54-98"></a><a href="#__codelineno-54-98"><span class="linenos" data-linenos=" 98 "></span></a>         <span class="err">‚Üì</span>                                    <span class="err">‚îÇ</span>
</span><span id="__span-54-99"><a id="__codelineno-54-99" name="__codelineno-54-99"></a><a href="#__codelineno-54-99"><span class="linenos" data-linenos=" 99 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>                        <span class="err">‚îÇ</span>
</span><span id="__span-54-100"><a id="__codelineno-54-100" name="__codelineno-54-100"></a><a href="#__codelineno-54-100"><span class="linenos" data-linenos="100 "></span></a><span class="err">‚îÇ</span> <span class="n">ÊäïÂΩ±</span><span class="p">(</span><span class="n">Â¶ÇÊûúÂ≠òÂú®</span><span class="p">)</span>      <span class="err">‚îÇ</span>     <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">d_model</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>
</span><span id="__span-54-101"><a id="__codelineno-54-101" name="__codelineno-54-101"></a><a href="#__codelineno-54-101"><span class="linenos" data-linenos="101 "></span></a><span class="err">‚îÇ</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>        <span class="err">‚îÇ</span>                        <span class="err">‚îÇ</span>
</span><span id="__span-54-102"><a id="__codelineno-54-102" name="__codelineno-54-102"></a><a href="#__codelineno-54-102"><span class="linenos" data-linenos="102 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>                        <span class="err">‚îÇ</span>
</span><span id="__span-54-103"><a id="__codelineno-54-103" name="__codelineno-54-103"></a><a href="#__codelineno-54-103"><span class="linenos" data-linenos="103 "></span></a>         <span class="err">‚Üì</span>                                    <span class="err">‚Üì</span>
</span><span id="__span-54-104"><a id="__codelineno-54-104" name="__codelineno-54-104"></a><a href="#__codelineno-54-104"><span class="linenos" data-linenos="104 "></span></a><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>             <span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
</span><span id="__span-54-105"><a id="__codelineno-54-105" name="__codelineno-54-105"></a><a href="#__codelineno-54-105"><span class="linenos" data-linenos="105 "></span></a><span class="err">‚îÇ</span>  <span class="n">DecoderÂ≠£ËäÇÊÄßËæìÂá∫</span>  <span class="err">‚îÇ</span>             <span class="err">‚îÇ</span>  <span class="n">DecoderË∂ãÂäøËæìÂá∫</span>   <span class="err">‚îÇ</span>
</span><span id="__span-54-106"><a id="__codelineno-54-106" name="__codelineno-54-106"></a><a href="#__codelineno-54-106"><span class="linenos" data-linenos="106 "></span></a><span class="err">‚îÇ</span>  <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>       <span class="err">‚îÇ</span>             <span class="err">‚îÇ</span>  <span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">c_out</span><span class="p">]</span>       <span class="err">‚îÇ</span>
</span><span id="__span-54-107"><a id="__codelineno-54-107" name="__codelineno-54-107"></a><a href="#__codelineno-54-107"><span class="linenos" data-linenos="107 "></span></a><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>             <span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</span></code></pre></div>
<p><strong>Á¨¨‰∫å‰∏™ ËøòÂéüÊìç‰Ωú</strong></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1"></a><a href="#__codelineno-55-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># Ëß£Á†ÅÂô®Â±ÇÂÜÖÁöÑË∂ãÂäøÊäïÂΩ±Ôºà‰ΩøÁî®Âç∑ÁßØÔºâ</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2"></a><a href="#__codelineno-55-2"><span class="linenos" data-linenos="2 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">d_model</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="n">c_out</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3"></a><a href="#__codelineno-55-3"><span class="linenos" data-linenos="3 "></span></a>                           <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="s1">'circular'</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4"></a><a href="#__codelineno-55-4"><span class="linenos" data-linenos="4 "></span></a>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5"></a><a href="#__codelineno-55-5"><span class="linenos" data-linenos="5 "></span></a><span class="c1"># DecoderÁ±ª‰∏≠ÁöÑÂ≠£ËäÇÊÄßÊäïÂΩ±ÔºàÈÄöÂ∏∏ÊòØÁ∫øÊÄßÂ±ÇÔºâ</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6"></a><a href="#__codelineno-55-6"><span class="linenos" data-linenos="6 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">d_model</span><span class="p">,</span> <span class="n">c_out</span><span class="p">)</span> <span class="k">if</span> <span class="n">projection</span> <span class="k">else</span> <span class="kc">None</span>
</span></code></pre></div>
<p>Ë∂ãÂäø‰ΩøÁî®Âç∑ÁßØÊäïÂΩ±Êúâ‰ª•‰∏ã‰ºòÂäøÔºöÔºàË∂ãÂäøÁöÑÂàùÂßãÂåñÊú¨Êù•‰ΩøÁî®ÁöÑÊòØÂπ≥ÂùáÊ±†ÂåñÔºåËøôÈáåÁöÑ 1D Âç∑ÁßØÂ∞±Áõ∏ÂΩì‰∫éÂÖ®ËøûÊé•ÔºåÂè™ÊòØ‰∏çÂêåÁöÑÊï∞ÊçÆÁªÑÁªáÊñπÂºèÔºâ</p>
<ul>
<li>ÂèØ‰ª•ÊçïËé∑Â±ÄÈÉ®Êó∂Èó¥‰æùËµñÂÖ≥Á≥ªÔºàkernel_size=3Ôºâ</li>
<li>‰ΩøÁî®Âæ™ÁéØÂ°´ÂÖÖÔºàcircular paddingÔºâÈÄÇÂêàÂ§ÑÁêÜÊó∂Èó¥Â∫èÂàóÁöÑÂë®ÊúüÊÄß</li>
<li>ÂèØ‰ª•Âπ≥ÊªëÂ§ÑÁêÜË∂ãÂäøÂèòÂåñÔºåÂáèÂ∞ëÂô™Â£∞</li>
</ul>
</blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Âçï‰∏™ DecoderLayer ËøîÂõûÁöÑÊòØ Á∫ØÂ≠£ËäÇÊÄßÊàêÂàÜ x[B,L,d_model] Âíå ËΩ¨Êç¢ÂêéÁöÑË∂ãÂäøÊàêÂàÜ residual_trend[B,L,c_out]</li>
</ul>
<blockquote>
<p>üü¢ <strong>ÂΩ¢Áä∂ÂèòÂåñÁêÜËß£Ôºö</strong></p>
<p><strong>üîµ Â≠£ËäÇÊÄßÊàêÂàÜ:</strong></p>
<p>‚ñ∂Ô∏è <strong>DecoderLayerÂÜÖÈÉ®:</strong></p>
<ul>
<li>ÂßãÁªà‰øùÊåÅÂΩ¢Áä∂ [B,L,d_model]</li>
<li>ÁªèËøáÂ§ö‰∏™Â≠êÊ®°ÂùóÂ§ÑÁêÜ(Ëá™Ê≥®ÊÑèÂäõ„ÄÅ‰∫§ÂèâÊ≥®ÊÑèÂäõ„ÄÅÂâçÈ¶àÁΩëÁªú)Ôºå‰ΩÜÁª¥Â∫¶‰∏çÂèò</li>
<li>ËæìÂá∫Âà∞DecoderÊó∂‰ªç‰∏∫ [B,L,d_model]</li>
</ul>
<p><strong>‚ñ∂Ô∏è DecoderÊúÄÁªàÂ§ÑÁêÜ:</strong> </p>
<ul>
<li>ÈÄöËøáÊâÄÊúâDecoderLayerÂêé‰ªç‰∏∫ [B,L,d_model]</li>
<li>ÁªèËøáÂèØÈÄâÁöÑÂΩí‰∏ÄÂåñÂ±ÇÔºåÁª¥Â∫¶‰∏çÂèò</li>
<li>ÁªèËøáÂèØÈÄâÁöÑÊäïÂΩ±Â±ÇÂêéÔºåÂèò‰∏∫ [B,L,c_out]</li>
</ul>
<p>üîµ <strong>Ë∂ãÂäøÊàêÂàÜ:</strong></p>
<p>‚ñ∂Ô∏è <strong>DecoderLayerÂÜÖÈÉ®Ë∂ãÂäøÊèêÂèñ:</strong></p>
<p>‰∏â‰∏™Ë∂ãÂäøÂàÜÈáè(trend1/2/3)ÈÉΩÊòØ [B,L,d_model]</p>
<p>‰∏â‰∏™Ë∂ãÂäøÁ¥ØÂä†Âêé‰ªç‰∏∫ [B,L,d_model]</p>
<p>ÁªèËøáÊäïÂΩ±Â±ÇÂêéÔºåÂèò‰∏∫ [B,L,c_out]</p>
<p>‚ñ∂Ô∏è <strong>Decoder‰∏≠ÁöÑË∂ãÂäøÁ¥ØÁßØ:</strong></p>
<p>DecoderËæìÂÖ•ÁöÑÂàùÂßãË∂ãÂäøtrend‰∏∫ [B,L,c_out]</p>
<p>ÊØè‰∏™DecoderLayerËæìÂá∫ÁöÑresidual_trend‰∏∫ [B,L,c_out]</p>
<p>Á¥ØÁßØÂêéÁöÑË∂ãÂäøÁª¥Â∫¶‰øùÊåÅ [B,L,c_out]</p>
<p><strong>üåàÂêÑÂ±ÇÈó¥ÁöÑÊï∞ÊçÆ‰º†ÈÄí</strong> </p>
<p>ü´ß <strong>Â≠£ËäÇÊÄßÊàêÂàÜ‰º†ÈÄí:</strong></p>
<p>Â≠£ËäÇÊÄßÊàêÂàÜxÂú®ÂêÑDecoderLayer‰πãÈó¥‰º†ÈÄí</p>
<p>ÊØè‰∏™DecoderLayerÂ§ÑÁêÜÂêéÁöÑÂ≠£ËäÇÊÄßÊàêÂàÜ‰Ωú‰∏∫‰∏ã‰∏ÄÂ±ÇÁöÑËæìÂÖ•</p>
<p>ÊúÄÂêé‰∏ÄÂ±ÇÁöÑÂ≠£ËäÇÊÄßÊàêÂàÜËæìÂá∫ÂêéÁªèËøáÂΩí‰∏ÄÂåñÂíåÊäïÂΩ±</p>
<p>ü´ß <strong>Ë∂ãÂäøÊàêÂàÜ‰º†ÈÄí:</strong> </p>
<p>DecoderLayerÂÜÖÈÉ®ÊèêÂèñÁöÑ‰∏â‰∏™Ë∂ãÂäøÊàêÂàÜÂú®Â±ÇÂÜÖÁ¥ØÂä†ÂíåÊäïÂΩ±</p>
<p>ÊØè‰∏™DecoderLayerÊèê‰æõ‰∏Ä‰∏™Ë∂ãÂäøË¥°ÁåÆresidual_trend</p>
<p><mark>DecoderÁª¥Êä§‰∏Ä‰∏™Á¥ØÁßØË∂ãÂäøtrendÔºåÂûÇÁõ¥Á¥ØÁßØÂêÑÂ±ÇÁöÑË¥°ÁåÆ</mark></p>
<p>ÊúÄÁªàÁ¥ØÁßØÂêéÁöÑË∂ãÂäø‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÂ§ÑÁêÜÔºåÁõ¥Êé•‰Ωú‰∏∫ËæìÂá∫</p>
<p>üêã <strong>DecoderLayerÁöÑËæìÂÖ•ËæìÂá∫:</strong></p>
<p><strong>ËæìÂÖ•:</strong> Â≠£ËäÇÊÄßÊàêÂàÜ<code>x[B,L,d_model]</code>ÂíåÁºñÁ†ÅÂô®ËæìÂá∫<code>cross[B,L,d_model]</code></p>
<p><strong>ËæìÂá∫:</strong> Â§ÑÁêÜÂêéÁöÑÂ≠£ËäÇÊÄßÊàêÂàÜ<code>x[B,L,d_model]</code>ÂíåË∂ãÂäøË¥°ÁåÆ<code>residual_trend[B,L,c_out]</code></p>
</blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> <a href="#ÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q"><span id="ËøîÂõûÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q">ÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q</span></a></li>
</ul>
<p>ÁõÆÊ†áÂ∫èÂàóÁîüÊàêÊü•ËØ¢ÔºåÂØπÁÖßÊ∫êÂ∫èÂàó</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ÂØπÊØîÁºñÁ†ÅÂô®ÁöÑËÆæËÆ°</li>
</ul>
<blockquote>
<p>‰∏éÁºñÁ†ÅÂô®ÁöÑÂÖ≥ÈîÆÂå∫Âà´</p>
<ul>
<li>Ë∂ãÂäøÂ§ÑÁêÜÊñπÂºè: </li>
</ul>
<p>ÁºñÁ†ÅÂô®: ‰∏¢ÂºÉË∂ãÂäøÊàêÂàÜÔºåÂè™‰øùÁïôÂ≠£ËäÇÊÄß</p>
<p>Ëß£Á†ÅÂô®: ‰øùÂ≠òÂπ∂Á¥ØÁßØË∂ãÂäøÊàêÂàÜÔºåÊúÄÁªà‰∏éÂ≠£ËäÇÊÄßÂàÜÂºÄËæìÂá∫</p>
<ul>
<li>ÂàÜËß£Ê¨°Êï∞:</li>
</ul>
<p>ÁºñÁ†ÅÂô®: ‰∏§Ê¨°ÂàÜËß£(Ê≥®ÊÑèÂäõÂêéÂíåÂâçÈ¶àÁΩëÁªúÂêé)</p>
<p>Ëß£Á†ÅÂô®: ‰∏âÊ¨°ÂàÜËß£(Ëá™Ê≥®ÊÑèÂäõÂêé„ÄÅ‰∫§ÂèâÊ≥®ÊÑèÂäõÂêéÂíåÂâçÈ¶àÁΩëÁªúÂêé)</p>
<ul>
<li>Ë∂ãÂäøÁ¥ØÁßØ:</li>
</ul>
<p>ÁºñÁ†ÅÂô®: Êó†Ë∂ãÂäøÁ¥ØÁßØ</p>
<p>Ëß£Á†ÅÂô®: ‰∏â‰∏™Èò∂ÊÆµÁöÑË∂ãÂäøÁõ∏Âä†ÔºåÂΩ¢ÊàêÂÆåÊï¥Ë∂ãÂäøË°®Á§∫</p>
<ul>
<li>ËæìÂá∫Áª¥Â∫¶:</li>
</ul>
<p>ÁºñÁ†ÅÂô®: ËæìÂá∫‰øùÊåÅd_modelÁª¥Â∫¶</p>
<p>Ëß£Á†ÅÂô®: ÂØπË∂ãÂäøÊàêÂàÜËøõË°åÊäïÂΩ±ÔºåË∞ÉÊï¥‰∏∫c_outÁª¥Â∫¶
ËøôÁßçËÆæËÆ°‰ΩìÁé∞‰∫ÜAutoformerÂØπÊó∂Èó¥Â∫èÂàóÂàÜËß£ÁöÑÁ≤æÂøÉÂ§ÑÁêÜÔºåÈÄöËøáÂú®Ëß£Á†ÅÂô®‰∏≠Á¥ØÁßØË∂ãÂäø‰ø°ÊÅØÔºåÁªìÂêàÁºñÁ†ÅÂô®ÊèêÂèñÁöÑÂ≠£ËäÇÊÄßÁâπÂæÅÔºåÊúÄÁªàËÉΩÂ§üÂÆûÁé∞È´òË¥®ÈáèÁöÑÊó∂Èó¥Â∫èÂàóÈ¢ÑÊµã„ÄÇ</p>
</blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ÈóÆÔºö‰∏∫‰ªÄ‰πàË¶ÅËøôÊ†∑ËÆæËÆ°Ôºü</li>
</ul>
<blockquote>
<p>ÈóÆÈ¢òÊèèËø∞Ôºö</p>
<p>Ë∂ãÂäøÊàêÂàÜÔºöÂú®ÊØè‰∏™Ëß£Á†ÅÂô®Â±ÇÂÜÖÈÉ®Â∞±ËøõË°åÊäïÂΩ±ÔºåÂπ∂‰∏îÂêÑÂ±ÇÁöÑÊäïÂΩ±ÁªìÊûúË¢´Á¥ØÁßØ</p>
<p>Â≠£ËäÇÊÄßÊàêÂàÜÔºö‰øùÊåÅÂéüÂßãÁª¥Â∫¶ÈÄöËøáÊâÄÊúâËß£Á†ÅÂô®Â±ÇÔºåÂè™Âú®ÊúÄÂêéËøõË°å‰∏ÄÊ¨°Áªü‰∏ÄÊäïÂΩ±</p>
</blockquote>
<p>ÊàëÁöÑÁêÜËß£ÔºöÂ≠£ËäÇÊòØ‰∏Ä‰∏™È´òÈ¢ëÊàêÂàÜÔºå‰øùÊåÅÈ´òÁª¥Ë°®Á§∫ËÉΩÂ§üÊõ¥Â•ΩÁöÑË°®Á§∫ÁâπÂæÅ„ÄÇË∂ãÂäøÊàêÂàÜÊòØ‰∏Ä‰∏™‰ΩéÈ¢ëÊàêÂàÜÔºå‰∏çÁÆ°ÊòØÂç∑ÁßØÊàñËÄÖÊòØ DecoderLayer ÊúÄÂêéÁöÑ conv ÈÉΩÂèØ‰ª•ËææÂà∞Âπ≥ÊªëÂô™Â£∞ÁöÑ‰ΩúÁî®Ôºå‰ΩøÂæóÁΩëÁªúËÉΩÂ§üÊõ¥Âä†ÂÖ≥Ê≥®ÈïøÊúüÁ®≥ÂÆöÁöÑË∂ãÂäø</p>
<blockquote>
<p><strong>ÂØπÂì¶~ÂæóÂà∞ gpt ÁöÑËÇØÂÆö„ÄÇokayÔºågo„ÄÇÂÆÉÁöÑË°•ÂÖÖÔºö</strong> </p>
<p>AutoformerÁöÑËÆæËÆ°ÁêÜÂøµÁ°ÆÂÆûÂõ¥ÁªïÁùÄÂØπÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆ‰∏≠‰∏çÂêåÈ¢ëÁéáÊàêÂàÜÁöÑÂ∑ÆÂºÇÂåñÂ§ÑÁêÜ</p>
<p><strong>üîµ Â≠£ËäÇÊÄßÊàêÂàÜÔºàÈ´òÈ¢ëÔºâÁöÑÂ§ÑÁêÜÁ≠ñÁï•</strong></p>
<p><strong>‰øùÊåÅÈ´òÁª¥Ë°®Á§∫</strong></p>
<ul>
<li>Â≠£ËäÇÊÄßÊàêÂàÜÂú®DecoderLayer‰∏≠ÂßãÁªà‰øùÊåÅd_modelÁª¥Â∫¶ÔºàÈÄöÂ∏∏ËæÉÈ´òÔºâ</li>
<li>Âè™Âú®DecoderÁöÑÊúÄÂêéÈò∂ÊÆµÊâçÊäïÂΩ±Âà∞c_outÁª¥Â∫¶</li>
<li>ËøôÁßçËÆæËÆ°ÂÖÅËÆ∏Ê®°Âûã‰ΩøÁî®‰∏∞ÂØåÁöÑÁâπÂæÅÁ©∫Èó¥Êù•Ë°®ËææÂ§çÊùÇÁöÑÂë®ÊúüÊÄßÊ®°Âºè</li>
</ul>
<p><strong>Ê≥®ÊÑèÂäõÊú∫Âà∂ÁöÑ‰ºòÂäø</strong></p>
<ul>
<li>Ëá™Ê≥®ÊÑèÂäõÂíå‰∫§ÂèâÊ≥®ÊÑèÂäõÁâπÂà´ÈÄÇÂêàÊçïËé∑‰∏çÂêåÊó∂Èó¥ÁÇπ‰πãÈó¥ÁöÑÂë®ÊúüÊÄßÂÖ≥Á≥ª</li>
<li>Â≠£ËäÇÊÄßÊàêÂàÜÁªèËøáÂ§öÊ¨°Ê≥®ÊÑèÂäõÂ§ÑÁêÜÔºåÂèØ‰ª•ËØÜÂà´Â§çÊùÇÁöÑÈáçÂ§çÊ®°Âºè</li>
</ul>
<p><strong>Â§öÂ±ÇÊ∏êËøõÂºèÂ§ÑÁêÜ</strong> </p>
<ul>
<li>ÊØèÂ±ÇDecoderLayerÈÉΩÂØπÂ≠£ËäÇÊÄßËøõË°åËøõ‰∏ÄÊ≠•Á≤æÁÇº</li>
<li>ÈÄöËøáÂ±ÇÂ±Ç‰º†ÈÄíÔºåÂÖÅËÆ∏Ê®°ÂûãÂ≠¶‰π†Âà∞Â±ÇÊ¨°ÂåñÁöÑÂ≠£ËäÇÊ®°ÂºèÔºàÂ¶ÇÊó•ÂÜÖÊ®°Âºè„ÄÅÂë®ÂÜÖÊ®°Âºè„ÄÅÊúàÂÜÖÊ®°ÂºèÔºâ</li>
</ul>
<p>üîµ <strong>Ë∂ãÂäøÊàêÂàÜÔºà‰ΩéÈ¢ëÔºâÁöÑÂ§ÑÁêÜÁ≠ñÁï•</strong></p>
<p><strong>Êó©ÊúüÈôçÁª¥ÂíåÂπ≥ÊªëÂ§ÑÁêÜ</strong></p>
<ul>
<li>Ë∂ãÂäøÊàêÂàÜÂú®ÊØè‰∏™DecoderLayerÂÜÖÂ∞±ÈÄöËøáÂç∑ÁßØÔºàkernel_size=3ÔºâËøõË°åÊäïÂΩ±
  Âç∑ÁßØÁöÑÊú¨Ë¥®ÊòØ‰∏ÄÁßçÂπ≥ÊªëÊìç‰ΩúÔºåËÉΩÂ§üËøáÊª§ÊéâÈ´òÈ¢ëÂô™Â£∞</li>
<li>Âæ™ÁéØÂ°´ÂÖÖÔºàpadding_mode='circular'ÔºâÈÄÇÂêàÂ§ÑÁêÜÂë®ÊúüÊÄßÊó∂Èó¥Â∫èÂàó
  Á¥ØÁßØÊú∫Âà∂ÁöÑÊÑè‰πâ</li>
</ul>
<p><strong>‰∏çÂêåÂ±ÇÊçïËé∑ÁöÑË∂ãÂäøÈÄöËøáÁÆÄÂçïÁ¥ØÂä†ÁöÑÊñπÂºèÁªÑÂêà</strong></p>
<ul>
<li>Ë∂ãÂäø‰ΩøÁî®ËæÉ‰ΩéÁöÑÁª¥Â∫¶Ôºàc_outÔºâÂ∞±Ë∂≥‰ª•Ë°®Ëææ</li>
<li>Ë∂ãÂäøÊú¨Ë¥®‰∏äÊòØ‰ΩéÈ¢ë„ÄÅÂπ≥ÊªëÁöÑÊàêÂàÜÔºåÁâπÂæÅÂ§çÊùÇÂ∫¶‰Ωé‰∫éÂ≠£ËäÇÊÄß</li>
</ul>
</blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> <a href="#Ë∑≥Âà∞‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ">‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ</a><a id="ËøîÂõû‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ"></a>Ôºå‰∏Ä‰∏™Áî®nn.Linear‰∏Ä‰∏™Áî® nn.conv1DÔºü</li>
</ul>
<p>Ë°•ÂÖÖÔºöË∂ãÂäøÊàêÂàÜÂç∑ÁßØÊó∂Áî®Âà∞ÁöÑ<a href="#Âæ™ÁéØÂ°´ÂÖÖ"><span id="ËøîÂõûÂæ™ÁéØÂ°´ÂÖÖ">Âæ™ÁéØÂ°´ÂÖÖ</span></a></p>
<p>Ëá™Â∑±ÁöÑËØùÔºökernel size=3ÔºåÂπ≥ÊªëË∂ãÂäøÔºåËÄÉËôëÂ±ÄÈÉ®‰∏ä‰∏ãÊñáÔºåËøáÊª§Âô™Â£∞ÔºõÔºà‰ºöÊúâ‰∏ÄÊ≠•ÂΩ¢Áä∂ÂèòÂåñÔºå‰ΩÜÂõ†‰∏∫Âç∑ÁßØÊ†∏ÂèÇÊï∞ÂÖ±‰∫´ÔºåÂèØ‰ª•ËØÜÂà´Áõ∏ÂêåÁöÑÂë®ÊúüÂèòÂåñÔºâ</p>
<p>Â≠£ËäÇÊàêÂàÜ‰ΩøÁî® nn.LinearÔºå‰øùÁïôÈ´òÈ¢ëÊàêÂàÜÂíåÂø´ÈÄüÂèòÂåñÁöÑÈÉ®ÂàÜ„ÄÇ</p>
<ul>
<li>Â≠£ËäÇÊÄßÊàêÂàÜÔºàÈ´òÈ¢ë„ÄÅÂ§çÊùÇÂèòÂåñÔºâÔºö‰ΩøÁî®Á∫øÊÄßÊäïÂΩ±‰øùÁïôÁ≤æÁªÜÁªìÊûÑ</li>
<li>Ë∂ãÂäøÊàêÂàÜÔºà‰ΩéÈ¢ë„ÄÅÂπ≥ÊªëÂèòÂåñÔºâÔºö‰ΩøÁî®Âç∑ÁßØÊäïÂΩ±ÂºïÂÖ•Âπ≥ÊªëÊïàÊûúÂíåÂ±ÄÈÉ®‰∏ä‰∏ãÊñá</li>
</ul>
<p><strong>ÊúÄÂêéÁöÑ‰∏ÄÁÇπÂÖ≥‰∫éÊü•ÊºèË°•Áº∫</strong></p>
<p>Decoder ÂØπÂ∫îËÆ∫Êñá‰∏≠ÁöÑËøôÈáåÔºö</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250322153705300.png"><img alt="image-20250322153705300" src="../images/image-20250322153705300.png"/></a></p>
<p>ÂÖ¨Âºè‰∏≠Ôºå</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250322153735389.png"><img alt="image-20250322153735389" src="../images/image-20250322153735389.png"/></a> </p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> ËøôÈáåÁöÑ <span class="arithmatex">\(\mathcal{W}_{l,}\)</span> ÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü</li>
</ul>
<p>È¶ñÂÖàÈúÄË¶ÅÊòéÁ°ÆÔºåÂêÑ‰∏™ÁöÑÂΩ¢Áä∂</p>
<p><span class="arithmatex">\(\mathcal{T}_{de}^{l}„ÄÅ\mathcal{T}_{de}^{l-1} \in \mathbb{R}^{B \times L \times c_{out}}\)</span></p>
<p><span class="arithmatex">\(\mathcal{T}_{de}^{l,1} „ÄÅ\mathcal{T}_{de}^{l,2}„ÄÅ\mathcal{T}_{de}^{l,3}\in \mathbb{R}^{B \times L \times d_{model}}\)</span></p>
<p><strong>‚Üí</strong> <span class="arithmatex">\(\mathcal{W}_{l,1}„ÄÅ\mathcal{W}_{l,2}„ÄÅ\mathcal{W}_{l,3}\)</span> ÂàÜÂà´ÊòØË∞ÉÊï¥Áª¥Â∫¶ÊâÄÁî®Âà∞ÁöÑÂèòÊç¢Áü©Èòµ</p>
<h2 id="autoformer-forward_1">Ê±áÊÄª Autoformer forward<a class="headerlink" href="#autoformer-forward_1" title="Permanent link">¬∂</a></h2>
<p>1</p>
<pre class="mermaid"><code>classDiagram
    class Model {
        +int seq_len
        +int label_len
        +int pred_len
        +bool output_attention
        +series_decomp decomp
        +DataEmbedding_wo_pos enc_embedding
        +DataEmbedding_wo_pos dec_embedding
        +Encoder encoder
        +Decoder decoder
        +forward(x_enc, x_mark_enc, x_dec, x_mark_dec, enc_self_mask, dec_self_mask, dec_enc_mask)
    }

    class series_decomp {
        +moving_avg moving_avg
        +forward(x) res, moving_mean
    }

    class moving_avg {
        +int kernel_size
        +AvgPool1d avg
        +forward(x)
    }

    class DataEmbedding_wo_pos {
        +TokenEmbedding value_embedding
        +PositionalEmbedding position_embedding
        +TemporalEmbedding or TimeFeatureEmbedding temporal_embedding  
        +Dropout dropout
        +forward(x, x_mark)
    }

    class TokenEmbedding {
        +Conv1d tokenConv
        +forward(x)
    }

    class TemporalEmbedding {
        +Embedding minute_embed
        +Embedding hour_embed
        +Embedding weekday_embed
        +Embedding day_embed
        +Embedding month_embed
        +forward(x)
    }

    class TimeFeatureEmbedding {
        +Linear embed
        +forward(x)
    }

    class Encoder {
        +List~EncoderLayer~ layers
        +my_Layernorm norm_layer
        +forward(x, attn_mask)
    }

    class EncoderLayer {
        +AutoCorrelationLayer attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +Dropout dropout
        +activation
        +forward(x, attn_mask)
    }

    class AutoCorrelationLayer {
        +AutoCorrelation attention
        +Linear query_projection
        +Linear key_projection
        +Linear value_projection
        +Linear out_projection
        +forward(queries, keys, values, attn_mask)
    }

    class AutoCorrelation {
        +bool mask_flag
        +int factor
        +float scale
        +Dropout dropout
        +bool output_attention
        +time_delay_agg_training(values, corr)
        +time_delay_agg_inference(values, corr)
        +forward(queries, keys, values, attn_mask)
    }

    class Decoder {
        +List~DecoderLayer~ layers
        +my_Layernorm norm_layer
        +Linear projection
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    class DecoderLayer {
        +AutoCorrelationLayer self_attention
        +AutoCorrelationLayer cross_attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +series_decomp decomp3
        +Dropout dropout
        +activation
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    %% Ê†∏ÂøÉÁªÑ‰ª∂ÂÖ≥Á≥ª
    Model --&gt; series_decomp
    Model --&gt; DataEmbedding_wo_pos
    Model --&gt; Encoder
    Model --&gt; Decoder

    %% ÂµåÂÖ•Â±ÇÂÖ≥Á≥ª - ‰øÆÊ≠£‰∏∫Êù°‰ª∂ÂÖ≥Á≥ª
    DataEmbedding_wo_pos --&gt; TokenEmbedding
    DataEmbedding_wo_pos ..&gt; TemporalEmbedding : ÂΩìembed_type!='timeF'
    DataEmbedding_wo_pos ..&gt; TimeFeatureEmbedding : ÂΩìembed_type='timeF'

    %% ÁºñÁ†ÅÂô®ÁªÑ‰ª∂ÂÖ≥Á≥ª
    Encoder --&gt; EncoderLayer
    EncoderLayer --&gt; AutoCorrelationLayer
    EncoderLayer --&gt; Conv1d
    EncoderLayer --&gt; series_decomp
    AutoCorrelationLayer --&gt; AutoCorrelation

    %% Ëß£Á†ÅÂô®ÁªÑ‰ª∂ÂÖ≥Á≥ª
    Decoder --&gt; DecoderLayer
    DecoderLayer --&gt; AutoCorrelationLayer
    DecoderLayer --&gt; Conv1d
    DecoderLayer --&gt; series_decomp

    %% Â∫èÂàóÂàÜËß£ÂÖ≥Á≥ª
    series_decomp --&gt; moving_avg
    moving_avg --&gt; AvgPool1d
</code></pre>
<p>2 </p>
<pre class="mermaid"><code>classDiagram
    class Model {
        +int seq_len
        +int label_len
        +int pred_len
        +bool output_attention
        +series_decomp decomp
        +DataEmbedding_wo_pos enc_embedding
        +DataEmbedding_wo_pos dec_embedding
        +Encoder encoder
        +Decoder decoder
        +forward(x_enc, x_mark_enc, x_dec, x_mark_dec, enc_self_mask, dec_self_mask, dec_enc_mask)
    }

    class series_decomp {
        +moving_avg moving_avg
        +forward(x) res, moving_mean
    }

    class moving_avg {
        +int kernel_size
        +AvgPool1d avg
        +forward(x)
    }

    class DataEmbedding_wo_pos {
        +TokenEmbedding value_embedding
        +TemporalEmbedding|TimeFeatureEmbedding temporal_embedding
        +Dropout dropout
        +forward(x, x_mark)
        +__init__(c_in, d_model, embed_type, freq, dropout)
    }

    class TokenEmbedding {
        +Conv1d tokenConv
        +forward(x)
    }

    class TemporalEmbedding {
        +Embedding minute_embed
        +Embedding hour_embed
        +Embedding weekday_embed
        +Embedding day_embed
        +Embedding month_embed
        +forward(x)
    }

    class TimeFeatureEmbedding {
        +Linear embed
        +forward(x)
    }

    class Encoder {
        +List~EncoderLayer~ layers
        +my_Layernorm norm_layer
        +forward(x, attn_mask)
    }

    class EncoderLayer {
        +AutoCorrelationLayer attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +Dropout dropout
        +activation
        +forward(x, attn_mask)
    }

    class AutoCorrelationLayer {
        +AutoCorrelation attention
        +Linear query_projection
        +Linear key_projection
        +Linear value_projection
        +Linear out_projection
        +forward(queries, keys, values, attn_mask)
    }

    class AutoCorrelation {
        +bool mask_flag
        +int factor
        +float scale
        +Dropout dropout
        +bool output_attention
        +time_delay_agg_training(values, corr)
        +time_delay_agg_inference(values, corr)
        +forward(queries, keys, values, attn_mask)
    }

    class Decoder {
        +List~DecoderLayer~ layers
        +my_Layernorm norm_layer
        +Linear projection
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    class DecoderLayer {
        +AutoCorrelationLayer self_attention
        +AutoCorrelationLayer cross_attention
        +Conv1d conv1
        +Conv1d conv2
        +series_decomp decomp1
        +series_decomp decomp2
        +series_decomp decomp3
        +Dropout dropout
        +activation
        +forward(x, enc_out, x_mask, cross_mask, trend)
    }

    %% Model‰∏≠ÁöÑÁªÑ‰ª∂ÂÆû‰æãÂåñÂÖ≥Á≥ª
    Model *-- "1" series_decomp : ÂàõÂª∫decomp
    Model *-- "1" DataEmbedding_wo_pos : ÂàõÂª∫enc_embedding
    Model *-- "1" DataEmbedding_wo_pos : ÂàõÂª∫dec_embedding
    Model *-- "1" Encoder : ÂàõÂª∫encoder
    Model *-- "1" Decoder : ÂàõÂª∫decoder

    %% DataEmbedding_wo_posÂÜÖÈÉ®ÁªÑ‰ª∂
    DataEmbedding_wo_pos *-- "1" TokenEmbedding : ÂàõÂª∫value_embedding
    DataEmbedding_wo_pos *-- "1" TemporalEmbedding : ÂàõÂª∫temporal_embedding(ÂΩìembed_type!='timeF')
    DataEmbedding_wo_pos *-- "1" TimeFeatureEmbedding : ÂàõÂª∫temporal_embedding(ÂΩìembed_type='timeF')

    %% ÂÖ∂‰ªñÁªÑ‰ª∂ÂÖ≥Á≥ª
    series_decomp *-- "1" moving_avg
    Encoder *-- "e_layers" EncoderLayer
    EncoderLayer *-- "1" AutoCorrelationLayer
    EncoderLayer *-- "2" series_decomp : decomp1,decomp2
    AutoCorrelationLayer *-- "1" AutoCorrelation
    Decoder *-- "d_layers" DecoderLayer
    DecoderLayer *-- "2" AutoCorrelationLayer : selfÂíåcrossÊ≥®ÊÑèÂäõ
    DecoderLayer *-- "3" series_decomp : decomp1,2,3
</code></pre>
<h2 id="_15"><span id="ÈôÑÂΩï">ÈôÑÂΩï</span><a class="headerlink" href="#_15" title="Permanent link">¬∂</a></h2>
<p>ÂéüÂßã Transformer Êû∂ÊûÑ</p>
<p><a href="#ÂéüÂßã Transformer Êû∂ÊûÑ">ËøîÂõû Ê≠£Êñá‰ΩçÁΩÆÔºöÂéüÂßã Transformer Êû∂ÊûÑ</a> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320213456149.png"><img alt="image-20250320213456149" src="../images/image-20250320213456149.png"/></a></p>
<ul>
<li><code>d_model</code> ÊòØÂµåÂÖ•Áª¥Â∫¶Ôºå‰πüÂ∞±ÊòØ Embedding dimÔºåD ÊòØÂçï‰∏™Êó∂Èó¥Ê≠•ËßÇÂØüÁöÑÁâπÂæÅÊï∞„ÄÇ</li>
<li>ÂæóÂà∞ Embeddingdim ÁöÑÊìç‰ΩúÔºåNLP ‰∏≠‰∏ÄËà¨Âè´ word embeddingÔºåËøôÈáåÂè´ tokenEmbedding‰πüËøòÊå∫ÂêàÁêÜÁöÑÔºåÂçï‰∏™Êó∂Èó¥Ê≠•Â∞±ÊòØÂçï‰∏™ token„ÄÇ</li>
</ul>
<h3 id="conv2">ÁñëÈóÆ‰∏Ä <a href="#‰∏∫‰ªÄ‰πàConv2‰πãÂêéÊ≤°ÊúâËøõË°åÊøÄÊ¥ªÂáΩÊï∞ÁöÑÂ∫îÁî®">‰∏∫‰ªÄ‰πàConv2‰πãÂêéÊ≤°ÊúâËøõË°åÊøÄÊ¥ªÂáΩÊï∞ÁöÑÂ∫îÁî®</a><a class="headerlink" href="#conv2" title="Permanent link">¬∂</a></h3>
<p>Ôºà1ÔºâÈÅµÂæ™ÂéüÂßãTransformerÁöÑËÆæËÆ°Ê®°ÂºèÔºåÂú®ÂéüÂßãTransformerËÆæËÆ°‰∏≠ÔºåFFNÁöÑÁªìÊûÑ‰∏∫Ôºö<code>FFN(x) = max(0, xW‚ÇÅ + b‚ÇÅ)W‚ÇÇ + b‚ÇÇ</code>ÔºåËøôÁõ∏ÂΩì‰∫é‰∏§‰∏™Á∫øÊÄßÂèòÊç¢Ôºå‰∏≠Èó¥Êúâ‰∏Ä‰∏™ReLUÊøÄÊ¥ªÂáΩÊï∞„ÄÇÁ¨¨‰∏Ä‰∏™Á∫øÊÄßÂèòÊç¢ÂêéÂ∫îÁî®ÊøÄÊ¥ªÂáΩÊï∞ÔºåËÄåÁ¨¨‰∫å‰∏™Á∫øÊÄßÂèòÊç¢Âêé‰∏çÂ∫îÁî®ÊøÄÊ¥ªÂáΩÊï∞„ÄÇAutoformer‰ΩøÁî®1DÂç∑ÁßØÊõø‰ª£Á∫øÊÄßÂèòÊç¢Ôºå‰ΩÜ‰øùÊåÅ‰∫ÜÁõ∏ÂêåÁöÑÊøÄÊ¥ªÂáΩÊï∞Ê®°Âºè„ÄÇ</p>
<p>Ôºà2Ôºâ‰øùÊåÅËæìÂá∫ÁöÑÁ∫øÊÄßÁâπÊÄßÔºåÊúÄÂêé‰∏ÄÂ±Ç‰∏ç‰ΩøÁî®ÊøÄÊ¥ªÂáΩÊï∞ÂèØ‰ª•‰øùÊåÅËæìÂá∫ÁöÑÁ∫øÊÄßÁâπÊÄßÔºåËøôÂØπ‰∫éÊó∂Èó¥Â∫èÂàóÈ¢ÑÊµãÂ∞§ÂÖ∂ÈáçË¶Å„ÄÇÂ¶ÇÊûúÂú®Á¨¨‰∫å‰∏™Âç∑ÁßØÂ±ÇÂêéÂ∫îÁî®ÊøÄÊ¥ªÂáΩÊï∞Ôºö</p>
<ul>
<li>ÂØπ‰∫éReLUÔºö‰ºöÂØºËá¥Ë¥üÂÄºË¢´Êà™Êñ≠‰∏∫Èõ∂ÔºåÈôêÂà∂Ê®°ÂûãË°®ËææË¥üÂêëË∂ãÂäøÁöÑËÉΩÂäõ</li>
<li>ÂØπ‰∫éÂÖ∂‰ªñÊøÄÊ¥ªÂáΩÊï∞Ôºö‰ºöÂºïÂÖ•ÈùûÁ∫øÊÄßÂèòÊç¢ÔºåÂèØËÉΩÈôêÂà∂Ê®°ÂûãÂØπÁ∫øÊÄßË∂ãÂäøÁöÑÂª∫Ê®°ËÉΩÂäõ</li>
<li>Âú®Êó∂Èó¥Â∫èÂàóÂª∫Ê®°‰∏≠Ôºå‰øùÊåÅ‰∏ÄÂÆöÁöÑÁ∫øÊÄßÁâπÊÄßÂæàÈáçË¶ÅÔºåÂõ†‰∏∫ËÆ∏Â§öÊó∂Èó¥Â∫èÂàóÂåÖÂê´Âº∫Á∫øÊÄßË∂ãÂäø„ÄÇÊúÄÂêé‰∏ÄÂ±Ç‰∏ç‰ΩøÁî®ÊøÄÊ¥ªÂáΩÊï∞ÔºåÂèØ‰ª•‰ΩøÊ®°ÂûãÊõ¥Â•ΩÂú∞ÊçïÊçâËøô‰∫õÁ∫øÊÄßË∂ãÂäø„ÄÇ</li>
</ul>
<p>Ôºà3ÔºâÊÄª‰πãÔºå<strong>Á¨¨‰∏Ä‰∏™Âç∑ÁßØÂ±ÇÂíåÊøÄÊ¥ªÂáΩÊï∞**Ë¥üË¥£ÊçïÊçâÈùûÁ∫øÊÄßÁâπÂæÅÔºå**Á¨¨‰∫å‰∏™Âç∑ÁßØÂ±ÇÊ≤°ÊúâÊøÄÊ¥ªÂáΩÊï∞</strong>Ôºå‰øùÊåÅ‰∫Ü‰∏ÄÂÆöÁöÑÁ∫øÊÄßÊò†Â∞ÑËÉΩÂäõÔºåËøôÁßçËÆæËÆ°Âú®ÈùûÁ∫øÊÄßË°®ËææËÉΩÂäõÂíå‰øùÊåÅÁ∫øÊÄßÁâπÊÄß‰πãÈó¥ÂèñÂæó‰∫ÜÂπ≥Ë°°</p>
<h3 id="2-conv1d-nnlinear">ÁñëÈóÆ 2 ‰∏∫‰ªÄ‰πàÊòØ conv1dÔºåËÄå‰∏çÊòØ nn.Linear<a class="headerlink" href="#2-conv1d-nnlinear" title="Permanent link">¬∂</a></h3>
<ul>
<li>È¶ñÂÖàÔºåÂøÖÈ°ªÊòéÁ°ÆÁöÑÊòØÔºå‰ΩøÁî®nn.Linear <strong>‰∏çÊòØ</strong> ‰∏∫ÊØè‰∏™Êó∂Èó¥Ê≠•ÂàõÂª∫ÂçïÁã¨ÁöÑÂÖ®ËøûÊé•Â±ÇÔºåËÄåÊòØÂØπÊâÄÊúâÊó∂Èó¥Ê≠•Â∫îÁî®Áõ∏ÂêåÁöÑÊùÉÈáçÔºàÊùÉÈáçÂÖ±‰∫´Ôºâ„ÄÇ</li>
</ul>
<p><mark>‰æãÂ≠êÔºö</mark> </p>
<p><u>ÊñπÂºè1ÔºöÂ∫îÁî®‰∫éÊï¥‰∏™Â∫èÂàóÔºàÊâπÈáèÂ§ÑÁêÜÊâÄÊúâÊó∂Èó¥Ê≠•Ôºâ</u> </p>
<p>ÂÅáËÆæËæìÂÖ•xÂΩ¢Áä∂‰∏∫[B, L, D]</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1"></a><a href="#__codelineno-56-1"><span class="linenos" data-linenos="1 "></span></a>linear_layer = nn.Linear(D, D_out)
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2"></a><a href="#__codelineno-56-2"><span class="linenos" data-linenos="2 "></span></a>output = linear_layer(x)  # ËæìÂá∫ÂΩ¢Áä∂‰∏∫[B, L, D_out]
</span></code></pre></div>
<p><strong>Âêå‰∏Ä‰∏™Á∫øÊÄßÂ±Ç‰ºöÂ∫îÁî®Âà∞ÊâÄÊúâÊó∂Èó¥Ê≠•ÔºåÊùÉÈáçÊòØÂÖ±‰∫´ÁöÑ„ÄÇËøô‰∏ékernel_size=1ÁöÑConv1DÈùûÂ∏∏Áõ∏‰ºº</strong> </p>
<ul>
<li>kernel_size=1ÁöÑConv1DÂú®ÂäüËÉΩ‰∏äÁ±ª‰ºº‰∫éÁã¨Á´ãÂ∫îÁî®‰∫éÊØè‰∏™Êó∂Èó¥Ê≠•ÁöÑÂÖ®ËøûÊé•Â±ÇÔºå‰ΩÜÂÆÉÊúâ‰∏Ä‰∏™ÂÖ≥ÈîÆÂå∫Âà´ÔºöÊùÉÈáçÂÖ±‰∫´„ÄÇ‰ΩøÁî®Âç∑ÁßØÊÑèÂë≥ÁùÄÂêå‰∏ÄÁªÑÊùÉÈáçÂ∫îÁî®‰∫éÊâÄÊúâÊó∂Èó¥Ê≠•</li>
</ul>
<p><u>ÊñπÂºè2ÔºöÂæ™ÁéØÂ∫îÁî®‰∫éÊØè‰∏™Êó∂Èó¥Ê≠•</u> </p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1"></a><a href="#__codelineno-57-1"><span class="linenos" data-linenos="1 "></span></a># ÂÅáËÆæËæìÂÖ•xÂΩ¢Áä∂‰∏∫[B, L, D]
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2"></a><a href="#__codelineno-57-2"><span class="linenos" data-linenos="2 "></span></a>linear_layer = nn.Linear(D, D_out)
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3"></a><a href="#__codelineno-57-3"><span class="linenos" data-linenos="3 "></span></a>outputs = []
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4"></a><a href="#__codelineno-57-4"><span class="linenos" data-linenos="4 "></span></a>for i in range(L):
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5"></a><a href="#__codelineno-57-5"><span class="linenos" data-linenos="5 "></span></a>    output_step = linear_layer(x[:, i, :])  # ËæìÂá∫ÂΩ¢Áä∂‰∏∫[B, D_out]
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6"></a><a href="#__codelineno-57-6"><span class="linenos" data-linenos="6 "></span></a>    outputs.append(output_step)
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7"></a><a href="#__codelineno-57-7"><span class="linenos" data-linenos="7 "></span></a>output = torch.stack(outputs, dim=1)  # ËæìÂá∫ÂΩ¢Áä∂‰∏∫[B, L, D_out]
</span></code></pre></div>
<p>ËøôÁßçÊñπÂºè‰πüÊòØ‰ΩøÁî®Âêå‰∏Ä‰∏™Á∫øÊÄßÂ±ÇÔºåÊùÉÈáç‰ªçÁÑ∂ÊòØÂÖ±‰∫´ÁöÑ„ÄÇ</p>
<p>ÂÖ∂ÂÆûËøô‰∏™ÁñëÈóÆÁúãÂõûÁ≠îÂÖ∂ÂÆû‰πüÊòØÂ§ßÂèØ‰∏çÂøÖÁöÑ„ÄÇÁúãÁúãÂ∞±Ë°å‰∫ÜÔºåÊÉ≥ÁùÄÁúãÊòéÁôΩ‰∏çÂ§ßÂèØËÉΩ„ÄÇ</p>
<p><strong>Âú®Autoformer‰∏≠‰ΩøÁî®kernel_size=1ÁöÑConv1DÊó∂ÔºåÂÆÉÂú®ÂäüËÉΩ‰∏ä‰∏éÊñπÂºè1‰∏≠ÁöÑnn.LinearÈùûÂ∏∏Áõ∏‰ººÔºå‰∏ªË¶ÅÂå∫Âà´Âú®‰∫éÔºö</strong> </p>
<ol>
<li><strong>Áª¥Â∫¶È°∫Â∫è</strong>Ôºö
   - Conv1DÊúüÊúõËæìÂÖ•ÂΩ¢Áä∂‰∏∫<code>[B, C, L]</code>ÔºàÊâπÊ¨°Â§ßÂ∞è„ÄÅÈÄöÈÅìÊï∞„ÄÅÂ∫èÂàóÈïøÂ∫¶Ôºâ
   - LinearÊúüÊúõËæìÂÖ•ÂΩ¢Áä∂‰∏∫<code>[B, L, D]</code>ÔºàÊâπÊ¨°Â§ßÂ∞è„ÄÅÂ∫èÂàóÈïøÂ∫¶„ÄÅÁâπÂæÅÁª¥Â∫¶Ôºâ</li>
<li><strong>ÂÆûÁé∞ÊïàÁéá</strong>Ôºö
   - Conv1DÂú®GPU‰∏äÂØπ‰∫éÂ∫èÂàóÊï∞ÊçÆÊúâÊõ¥‰ºòÂåñÁöÑÂÆûÁé∞
   - ‰ΩøÁî®Conv1DÂèØ‰ª•ÈÅøÂÖçreshapeÊìç‰ΩúÊàñÂæ™ÁéØÂ§ÑÁêÜÊó∂Èó¥Ê≠•</li>
<li><strong>Ê°ÜÊû∂ËÆæËÆ°</strong>Ôºö
   - ‰ΩøÁî®Conv1D‰∏éAutoformerÁöÑÊï¥‰ΩìÊû∂ÊûÑËÆæËÆ°Êõ¥‰∏ÄËá¥
   - Conv1DÊèê‰æõ‰∫ÜÊâ©Â±ïÂà∞Êõ¥Â§ßkernel_sizeÁöÑÂèØËÉΩÊÄß</li>
</ol>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320225707561.png"><img alt="image-20250320225707561" src="../images/image-20250320225707561.png"/></a> </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320225721285.png"><img alt="image-20250320225721285" src="../images/image-20250320225721285.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250320225730620.png"><img alt="image-20250320225730620" src="../images/image-20250320225730620.png"/></a> </p>
<h3 id="_16">Â∫èÂàóÂàÜËß£ÁöÑÁé∞ÂÆûÊÑè‰πâ<a class="headerlink" href="#_16" title="Permanent link">¬∂</a></h3>
<p><strong>Autoformer‰∏≠Â∫èÂàóÂàÜËß£ÁöÑÁâπÊÆäÊÄß‰∏éÊÑè‰πâ</strong> </p>
<p>Autoformer‰∏≠ÁöÑÂ∫èÂàóÂàÜËß£Ôºàseries_decompÔºâÊòØËØ•Ê®°ÂûãÊúÄÂÖ∑ÂàõÊñ∞ÊÄßÁöÑÁâπÁÇπ‰πã‰∏ÄÔºåÂÆÉÊ∑±Âàª‰ΩìÁé∞‰∫ÜÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂ§ÑÁêÜÁöÑÁâπÊÆäÈúÄÊ±Ç„ÄÇËÆ©ÊàëËØ¶ÁªÜËß£ÊûêËøô‰∏ÄËÆæËÆ°ÁöÑÊÑè‰πâÔºö</p>
<p>üü¢ <strong><u>Êó∂Èó¥Â∫èÂàóÁöÑÂü∫Êú¨ÁªÑÊàêÈÉ®ÂàÜ</u></strong> </p>
<p>È¶ñÂÖàÔºåÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÈÄöÂ∏∏ÂèØ‰ª•ÂàÜËß£‰∏∫‰∏â‰∏™Âü∫Êú¨ÁªÑÊàêÈÉ®ÂàÜÔºö
- <strong>Ë∂ãÂäøÔºàTrendÔºâ</strong>ÔºöÈïøÊúüÁöÑÂèòÂåñÊñπÂêëÔºåÂ¶ÇÁªèÊµéÂ¢ûÈïøÁöÑÊÄª‰ΩìË∂ãÂäø
- <strong>Â≠£ËäÇÊÄßÔºàSeasonalityÔºâ</strong>ÔºöÂë®ÊúüÊÄßÁöÑÂèòÂåñÊ®°ÂºèÔºåÂ¶ÇÊØèÂπ¥ÁöÑÂ≠£ËäÇÊÄßÈîÄÂîÆÂèòÂåñ
- <strong>ÊÆãÂ∑ÆÔºàResidualÔºâ</strong>ÔºöÈöèÊú∫Ê≥¢Âä®ÊàñÂô™Â£∞</p>
<p>‰º†ÁªüÊó∂Èó¥Â∫èÂàóÂàÜÊûêÊñπÊ≥ïÔºàÂ¶ÇARIMA„ÄÅÊåáÊï∞Âπ≥ÊªëÊ≥ïÔºâÈÄöÂ∏∏‰ºöÂÖàÂàÜËß£Êó∂Èó¥Â∫èÂàóÔºåÂÜçÂàÜÂà´Âª∫Ê®°„ÄÇ</p>
<p><strong><u>üü¢ AutoformerÁöÑÂ∫èÂàóÂàÜËß£Êú∫Âà∂</u></strong></p>
<p>AutoformerÈÄöËøá<code>series_decomp</code>Â∞ÜËæìÂÖ•Â∫èÂàóÂàÜËß£‰∏∫Â≠£ËäÇÊÄßÂíåË∂ãÂäø‰∏§‰∏™ÈÉ®ÂàÜÔºö</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1"></a><a href="#__codelineno-58-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">res</span><span class="p">,</span> <span class="n">moving_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
<p>ËøôÈáåÔºö
- <code>res</code> ÊòØÂ≠£ËäÇÊÄßÈÉ®ÂàÜÔºàÁü≠ÊúüÂë®ÊúüÊÄßÂèòÂåñÔºâ
- <code>moving_mean</code> ÊòØË∂ãÂäøÈÉ®ÂàÜÔºàÈïøÊúüÊñπÂêëÊÄßÂèòÂåñÔºâ</p>
<p>ÂÖ≥ÈîÆÁÇπÊòØÔºå<strong>AutoformerÂú®Â§ö‰∏™‰ΩçÁΩÆ‰ΩøÁî®Â∫èÂàóÂàÜËß£ÔºåÂπ∂ÊúâÈÄâÊã©Âú∞‰∏¢ÂºÉË∂ãÂäøÈÉ®ÂàÜ</strong>„ÄÇ‰æãÂ¶ÇÔºö</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1"></a><a href="#__codelineno-59-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># Â∞ÜÊÆãÂ∑ÆËøûÊé•ÁªìÊûúÂàÜËß£Ôºå‰ªÖ‰øùÁïôÂ≠£ËäÇÊÄßÈÉ®ÂàÜ</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2"></a><a href="#__codelineno-59-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">res</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp2</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span></code></pre></div>
<p><u>üü¢  <strong>ËøôÁßçËÆæËÆ°ÁöÑÊ∑±Â±ÇÊÑè‰πâ</strong></u> </p>
<p>Ôºà1ÔºâÂàÜÁ¶ª‰∏çÂêåÊó∂Èó¥Â∞∫Â∫¶ÁöÑÊ®°Âºè</p>
<p>Ë∂ãÂäøÂíåÂ≠£ËäÇÊÄß‰ª£Ë°®‰∏çÂêåÊó∂Èó¥Â∞∫Â∫¶ÁöÑÂèòÂåñÊ®°ÂºèÔºö
- Ë∂ãÂäøÂèçÊò†ÈïøÊúüÂèòÂåñÔºà‰ΩéÈ¢ë‰ø°Âè∑Ôºâ
- Â≠£ËäÇÊÄßÂèçÊò†Áü≠ÊúüÂë®ÊúüÂèòÂåñÔºàÈ´òÈ¢ë‰ø°Âè∑Ôºâ</p>
<p>ÈÄöËøáÂàÜÁ¶ªËøô‰∏§ÁßçÊ®°ÂºèÔºåAutoformerÂèØ‰ª•Ôºö
- ËÆ©Ëá™Ê≥®ÊÑèÂäõÊú∫Âà∂‰∏ìÊ≥®‰∫éÊçïËé∑Â≠£ËäÇÊÄßÊ®°ÂºèÔºåËøôÊõ¥ÈÄÇÂêàÂÖ∂ÊìÖÈïøÊçïËé∑ÁöÑÂ±ÄÈÉ®‰æùËµñÂÖ≥Á≥ª
- ÂçïÁã¨Â§ÑÁêÜË∂ãÂäøÈÉ®ÂàÜÔºåÈÅøÂÖçÊ∑∑Âêà‰∏çÂêåÈ¢ëÁéáÁöÑ‰ø°Âè∑ÂØºËá¥ÁöÑÂª∫Ê®°Âõ∞Èöæ</p>
<p><strong>Ôºà2ÔºâÊ∏êËøõÂºèÂàÜËß£Êû∂ÊûÑ</strong> </p>
<p>AutoformerÈááÁî®"Ê∏êËøõÂºèÂàÜËß£"ÔºàProgressive DecompositionÔºâÊû∂ÊûÑÔºö
- ÊØè‰∏ÄÂ±ÇÈÉΩËøõË°åÂ∫èÂàóÂàÜËß£ÔºåÈÄêÊ≠•ÊèêÂèñÂ≠£ËäÇÊÄßÁâπÂæÅ
- ÈÄöËøá‰∏¢ÂºÉ‰∏≠Èó¥Â±ÇÁöÑË∂ãÂäø‰ø°ÊÅØÔºåÂº∫Âà∂Ê®°ÂûãÂÖ≥Ê≥®Â≠£ËäÇÊÄßÊ®°Âºè
- Âú®Ëß£Á†ÅÂô®‰∏≠ÔºåÂàÜÂà´Á¥ØÁßØÂêÑÂ±ÇÁöÑË∂ãÂäø‰ø°ÊÅØÔºåÂΩ¢ÊàêÊúÄÁªàË∂ãÂäøÈ¢ÑÊµã</p>
<p>ËøôÁßçÊû∂ÊûÑËß£ÂÜ≥‰∫Ü‰º†ÁªüTransformerÂú®ÈïøÂ∫èÂàóÈ¢ÑÊµã‰∏≠ÁöÑÁì∂È¢àÔºö
- ‰º†ÁªüTransformerÂú®ÈïøÊúüÈ¢ÑÊµã‰∏≠ÂæÄÂæÄÂ≠òÂú®"ÈïøÊúüÈ¢ÑÊµãÂÅèÂ∑ÆÁßØÁ¥Ø"ÈóÆÈ¢ò
- ÂàÜÁ¶ªË∂ãÂäøÂíåÂ≠£ËäÇÊÄßÂèØ‰ª•ÂáèËΩªËøôÁßçÂÅèÂ∑ÆÁßØÁ¥Ø</p>
<p><strong>Ôºà3ÔºâÂ¢ûÂº∫Â≠£ËäÇÊÄßÂíåÂë®ÊúüÊÄßÊ®°ÂºèÁöÑÂ≠¶‰π†</strong> </p>
<p>Êó∂Èó¥Â∫èÂàó‰∏≠ÁöÑÂ≠£ËäÇÊÄßÊ®°ÂºèÔºàÂ¶ÇÊØèÊó•„ÄÅÊØèÂë®„ÄÅÊØèÊúàÊàñÊØèÂπ¥ÁöÑÂë®ÊúüÊÄßÔºâÊòØÈ¢ÑÊµãÁöÑÈáçË¶Å‰æùÊçÆ„ÄÇÈÄöËøá‰øùÁïôÂ≠£ËäÇÊÄßÈÉ®ÂàÜÔºö
- Ê®°ÂûãÂèØ‰ª•Êõ¥Â•ΩÂú∞ÊçïÊçâËøô‰∫õÈáçÂ§çÂá∫Áé∞ÁöÑÊ®°Âºè
- Â¢ûÂº∫‰∫ÜÂØπÂë®ÊúüÊÄßË°å‰∏∫ÁöÑËØÜÂà´ËÉΩÂäõ
- Èôç‰Ωé‰∫ÜË∂ãÂäøÂèòÂåñÂØπÂ≠£ËäÇÊÄßÊ®°ÂºèËØÜÂà´ÁöÑÂπ≤Êâ∞</p>
<p>üü¢ <u><strong>Â∑•Á®ãÂÆûÁé∞ÁöÑÂ∑ßÂ¶ô‰πãÂ§Ñ</strong></u> </p>
<p>‰ªé‰ª£Á†ÅÂÆûÁé∞ÁúãÔºåAutoformerÁöÑÂ∫èÂàóÂàÜËß£ÈááÁî®ÁÆÄÂçïËÄåÊúâÊïàÁöÑÁßªÂä®Âπ≥ÂùáÊñπÊ≥ïÔºö
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1"></a><a href="#__codelineno-60-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># ËÆ°ÁÆóÁßªÂä®Âπ≥ÂùáÔºåÊèêÂèñÂ∫èÂàóË∂ãÂäøÂàÜÈáè</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2"></a><a href="#__codelineno-60-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">moving_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_avg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3"></a><a href="#__codelineno-60-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># ÈÄöËøáÂéüÂßãÂ∫èÂàóÂáèÂéªË∂ãÂäøÂàÜÈáèÔºåÂæóÂà∞ÊÆãÂ∑Æ(Â≠£ËäÇÊÄßÂàÜÈáè)</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4"></a><a href="#__codelineno-60-4"><span class="linenos" data-linenos="4 "></span></a><span class="n">res</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">moving_mean</span>
</span></code></pre></div></p>
<p>Ëøô‰∏ÄÁÆÄÂçïÊìç‰ΩúÂú®ËÆ°ÁÆóÊïàÁéá‰∏éÊïàÊûú‰πãÈó¥ÂèñÂæó‰∫ÜÂæàÂ•ΩÁöÑÂπ≥Ë°°Ôºö
- ËÆ°ÁÆóÂºÄÈîÄ‰ΩéÔºåÈÄÇÂêàÂ§ÑÁêÜÈïøÂ∫èÂàó
- ÊïàÊûúÊòæËëóÔºåËÉΩÊúâÊïàÂàÜÁ¶ª‰∏çÂêåÈ¢ëÁéáÁöÑ‰ø°Âè∑</p>
<p><u><strong>üü¢ ‰∏é‰º†ÁªüTransformerÁöÑÂÖ≥ÈîÆÂå∫Âà´</strong></u> </p>
<p>Âú®‰º†ÁªüTransformer‰∏≠ÔºåÊÆãÂ∑ÆËøûÊé•Áõ¥Êé•Â∞ÜÂéüÂßãËæìÂÖ•ÂíåÂ§ÑÁêÜÂêéÁöÑËæìÂá∫Áõ∏Âä†Ôºö
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1"></a><a href="#__codelineno-61-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span>  <span class="c1"># ‰º†ÁªüTransformer</span>
</span></code></pre></div></p>
<p>ËÄåAutoformerÂú®Áõ∏Âä†ÂêéËøòËøõË°å‰∫ÜÂ∫èÂàóÂàÜËß£Ôºö
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1"></a><a href="#__codelineno-62-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2"></a><a href="#__codelineno-62-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># AutoformerÁöÑÁâπÊÆäÂ§ÑÁêÜ</span>
</span></code></pre></div></p>
<p>‰ª•ÂèäÂú®ÂâçÈ¶àÁΩëÁªúÂêéÔºö
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1"></a><a href="#__codelineno-63-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">res</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomp2</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># ‰º†ÁªüTransformerÂè™Êúâ x = x + y</span>
</span></code></pre></div></p>
<p>Ëøô‰∏ÄÂàõÊñ∞ËÆæËÆ°‰ªéÊ†πÊú¨‰∏äÊîπÂèò‰∫Ü‰ø°ÊÅØÂú®ÁΩëÁªú‰∏≠ÁöÑÊµÅÂä®ÊñπÂºèÔºå‰ΩøÊ®°ÂûãÊõ¥ÈÄÇÂêàÊó∂Èó¥Â∫èÂàóÈ¢ÑÊµã‰ªªÂä°„ÄÇ</p>
<p><strong>üü¢ ÂÆûÈôÖÂ∫îÁî®ÊÑè‰πâ</strong> </p>
<p>Âú®ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåËøôÁßçÂ∫èÂàóÂàÜËß£Êú∫Âà∂Â∏¶Êù•ÁöÑÂ•ΩÂ§ÑÂåÖÊã¨Ôºö</p>
<ol>
<li><strong>ÊèêÈ´òÈïøÊúüÈ¢ÑÊµãÂáÜÁ°ÆÊÄß</strong>ÔºöÈÄöËøáÂàÜÁ¶ªË∂ãÂäøÂíåÂ≠£ËäÇÊÄßÔºåÂáèÂ∞ëÈïøÊúüÈ¢ÑÊµã‰∏≠ÁöÑËØØÂ∑ÆÁßØÁ¥Ø</li>
<li><strong>Â¢ûÂº∫ÂèØËß£ÈáäÊÄß</strong>ÔºöÂàÜËß£ÂêéÁöÑË∂ãÂäøÂíåÂ≠£ËäÇÊÄßÁªÑ‰ª∂Êõ¥ÂÆπÊòìÁêÜËß£ÂíåËß£Èáä</li>
<li><strong>Êõ¥Â•ΩÁöÑÊ≥õÂåñËÉΩÂäõ</strong>ÔºöÂ≠¶‰π†Âà∞ÁöÑÂ≠£ËäÇÊÄßÊ®°ÂºèÂèØ‰ª•Êõ¥Â•ΩÂú∞Ê≥õÂåñÂà∞Êñ∞ÁöÑÊó∂Èó¥ÊÆµ</li>
<li><strong>ÂáèËΩªÊï∞ÊçÆÈ¢ÑÂ§ÑÁêÜË¥üÊãÖ</strong>ÔºöÊ®°ÂûãÂÜÖÁΩÆÁöÑÂàÜËß£Êú∫Âà∂ÂáèÂ∞ë‰∫ÜÊï∞ÊçÆÈ¢ÑÂ§ÑÁêÜÁöÑÈúÄÊ±Ç</li>
</ol>
<p><strong>üü¢ ÁªìËÆ∫</strong> </p>
<p>Autoformer‰∏≠ÁöÑÂ∫èÂàóÂàÜËß£‰∏ç‰ªÖÊòØ‰∏Ä‰∏™ÊäÄÊúØÁªÜËäÇÔºåËÄåÊòØ‰∏Ä‰∏™‰ΩìÁé∞Êó∂Èó¥Â∫èÂàóÊï∞ÊçÆÊú¨Ë¥®ÁâπÊÄßÁöÑÂÖ≥ÈîÆËÆæËÆ°„ÄÇÂÆÉ‰ΩøAutoformerËÉΩÂ§üÊúâÊïàÂå∫ÂàÜÂíåÂ§ÑÁêÜ‰∏çÂêåÈ¢ëÁéáÁöÑ‰ø°Âè∑ÔºåÊèêÈ´òÈïøÊúüÈ¢ÑÊµãËÉΩÂäõÔºåÂπ∂Â¢ûÂº∫Ê®°ÂûãÁöÑÂèØËß£ÈáäÊÄß„ÄÇËøô‰∏ÄËÆæËÆ°ÂÖÖÂàÜÂ±ïÁ§∫‰∫ÜÂ¶Ç‰ΩïÂ∞ÜÈ¢ÜÂüüÁü•ËØÜÔºàÊó∂Èó¥Â∫èÂàóÂàÜÊûêÔºâ‰∏éÊ∑±Â∫¶Â≠¶‰π†Êû∂ÊûÑÔºàTransformerÔºâÊúâÊú∫ÁªìÂêàÔºåÂàõÈÄ†Âá∫Êõ¥ÈÄÇÂêàÁâπÂÆö‰ªªÂä°ÁöÑÊ®°ÂûãÊû∂ÊûÑ„ÄÇ</p>
<h3 id="_17"><a href="#ËøîÂõûÁêÜËß£Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂"><span id="Ë∑≥Âà∞ÁêÜËß£Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂">ÁêÜËß£Â§öÂ§¥Ê≥®ÊÑèÂäõÊú∫Âà∂</span></a><a class="headerlink" href="#_17" title="Permanent link">¬∂</a></h3>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="../images/image-20250321174539839.png"><img alt="image-20250321174539839" src="../images/image-20250321174539839.png"/></a> </p>
<h3 id="k-v-q"><a href="#ËøîÂõûÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q"><span id="ÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q">ÁºñÁ†ÅÂô®ÁöÑËæìÂá∫‰Ωú‰∏∫ K Âíå VÔºåËß£Á†ÅÂô®ÁöÑËæìÂÖ•‰Ωú‰∏∫ Q</span></a><a class="headerlink" href="#k-v-q" title="Permanent link">¬∂</a></h3>
<p>üü¢ Ê≥®ÊÑèÂäõÊú∫Âà∂Êú¨Ë¥®‰∏äÊòØ‰∏ÄÁßçËΩØÊ£ÄÁ¥¢Á≥ªÁªüÔºö</p>
<ul>
<li>QueryÔºàÊü•ËØ¢ÔºâÔºöË°®ËææÂΩìÂâçËß£Á†Å‰ΩçÁΩÆÈúÄË¶ÅÁöÑ‰ø°ÊÅØÁ±ªÂûã</li>
<li>KeyÔºàÈîÆÔºâÔºöË°®Á§∫Ê∫êÂ∫èÂàó‰∏≠ÂêÑ‰ΩçÁΩÆ‰ø°ÊÅØÁöÑ"Á¥¢Âºï"</li>
<li>ValueÔºàÂÄºÔºâÔºöË°®Á§∫Ê∫êÂ∫èÂàó‰∏≠ÂêÑ‰ΩçÁΩÆÁöÑÂÆûÈôÖÂÜÖÂÆπ</li>
</ul>
<p>Ëß£Á†ÅÂô®ÈÄöËøáÂÖ∂ÈöêËóèÁä∂ÊÄÅÂΩ¢ÊàêÊü•ËØ¢ÔºàQÔºâÔºåÁÑ∂ÂêéÊ†πÊçÆ‰∏éÁºñÁ†ÅÂô®ÈöêËóèÁä∂ÊÄÅÔºàKÔºâÁöÑÁõ∏ÂÖ≥ÊÄßÔºåÊèêÂèñÁõ∏Â∫îÁöÑÁºñÁ†ÅÂô®‰ø°ÊÅØÔºàVÔºâ„ÄÇ</p>
<p>üü¢ Âú®Â∫èÂàóÂà∞Â∫èÂàóÂ≠¶‰π†‰∏≠Ôºå‰∫§ÂèâÊ≥®ÊÑèÂäõÂÆûÁé∞‰∫ÜÊù°‰ª∂ÁîüÊàêÔºö</p>
<p>ÁºñÁ†ÅÂô®ÔºöË¥üË¥£ÁêÜËß£ËæìÂÖ•Â∫èÂàóÔºàÂ¶ÇÊ∫êËØ≠Ë®ÄÊñáÊú¨ÊàñÂéÜÂè≤Êó∂Èó¥Â∫èÂàóÔºâ</p>
<p>Ëß£Á†ÅÂô®ÔºöË¥üË¥£Âü∫‰∫éËæìÂÖ•Â∫èÂàóÁîüÊàêËæìÂá∫Â∫èÂàóÔºàÂ¶ÇÁõÆÊ†áËØ≠Ë®ÄÊñáÊú¨ÊàñÊú™Êù•Êó∂Èó¥Â∫èÂàóÔºâ</p>
<p>Ëß£Á†ÅÂô®ÈúÄË¶Å"ÊúâÊù°‰ª∂Âú∞"ÁîüÊàêËæìÂá∫ÔºåËøô‰∏™Êù°‰ª∂Â∞±ÊòØÁºñÁ†ÅÂô®Â§ÑÁêÜÁöÑËæìÂÖ•Â∫èÂàóÔºå‰∫§ÂèâÊ≥®ÊÑèÂäõÊèê‰æõ‰∫ÜËøôÁßçÊù°‰ª∂Êú∫Âà∂„ÄÇ</p>
<p>üü¢ Âú®AutoformerËøôÊ†∑ÁöÑÊó∂Èó¥Â∫èÂàóÈ¢ÑÊµãÊ®°Âûã‰∏≠ÔºåËøôÁßçËÆæËÆ°ÊúâÂÖ∂ÁâπÊÆäÊÑè‰πâÔºö</p>
<p>ÁºñÁ†ÅÂô®ÔºöÂ§ÑÁêÜÂéÜÂè≤Êó∂Èó¥Â∫èÂàóÔºåÊèêÂèñÂÖ≥ÈîÆÊ®°ÂºèÂíåÁâπÂæÅ</p>
<p>Ëß£Á†ÅÂô®ÔºöÂü∫‰∫éËøô‰∫õÊ®°ÂºèÁîüÊàêÊú™Êù•Êó∂Èó¥Â∫èÂàó</p>
<p>‰∫§ÂèâÊ≥®ÊÑèÂäõËÆ©Ëß£Á†ÅÂô®ËÉΩÂ§üÂú®ÁîüÊàêÊØè‰∏™Êú™Êù•Êó∂Èó¥Ê≠•Êó∂ÔºåÈÄâÊã©ÊÄßÂú∞ÂÖ≥Ê≥®ÂéÜÂè≤Â∫èÂàó‰∏≠ÁöÑÁõ∏ÂÖ≥Ê®°ÂºèÔºåÂ∞§ÂÖ∂ÊòØÈÇ£‰∫õ‰∏éÂΩìÂâçÈ¢ÑÊµã‰ΩçÁΩÆÁõ∏ÂÖ≥ÁöÑÂ≠£ËäÇÊÄßÊàñÂë®ÊúüÊÄßÊ®°Âºè„ÄÇ</p>
<h3 id="_18"><a href="#ËøîÂõûÂæ™ÁéØÂ°´ÂÖÖ"><span id="Âæ™ÁéØÂ°´ÂÖÖ">Âæ™ÁéØÂ°´ÂÖÖ</span></a><a class="headerlink" href="#_18" title="Permanent link">¬∂</a></h3>
<p>ÈÄÇÁî®ÔºöÁâπÂà´ÈÄÇÂêàÂ§ÑÁêÜÂÖ∑ÊúâÂë®ÊúüÊÄßÁâπÂæÅÁöÑÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆ</p>
<p>Êú¨Êñá‰ΩøÁî®Âæ™ÁéØÂ°´ÂÖÖÁöÑ‰ΩçÁΩÆÔºåÂØπË∂ãÂäøÊàêÂàÜËøòÂéüÂéüÂßãÁª¥Â∫¶ÁöÑÊó∂ÂÄôÔºö</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1"></a><a href="#__codelineno-64-1"><span class="linenos" data-linenos="1 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">d_model</span><span class="p">,</span> 
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2"></a><a href="#__codelineno-64-2"><span class="linenos" data-linenos="2 "></span></a>                            <span class="n">out_channels</span><span class="o">=</span><span class="n">c_out</span><span class="p">,</span> 
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3"></a><a href="#__codelineno-64-3"><span class="linenos" data-linenos="3 "></span></a>                            <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4"></a><a href="#__codelineno-64-4"><span class="linenos" data-linenos="4 "></span></a>                            <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5"></a><a href="#__codelineno-64-5"><span class="linenos" data-linenos="5 "></span></a>                            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6"></a><a href="#__codelineno-64-6"><span class="linenos" data-linenos="6 "></span></a>                            <span class="n">padding_mode</span><span class="o">=</span><span class="s1">'circular'</span><span class="p">,</span> 
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7"></a><a href="#__codelineno-64-7"><span class="linenos" data-linenos="7 "></span></a>                            <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<p>Âå∫ÂàÜÂá†ÁßçÂ°´ÂÖÖÊñπÂºè</p>
<p>„Äê‰∏ªË¶ÅËßÇÂØüÔºå<mark>a,b,c,dÁöÑÂ∑¶Âè≥</mark> „Äë</p>
<p>Ôºà1Ôºâ0 Â°´ÂÖÖÔºöÈõ∂Â°´ÂÖÖÔºàÈªòËÆ§Ôºå'zeros'ÔºâÔºöÁî®0ÂÄºÂ°´ÂÖÖÂ∫èÂàóËæπÁïå</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1"></a><a href="#__codelineno-65-1"><span class="linenos" data-linenos="1 "></span></a>ÂéüÂ∫èÂàó: [a, b, c, d]
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2"></a><a href="#__codelineno-65-2"><span class="linenos" data-linenos="2 "></span></a>Â°´ÂÖÖÂêé: [0, 0, a, b, c, d, 0, 0]
</span></code></pre></div>
<p>Ôºà2ÔºâÈáçÂ§çÂ°´ÂÖÖÔºöÈáçÂ§çÂ°´ÂÖÖÔºà'replicate'ÔºâÔºöÂ§çÂà∂ËæπÁïåÂÄº</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1"></a><a href="#__codelineno-66-1"><span class="linenos" data-linenos="1 "></span></a>ÂéüÂ∫èÂàó: [a, b, c, d]
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2"></a><a href="#__codelineno-66-2"><span class="linenos" data-linenos="2 "></span></a>Â°´ÂÖÖÂêé: [a, a, a, b, c, d, d, d]
</span></code></pre></div>
<p>(3)Âæ™ÁéØÂ°´ÂÖÖÔºà'circular'ÔºâÔºöÂ∞ÜÂ∫èÂàóËßÜ‰∏∫Âæ™ÁéØÁªìÊûÑ</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1"></a><a href="#__codelineno-67-1"><span class="linenos" data-linenos="1 "></span></a>ÂéüÂ∫èÂàó: [a, b, c, d]
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2"></a><a href="#__codelineno-67-2"><span class="linenos" data-linenos="2 "></span></a>Â°´ÂÖÖÂêé: [c, d, a, b, c, d, a, b]
</span></code></pre></div>
<p><mark>‰∏∫‰ªÄ‰πàÂ∫èÂàóÂ°´ÂÖÖÔºå‰ΩøÁî®Êó∂Èó¥Â∫èÂàó</mark></p>
<p>Â∞ÜÊó∂Èó¥Â∫èÂàóËßÜ‰∏∫‰∏Ä‰∏™Âæ™ÁéØÔºåÂ∫èÂàóÊú´Â∞æËøûÊé•Âà∞Â∫èÂàóÂºÄÂ§¥Ôºå‰øùÊåÅÊó∂Èó¥Êï∞ÊçÆÁöÑÂë®ÊúüÊÄßÁâπÊÄßÔºå‰∏çÂºïÂÖ•‰∫∫‰∏∫ÁöÑÂÄºÔºåÂè™‰ΩøÁî®Â∑≤ÊúâÊï∞ÊçÆ</p>
<p><strong>Êó∂Èó¥Â∫èÂàóÂë®ÊúüÊÄßÁöÑÊèèËø∞Ôºö</strong></p>
<ul>
<li>Âπ¥Â∫¶Âë®ÊúüÔºöÊØèÂπ¥Âêå‰∏ÄÊó∂Èó¥ÁÇπÁöÑÊï∞ÊçÆÂèØËÉΩÊúâÁõ∏‰ººÊ®°Âºè</li>
<li>ÊúàÂ∫¶Âë®ÊúüÔºöÊØèÊúàÂèØËÉΩÊúâÁõ∏‰ººÁöÑÊ®°ÂºèÔºàÂ¶ÇÊúàÂàù„ÄÅÊúà‰∏≠„ÄÅÊúàÊú´Ôºâ</li>
<li>Âë®Â∫¶Âë®ÊúüÔºöÊØèÂë®ÁöÑÂ∑•‰ΩúÊó•ÂíåÂë®Êú´Ê®°ÂºèÂæÄÂæÄÁ±ª‰ºº</li>
<li>Êó•ÂÜÖÂë®ÊúüÔºöÊØèÂ§©ÂÜÖÁöÑÊ¥ªÂä®Ê®°ÂºèÔºàÂ¶ÇÊó©È´òÂ≥∞„ÄÅÂçà‰ºëÊó∂Èó¥Ôºâ</li>
</ul>
<p>‰æãÂ≠êÔºö</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1"></a><a href="#__codelineno-68-1"><span class="linenos" data-linenos="1 "></span></a>[Âë®‰∏Ä, Âë®‰∫å, Âë®‰∏â, Âë®Âõõ, Âë®‰∫î, Âë®ÂÖ≠, Âë®Êó•]
</span></code></pre></div>
<p><strong>Âæ™ÁéØÂ°´ÂÖÖ‰ª•ÂêéÔºö</strong> </p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1"></a><a href="#__codelineno-69-1"><span class="linenos" data-linenos="1 "></span></a>ËæπÁïåÂ§ÑÁêÜÂêéÔºö[Âë®ÂÖ≠, Âë®Êó•, Âë®‰∏Ä, Âë®‰∫å, ..., Âë®Êó•, Âë®‰∏Ä, Âë®‰∫å]
</span></code></pre></div>
<p>PyTorch‰∏≠ÁöÑÂæ™ÁéØÂ°´ÂÖÖÂÆûÁé∞‰ºöÂ∞ÜÂ∫èÂàóËßÜ‰∏∫ÁéØÂΩ¢ÁªìÊûÑÔºö</p>
<ul>
<li>ÂØπ‰∫éÈúÄË¶ÅÂú®Â∑¶‰æßÂ°´ÂÖÖÁöÑÈÉ®ÂàÜÔºå‰ªéÂ∫èÂàóÂè≥Á´ØÂèñÂÄº</li>
<li>ÂØπ‰∫éÈúÄË¶ÅÂú®Âè≥‰æßÂ°´ÂÖÖÁöÑÈÉ®ÂàÜÔºå‰ªéÂ∫èÂàóÂ∑¶Á´ØÂèñÂÄº</li>
</ul>
<h3 id="_19"><a href="#ËøîÂõû‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ">‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ‰∏çÂêåÁöÑËøòÂéüÁª¥Â∫¶ÊñπÊ≥ï</a> <a id="Ë∑≥Âà∞‰∏∫‰ªÄ‰πàÂ≠£ËäÇÊàêÂàÜÂíåË∂ãÂäøÊàêÂàÜ"></a><a class="headerlink" href="#_19" title="Permanent link">¬∂</a></h3>
<p><strong>È¶ñÂÖàÔºåÊòéÁ°ÆÔºåÂ≠£ËäÇÊàêÂàÜ ‰ΩøÁî®Á∫øÊÄßÂ±ÇÊäïÂΩ±</strong> </p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1"></a><a href="#__codelineno-70-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># DecoderÁ±ª‰∏≠ÁöÑÊäïÂΩ±</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2"></a><a href="#__codelineno-70-2"><span class="linenos" data-linenos="2 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="o">=</span> <span class="n">projection</span>  <span class="c1"># ÈÄöÂ∏∏ÊòØnn.Linear(d_model, c_out)</span>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3"></a><a href="#__codelineno-70-3"><span class="linenos" data-linenos="3 "></span></a>
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4"></a><a href="#__codelineno-70-4"><span class="linenos" data-linenos="4 "></span></a><span class="c1"># ‰ΩøÁî®Êó∂</span>
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5"></a><a href="#__codelineno-70-5"><span class="linenos" data-linenos="5 "></span></a><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6"></a><a href="#__codelineno-70-6"><span class="linenos" data-linenos="6 "></span></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># x: [B, L, d_model] -&gt; [B, L, c_out]</span>
</span></code></pre></div>
<p><strong>Ë∂ãÂäøÊàêÂàÜÔºö‰ΩøÁî®Âç∑ÁßØÂ±ÇÔºàConv1dÔºâËøõË°åÊäïÂΩ±</strong></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1"></a><a href="#__codelineno-71-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># DecoderLayerÁ±ª‰∏≠ÁöÑÊäïÂΩ±</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2"></a><a href="#__codelineno-71-2"><span class="linenos" data-linenos="2 "></span></a><span class="bp">self</span><span class="o">.</span><span class="n">projection</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">d_model</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="n">c_out</span><span class="p">,</span> 
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3"></a><a href="#__codelineno-71-3"><span class="linenos" data-linenos="3 "></span></a>                           <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4"></a><a href="#__codelineno-71-4"><span class="linenos" data-linenos="4 "></span></a>                           <span class="n">padding_mode</span><span class="o">=</span><span class="s1">'circular'</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5"></a><a href="#__codelineno-71-5"><span class="linenos" data-linenos="5 "></span></a>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6"></a><a href="#__codelineno-71-6"><span class="linenos" data-linenos="6 "></span></a><span class="c1"># ‰ΩøÁî®Êó∂</span>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7"></a><a href="#__codelineno-71-7"><span class="linenos" data-linenos="7 "></span></a><span class="n">residual_trend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">residual_trend</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></code></pre></div>
<p>üîµ Ëß£ÈáäËøô‰πàËÆæËÆ°ÁöÑÁêÜÁî±Ôºö</p>
<p>Â≠£ËäÇÊàêÂàÜ‰Ωú‰∏∫È´òÈ¢ëÊàêÂàÜÔºå<mark>‰∏ç‰ºöÂπ≥ÊªëÊó∂Èó¥Â∫èÂàóÔºå‰øùÁïô‰∫ÜÂ≠£ËäÇÊÄßÁöÑÂ∞ñÈîêÂèòÂåñ</mark></p>
<p>Ë∂ãÂäøÊàêÂàÜ‰Ωú‰∏∫‰ΩéÈ¢ëÊàêÂàÜÔºåË∂ãÂäøÊú¨Ë¥®‰∏äÊòØ==Âπ≥Êªë==ÁöÑ</p>
<ul>
<li>ËÆæÁΩÆ <strong>kernel size = 3</strong>ÔºåËÄÉËôë‰∫ÜÂ±ÄÈÉ®‰∏ä‰∏ãÊñáÊúâÂä©‰∫éÁª¥ÊåÅËøôÁßçÂπ≥ÊªëÊÄß</li>
<li>Âç∑ÁßØÊìç‰ΩúÔºàÁâπÂà´ÊòØkernel_size=3ÔºâËÉΩÂ§üÂπ≥ÊªëË∂ãÂäøÔºåËøáÊª§Êéâ‰∏çÂøÖË¶ÅÁöÑÈ´òÈ¢ëÊâ∞Âä®</li>
<li>ÔºàÂèÇÊï∞ÂÖ±‰∫´ÔºâË∑®‰∏çÂêåÊó∂Èó¥ÁÇπÁöÑÁõ∏ÂêåÊ®°ÂºèÂèØ‰ª•Ë¢´Áõ∏ÂêåÁöÑÂç∑ÁßØÊ†∏ËØÜÂà´</li>
</ul>
<div class="document-dates-plugin-wrapper"><div class="document-dates-plugin"><span title="ÂàõÂª∫Êó∂Èó¥: 2025-03-17"><span class="material-icons">add_circle</span>2025-03-17 14:44:43</span><span title="ÊúÄÂêéÊõ¥Êñ∞: 2025-03-22"><span class="material-icons">update</span>2025-03-22 15:47:58</span></div></div>
<div id="__comments"></div>
<!-- <h3>È¢úËâ≤‰∏ªÈ¢òË∞ÉÊï¥</h3>
    <div class="tx-switch">
    <button class="button1" data-md-color-primary="red" style="background-color:red">red</button>
    <button class="button1" data-md-color-primary="pink" style="background-color:pink;color:black">pink</button>
    <button class="button1" data-md-color-primary="purple" style="background-color:purple">purple</button>
    <button class="button1" data-md-color-primary="indigo" style="background-color:indigo">indigo</button>
    <button class="button1" data-md-color-primary="blue" style="background-color:blue">blue</button>
    <button class="button1" data-md-color-primary="cyan" style="background-color:cyan;color:black">cyan</button>
    <button class="button1" data-md-color-primary="teal" style="background-color:teal">teal</button>
    <button class="button1" data-md-color-primary="green" style="background-color:green">green</button>
    <button class="button1" data-md-color-primary="lime" style="background-color:lime;color:black">lime</button>
    <button class="button1" data-md-color-primary="orange" style="background-color:orange;color:black">orange</button>
    <button class="button1" data-md-color-primary="brown" style="background-color:brown;border-radius=3px">brown</button>
    <button class="button1" data-md-color-primary="grey" style="background-color:grey">grey</button>
    <button class="button1" data-md-color-primary="black" style="background-color:black">black</button>
    <button class="button1" data-md-color-primary="white" style="background-color:white;color:black">white</button>
    </div> -->
<!-- Giscus -->
<script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDONhXY184ClgKT" data-emit-metadata="0" data-input-position="bottom" data-lang="zh-CN" data-mapping="pathname" data-reactions-enabled="1" data-repo="Auzers/notes" data-repo-id="R_kgDONhXY1w" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js">
</script>
<script>
    var buttons = document.querySelectorAll("button[data-md-color-primary]")
    buttons.forEach(function (button) {
        button.addEventListener("click", function () {
            var attr = this.getAttribute("data-md-color-primary")
            document.body.setAttribute("data-md-color-primary", attr)
            localStorage.setItem("data-md-color-primary", attr);
        })
    })
</script>
<!-- Synchronize Giscus theme with palette -->
<script>
    var giscus = document.querySelector("script[src*=giscus]")
</script>
<script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"
        giscus.setAttribute("data-theme", theme)
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate" ? "dark" : "light"

                /* Instruct Giscus to change theme */
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "toc.follow", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.code.select", "content.tooltips", "content.footnote.tooltips", "content.tabs.link", "header.autohide", "navigation.tabs", "navigation.tracking", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.path"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="../../assets/javascripts/katex.js"></script>
<script src="../../assets/javascripts/mathjax.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml-full.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-svg-full.js"></script>
<script src="../../assets/javascripts/tablesort.js"></script>
<script src="../../assets/javascripts/toc.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="../../mkdocs/javascripts/katex.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
<script src="../../assets/javascripts/web-time.js"></script>
<script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/extra.js"></script>
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script><script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script><script>document.addEventListener('DOMContentLoaded', () => {
    let attempts = 0;
    const maxAttempts = 50;

    const waitForNav = setInterval(() => {
        attempts++;
        const nav = document.querySelector('.md-sidebar--secondary .md-nav__list');
        if (!nav) return;

        const navItems = Array.from(nav.querySelectorAll('.md-nav__item'));
        if (navItems.length === 0) {
            if (attempts >= maxAttempts) {
                clearInterval(waitForNav);
                console.error('ÁõÆÂΩïÂä†ËΩΩË∂ÖÊó∂');
            }
            return;
        }

        clearInterval(waitForNav);
        console.log('ÁõÆÂΩïÈ°πÊï∞Èáè:', navItems.length);

        // Ëé∑Âèñ‰∏ªÂÜÖÂÆπÂå∫Âüü
        const mainContent = document.querySelector('.md-content__inner');
        if (!mainContent) return;

        // Ëé∑ÂèñÊâÄÊúâÊ†áÈ¢ò
        const headings = Array.from(mainContent.querySelectorAll('h1, h2, h3, h4, h5, h6'));
        console.log('Ê†áÈ¢òÊï∞Èáè:', headings.length);

        // Êî∂ÈõÜÊâÄÊúâÂàÜÈöîÁ∫ø‰ΩçÁΩÆ
        const walker = document.createTreeWalker(mainContent, NodeFilter.SHOW_TEXT, {
            acceptNode: (node) => {
                if (!node || !node.textContent) return NodeFilter.FILTER_REJECT;
                if (node.parentElement?.closest('pre, code, .md-nav, script, style')) {
                    return NodeFilter.FILTER_REJECT;
                }
                return NodeFilter.FILTER_ACCEPT;
            }
        }, false);

        const hrPositions = [];
        let node;
        while (node = walker.nextNode()) {
            const text = node.textContent.trim();
            const match = text.match(/^---(.+?)---$/);
            if (match) {
                hrPositions.push({
                    node,
                    content: match[1].trim()
                });
            }
        }

        // Â§ÑÁêÜÊØè‰∏™ÂàÜÈöîÁ∫ø
        hrPositions.forEach((hrData, index) => {
            // ÂàõÂª∫ÂàÜÈöîÁ∫ø
            const hr = document.createElement('hr');
            hr.setAttribute('data-content', hrData.content);
            hr.classList.add('custom-hr');
            hr.id = `hr-${index + 1}`;
            hrData.node.parentNode.replaceChild(hr, hrData.node);

            // ÂàõÂª∫ÁõÆÂΩïÈ°π
            const li = document.createElement('li');
            li.classList.add('md-nav__item', 'hr-nav-item');
            const a = document.createElement('a');
            a.classList.add('md-nav__link');
            a.href = `#hr-${index + 1}`;
            a.textContent = `${hrData.content}`; // ‰øÆÊîπËøôÈáåÔºåÊ∑ªÂä†ÂâçÂêéÁöÑÁ†¥ÊäòÂè∑
            li.appendChild(a);



            // ÊâæÂà∞ÂàÜÈöîÁ∫øÂêéÁöÑÁ¨¨‰∏Ä‰∏™Ê†áÈ¢ò
            let nextHeadingIndex = -1;
            for (let i = 0; i < headings.length; i++) {
                const heading = headings[i];
                if (hr.compareDocumentPosition(heading) & Node.DOCUMENT_POSITION_FOLLOWING) {
                    nextHeadingIndex = i;
                    break;
                }
            }

            console.log('ÂàÜÈöîÁ∫ø:', hrData.content, '‰∏ã‰∏Ä‰∏™Ê†áÈ¢òÁ¥¢Âºï:', nextHeadingIndex);

            if (nextHeadingIndex !== -1) {
                // ÊâæÂà∞ÂØπÂ∫îÁöÑÁõÆÂΩïÈ°π
                const nextHeading = headings[nextHeadingIndex];
                const nextNavItem = navItems.find(item => {
                    const link = item.querySelector('a');
                    const text = link?.textContent?.replace('¬∂', '').trim();
                    return text === nextHeading.textContent.replace('¬∂', '').trim();
                });

                if (nextNavItem) {
                    nav.insertBefore(li, nextNavItem);
                    console.log('ÊèíÂÖ•Âà∞Ê†áÈ¢òÂâç:', nextHeading.textContent);
                    return;
                }
            }

            nav.appendChild(li);
            console.log('ËøΩÂä†Âà∞Êú´Â∞æ:', hrData.content);
        });
    }, 100);
});</script></body>
</html>